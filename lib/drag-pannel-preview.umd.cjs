(function(){"use strict";try{if(typeof document<"u"){var a=document.createElement("style");a.appendChild(document.createTextNode(".group-wrap[data-v-efe5d5a7]{position:absolute;left:0;top:0;width:100%;height:100%}.group-wrap .group-item[data-v-efe5d5a7]{position:absolute}.custom-image[data-v-51bcdfe3]{color:var(--35be3580);background-color:var(--7a3808fb);padding:var(--565e2eee);border-radius:var(--ca4fabd6)}.shap-wrap[data-v-7cddd7a5]{word-break:break-all;box-sizing:border-box;height:100%;color:var(--61fa260c);background-color:var(--55a66c16);padding:var(--9d5a2030);border-radius:var(--2a2a61db);font-size:var(--60be67f9);border:var(--71bc76ee)}.text-wrap[data-v-8f822377]{color:var(--47b5a944);background-color:var(--27bcc882);padding:var(--6f707c9c);border-radius:var(--7061a25e);font-size:var(--2863cf6f);border:var(--7aff53b8);word-break:break-all;white-space:var(--3b2782fa);overflow:var(--514c5593);text-overflow:var(--71345cf5);text-align:var(--70e03432);width:100%;height:100%;box-sizing:border-box}.icon-wrap[data-v-6b52c610]{color:var(--46bf371c);stroke:var(--46bf371c);fill:var(--5a1a592f);background-color:var(--1d6b7926);padding:var(--651f2d40);border-radius:var(--5f884d3a);font-size:var(--6f5fc4fe)}.icon-wrap.color-self[data-v-6b52c610] *{color:var(--46bf371c);stroke:var(--46bf371c);fill:var(--5a1a592f)}.img-scale-wrap[data-v-c83ce927]{position:relative;width:100%;height:100%;color:var(--806595a2);background-color:var(--86f44e2c);padding:var(--cea80246);border-radius:var(--52a92046)}.img-scale-wrap .img-scale-reduce[data-v-c83ce927]{position:absolute;overflow:hidden;width:100%;height:100%;transition:.1s}.img-scale-wrap .img-scale[data-v-c83ce927]{display:block;position:absolute;width:100%;height:100%;-webkit-user-drag:none}.drag-editor-preivew-wrap[data-v-0d56cf8c]{width:100%;height:100%;min-width:200px;min-height:200px}.drag-editor-preivew[data-v-0d56cf8c]{width:100%;height:100%}.drag-editor-preivew[data-v-0d56cf8c] .handle{display:none!important}.preview-item-wrap[data-v-0d56cf8c]{touch-action:none;position:absolute;box-sizing:border-box;-webkit-user-select:none;user-select:none}.preview-item-wrap img[data-v-0d56cf8c]{-webkit-user-drag:none}.dycomponent-class[hide][data-v-0d56cf8c]{display:none}")),document.head.appendChild(a)}}catch(e){console.error("vite-plugin-css-injected-by-js",e)}})();
(function(e,b){typeof exports=="object"&&typeof module<"u"?module.exports=b(require("vue")):typeof define=="function"&&define.amd?define(["vue"],b):(e=typeof globalThis<"u"?globalThis:e||self,e["drag-pannel-preview"]=b(e.Vue))})(this,function(e){"use strict";const b=Object.freeze(Object.defineProperty({__proto__:null,get default(){return y}},Symbol.toStringTag,{value:"Module"})),w=(c,t)=>{let l=c.self,o=l.activeValue,n=l.prop,d=l.activeMode,_=l.activeMap;if(!n||!d||!_)return l;let r=!1;switch(d){case"大于":t[n]>o&&(r=!0);break;case"小于":t[n]<o&&(r=!0);break;case"等于":t[n]==o&&(r=!0);break;case"不等于":t[n]!=o&&(r=!0);break;case"大于等于":t[n]>=o&&(r=!0);break;case"小于等于":t[n]<o&&(r=!0);break;case"存在":t[n]!==void 0&&t[n]!==null&&(r=!0);break;case"不存在":(t[n]===void 0||t[n]===null)&&(r=!0);break}let p={};return r&&(p=V(_,t)),{...l,...p}},V=(c,t)=>{var d,_;let l={},o=/\$\{(.*?)\}.*/g;try{l=JSON.parse(c);for(var n in l){let r=l[n];if(o.test(r)){let p=/\$\{(.*?)\}/g,s=((d=r.match(p))==null?void 0:d[0])??"",u=r.split(s),a=s.replace(/[\$|{|}]/g,""),f=(t==null?void 0:t[a])??"";l[n]=(_=u.join)==null?void 0:_.call(u,f)}}}catch(r){console.error("解析 activeMap 失败",r)}return l},S={class:"group-wrap"},x=["a"],B=e.defineComponent({__name:"index",props:{data:{},modelValue:{default:()=>({})},groupModel:{default:()=>({})},disabled:{type:Boolean}},setup(c){const t=c,l=d=>k(d).default,o=d=>({width:d.w=="auto"?d.w:d.w+"px",height:d.h=="auto"?d.h:d.h+"px",transform:`translate(${d.x}px, ${d.y}px) rotate(${d.r||0}deg)`}),n=d=>w(d,t.groupModel);return(d,_)=>(e.openBlock(),e.createElementBlock("div",S,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(d.data.group,r=>(e.openBlock(),e.createElementBlock("div",{a:r.active,class:"group-item",style:e.normalizeStyle(o(r))},[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(l(r.self.name)),e.mergeProps({data:r,h:r.h,w:r.w},n(r),{modelValue:d.groupModel[r.self.modelValue],"onUpdate:modelValue":p=>d.groupModel[r.self.modelValue]=p,defaultModelValue:r.self.defaultModelValue,"onUpdate:defaultModelValue":p=>r.self.defaultModelValue=p,disabled:!0}),null,16,["data","h","w","modelValue","onUpdate:modelValue","defaultModelValue","onUpdate:defaultModelValue"]))],12,x))),256))]))}}),G="",m=(c,t)=>{const l=c.__vccOpts||c;for(const[o,n]of t)l[o]=n;return l},$=Object.freeze(Object.defineProperty({__proto__:null,default:m(B,[["__scopeId","data-v-efe5d5a7"]])},Symbol.toStringTag,{value:"Module"})),z=["width","height","src"],v=e.defineComponent({__name:"index",props:{url:{},w:{},h:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""}},setup(c){const t=c;e.useCssVars(o=>({"35be3580":o.color,"7a3808fb":o.bgColor,"565e2eee":o.padding,ca4fabd6:o.radius})),e.watch(()=>[t.w,t.h],()=>l()),e.onMounted(()=>{l()});const l=()=>{};return(o,n)=>(e.openBlock(),e.createElementBlock("img",{class:"custom-image",width:o.w,height:o.h,src:o.url,alt:""},null,8,z))}}),K="",O=Object.freeze(Object.defineProperty({__proto__:null,default:m(v,[["__scopeId","data-v-51bcdfe3"]])},Symbol.toStringTag,{value:"Module"})),E=Object.freeze(Object.defineProperty({__proto__:null,default:e.defineComponent({__name:"index",props:{url:{},w:{},h:{},flip:{}},setup(c){const t=c;let l=e.ref(),o="",n=!0,d="";e.watch(()=>[t.w,t.h],()=>_()),e.watch(()=>{var p,s;return[(p=t.flip)==null?void 0:p.horizontal,(s=t.flip)==null?void 0:s.vertical]},()=>r()),e.onMounted(()=>{o=l.value.getContext("2d"),_()});const _=()=>{let p=t.w,s=t.h;l.value.width=p,l.value.height=s,n?(n=!1,d=document.createElement("img"),d.src=t.url,d.onload=()=>{o.drawImage(d,0,0,p,s),r()}):r()},r=()=>{const{vertical:p,horizontal:s}=t.flip??{};let u=t.w,a=t.h;const f=s?-1:1,i=p?-1:1;o.clearRect(0,0,u,a),o.translate(u/2-u*f/2,a/2-a*i/2),o.scale(f,i),o.drawImage(d,0,0,u,a),o.setTransform(1,0,0,1,0,0)};return(p,s)=>(e.openBlock(),e.createElementBlock("canvas",{ref_key:"canvas",ref:l},null,512))}})},Symbol.toStringTag,{value:"Module"})),j={class:"shap-wrap"},T=e.defineComponent({__name:"index",props:{modelValue:{default:""},defaultModelValue:{default:""},data:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""},fontSize:{default:""},borderColor:{default:""},w:{},h:{}},setup(c){return e.useCssVars(t=>({"61fa260c":t.color,"55a66c16":t.bgColor,"9d5a2030":t.padding,"2a2a61db":t.radius,"60be67f9":t.fontSize,"71bc76ee":t.borderColor})),(t,l)=>(e.openBlock(),e.createElementBlock("div",j))}}),ee="",I=Object.freeze(Object.defineProperty({__proto__:null,default:m(T,[["__scopeId","data-v-7cddd7a5"]])},Symbol.toStringTag,{value:"Module"})),P=["contenteditable"],H=e.defineComponent({__name:"index",props:{modelValue:{default:""},defaultModelValue:{},data:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""},fontSize:{default:""},borderColor:{default:""},align:{},w:{},h:{},noWordWrap:{type:Boolean,default:!1},overEllipsis:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},hasModelValue:{type:Boolean}},emits:["update:modelValue","update:defaultModelValue","click"],setup(c,{emit:t}){const l=c;e.useCssVars(s=>({"47b5a944":s.color,"27bcc882":s.bgColor,"6f707c9c":s.padding,"7061a25e":s.radius,"2863cf6f":s.fontSize,"7aff53b8":s.borderColor,"3b2782fa":s.noWordWrap?"nowrap":"","514c5593":s.overEllipsis?"hidden":"visible","71345cf5":s.overEllipsis?"ellipsis":"unset","70e03432":s.align?s.align:"left"}));let o=e.ref(!1),n=e.ref();const d=async()=>{l.disabled||(o.value=!0,_(n.value),await e.nextTick(),n.value.focus())},_=s=>{const u=window.getSelection(),a=document.createRange();a.selectNodeContents(s),u.removeAllRanges(),u.addRange(a)},r=()=>{o.value=!1},p=s=>{l.hasModelValue&&t("update:modelValue",s.target.innerText),t("update:defaultModelValue",s.target.innerText)};return(s,u)=>(e.openBlock(),e.createElementBlock("div",{contenteditable:e.unref(o),onBlur:r,onInput:p,ref_key:"text",ref:n,class:e.normalizeClass({"text-wrap":!0,"can-edit":e.unref(o)}),onDblclick:d},e.toDisplayString(s.modelValue||s.defaultModelValue),43,P))}}),le="",R=Object.freeze(Object.defineProperty({__proto__:null,default:m(H,[["__scopeId","data-v-8f822377"]])},Symbol.toStringTag,{value:"Module"})),U=["innerHTML"],W=e.defineComponent({__name:"index",props:{url:{},color:{default:""},bgColor:{default:""},fillColor:{default:""},padding:{default:""},radius:{default:""},fontSize:{default:""},iconUseSelfColor:{type:Boolean}},setup(c){return e.useCssVars(t=>({"46bf371c":t.color,"5a1a592f":t.fillColor,"1d6b7926":t.bgColor,"651f2d40":t.padding,"5f884d3a":t.radius,"6f5fc4fe":t.fontSize})),(t,l)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass({"icon-wrap":!0,"color-self":t.iconUseSelfColor}),innerHTML:t.url},null,10,U))}}),ae="",A=Object.freeze(Object.defineProperty({__proto__:null,default:m(W,[["__scopeId","data-v-6b52c610"]])},Symbol.toStringTag,{value:"Module"})),N={class:"img-scale-wrap"},F=["src"],D=e.defineComponent({__name:"index",props:{url:{},w:{},h:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""},lockAspectRatio:{type:Boolean,default:!1},position:{default:"left"},imgWidth:{},imgHeight:{}},setup(c){const t=c;e.useCssVars(n=>({"806595a2":n.color,"86f44e2c":n.bgColor,cea80246:n.padding,"52a92046":n.radius}));let l=e.computed(()=>({[t.position]:0,width:t.imgWidth,height:t.imgHeight})),o=e.computed(()=>({[t.position]:0,width:t.lockAspectRatio?t.w+"px":void 0,height:t.lockAspectRatio?t.h+"px":void 0}));return(n,d)=>(e.openBlock(),e.createElementBlock("div",N,[e.createElementVNode("div",{class:"img-scale-reduce",style:e.normalizeStyle(e.unref(l))},[e.createElementVNode("img",{class:"img-scale",src:n.url,alt:"",style:e.normalizeStyle(e.unref(o))},null,12,F)],4)]))}}),re="";let L=Object.assign({"./Group/index.vue":$,"./Image/index.vue":O,"./Picture/index.vue":E,"./Shape/index.vue":I,"./Text/index.vue":R,"./icon-svg/index.vue":A,"./img-scale/index.vue":Object.freeze(Object.defineProperty({__proto__:null,default:m(D,[["__scopeId","data-v-c83ce927"]])},Symbol.toStringTag,{value:"Module"})),"./preview/index.vue":b});const k=c=>L[`./${c}/index.vue`],X=["onClick"],Y=e.defineComponent({name:"dragPannelPreview"}),q=e.defineComponent({...Y,props:{pannel:{},modelValue:{default:()=>({})},disabled:{type:Boolean,default:!1},parentWidth:{default:0}},emits:["click"],setup(c,{emit:t}){const l=c;let o=e.ref(),n=e.ref({});e.onMounted(()=>{_()});const d=a=>({width:a.w==="auto"?a.w:a.w+"px",height:a.h==="auto"?a.h:a.h+"px",fontSize:l.pannel.fontSize||a.fontSize,zIndex:a.z||"auto",transform:`translate(${a.x||0}px, ${a.y||0}px) rotate(${a.r||0}deg)`}),_=async()=>{await e.nextTick();let a={transformOrigin:"0% 0%",width:l.pannel.width+"px",height:l.pannel.height+"px",color:l.pannel.color,fontSize:l.pannel.fontSize,backgroundColor:l.pannel.bgColor},f=o.value.getBoundingClientRect(),{endRate:i,translateX:h,translateY:g}=r(f.width,f.height);n.value={...a,transform:`translate(${h}px, ${g}px) scale(${i})`}},r=(a,f)=>{let i=a/l.pannel.width,h=f/l.pannel.height,g=i>h?h:i,C=i<=h?0:a*g,M=h<=i?0:f*g;return{endRate:g,translateX:C>0?a/2-l.pannel.width/2*g:C,translateY:M>0?f/2-l.pannel.height/2*g:M}},p=a=>k(a).default,s=(a,f)=>{f.self.click&&(console.log("click",a.target),t("click",{event:a,item:f}))},u=a=>w(a,l.modelValue);return(a,f)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"wrapRef",ref:o,class:"drag-editor-preivew-wrap"},[e.createElementVNode("div",{class:e.normalizeClass({"drag-editor-preivew":!0}),style:e.normalizeStyle(e.unref(n))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.pannel.components,i=>{var h;return e.openBlock(),e.createElementBlock("div",{class:"preview-item-wrap",style:e.normalizeStyle(d(i)),onClick:e.withModifiers(g=>s(g,i),["self"])},[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(p(i.self.name)),e.mergeProps({class:"dycomponent-class",data:i,h:i.h,w:i.w},u(i),{modelValue:a.modelValue[i.self.modelValue],"onUpdate:modelValue":g=>a.modelValue[i.self.modelValue]=g,defaultModelValue:i.self.defaultModelValue,"onUpdate:defaultModelValue":g=>i.self.defaultModelValue=g,groupModel:a.modelValue,disabled:!0,id:((h=i.self)==null?void 0:h.id)||""}),null,16,["data","h","w","modelValue","onUpdate:modelValue","defaultModelValue","onUpdate:defaultModelValue","groupModel","id"]))],12,X)}),256))],4)],512))}}),ce="",y=m(q,[["__scopeId","data-v-0d56cf8c"]]);return y.install=c=>{c.component(y.name,y)},y});
