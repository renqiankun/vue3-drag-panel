(function(){"use strict";try{if(typeof document<"u"){var a=document.createElement("style");a.appendChild(document.createTextNode(".group-wrap[data-v-a7d365c4]{position:absolute;left:0;top:0;width:100%;height:100}.group-wrap .group-item[data-v-a7d365c4]{position:absolute}.custom-image[data-v-51bcdfe3]{color:var(--35be3580);background-color:var(--7a3808fb);padding:var(--565e2eee);border-radius:var(--ca4fabd6)}.text-wrap[data-v-8233b39d]{height:100%;color:var(--46dd5ff7);background-color:var(--7f931c9c);padding:var(--c746d0b6);border-radius:var(--a4c36304);font-size:var(--522c9048);border:var(--27fc0faa);word-break:break-all}.text-wrap[data-v-b9e7c0b0]{color:var(--00cd0a69);background-color:var(--863570b8);padding:var(--cde924d2);border-radius:var(--31a3f24c);font-size:var(--7015a02a);border:var(--aedef5c6);word-break:break-all;white-space:var(--ba981f16);overflow:var(--58ddca96);text-overflow:var(--6b9be9da)}.icon-wrap[data-v-6b52c610]{color:var(--46bf371c);stroke:var(--46bf371c);fill:var(--5a1a592f);background-color:var(--1d6b7926);padding:var(--651f2d40);border-radius:var(--5f884d3a);font-size:var(--6f5fc4fe)}.icon-wrap.color-self[data-v-6b52c610] *{color:var(--46bf371c);stroke:var(--46bf371c);fill:var(--5a1a592f)}.img-scale-wrap[data-v-321d426b]{position:relative;width:100%;height:100%;color:var(--ef6c025e);background-color:var(--58f6c20c);padding:var(--351ce7ff);border-radius:var(--cc74ea38)}.img-scale-wrap .img-scale-reduce[data-v-321d426b]{position:absolute;overflow:hidden;width:100%;height:100%;transition:.1s}.img-scale-wrap .img-scale[data-v-321d426b]{display:block;position:absolute;width:100%;height:100%}.drag-editor-preivew-wrap[data-v-b2568ace]{width:100%;height:100%;min-width:200px;min-height:200px}.drag-editor-preivew[data-v-b2568ace]{width:100%;height:100%}.drag-editor-preivew[data-v-b2568ace] .handle{display:none!important}.preview-item-wrap[data-v-b2568ace]{touch-action:none;position:absolute;box-sizing:border-box;-webkit-user-select:none;user-select:none}")),document.head.appendChild(a)}}catch(r){console.error("vite-plugin-css-injected-by-js",r)}})();
(function(e,b){typeof exports=="object"&&typeof module<"u"?module.exports=b(require("vue")):typeof define=="function"&&define.amd?define(["vue"],b):(e=typeof globalThis<"u"?globalThis:e||self,e["drag-pannel-preview"]=b(e.Vue))})(this,function(e){"use strict";const b=Object.freeze(Object.defineProperty({__proto__:null,get default(){return y}},Symbol.toStringTag,{value:"Module"})),w=(c,t)=>{let l=c.self,o=l.activeValue,n=l.prop,r=l.activeMode,u=l.activeMap;if(!n||!r||!u)return l;let d=!1;switch(r){case"大于":t[n]>o&&(d=!0);break;case"小于":t[n]<o&&(d=!0);break;case"等于":t[n]==o&&(d=!0);break;case"不等于":t[n]!=o&&(d=!0);break;case"大于等于":t[n]>=o&&(d=!0);break;case"小于等于":t[n]<o&&(d=!0);break;case"存在":t[n]!==void 0&&t[n]!==null&&(d=!0);break;case"不存在":t[n]===void 0&&t[n]===null&&(d=!0);break}let p={};return d&&(p=V(u,t)),{...l,...p}},V=(c,t)=>{let l={},o=/\$\{(.*?)\}/g;try{l=JSON.parse(c);for(var n in l){let r=l[n];if(o.test(r)){let u=r.replace(/[\$|{|}]/g,"");l[n]=(t==null?void 0:t[u])??void 0}}}catch(r){console.error("解析 activeMap 失败",r)}return l},S={class:"group-wrap"},x=["a"],B=e.defineComponent({__name:"index",props:{data:{},modelValue:{default:()=>({})},groupModel:{default:()=>({})},disabled:{type:Boolean}},setup(c){const t=c,l=r=>k(r).default,o=r=>({width:r.w=="auto"?r.w:r.w+"px",height:r.h=="auto"?r.h:r.h+"px",transform:`translate(${r.x}px, ${r.y}px) rotate(${r.r||0}deg)`}),n=r=>w(r,t.groupModel);return(r,u)=>(e.openBlock(),e.createElementBlock("div",S,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.data.group,d=>(e.openBlock(),e.createElementBlock("div",{a:d.active,class:"group-item",style:e.normalizeStyle(o(d))},[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(l(d.self.name)),e.mergeProps({data:d,h:d.h,w:d.w},n(d),{modelValue:r.groupModel[d.self.modelValue],"onUpdate:modelValue":p=>r.groupModel[d.self.modelValue]=p,defaultModelValue:d.self.defaultModelValue,"onUpdate:defaultModelValue":p=>d.self.defaultModelValue=p,disabled:!0}),null,16,["data","h","w","modelValue","onUpdate:modelValue","defaultModelValue","onUpdate:defaultModelValue"]))],12,x))),256))]))}}),q="",h=(c,t)=>{const l=c.__vccOpts||c;for(const[o,n]of t)l[o]=n;return l},$=Object.freeze(Object.defineProperty({__proto__:null,default:h(B,[["__scopeId","data-v-a7d365c4"]])},Symbol.toStringTag,{value:"Module"})),z=["width","height","src"],v=e.defineComponent({__name:"index",props:{url:{},w:{},h:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""}},setup(c){const t=c;e.useCssVars(o=>({"35be3580":o.color,"7a3808fb":o.bgColor,"565e2eee":o.padding,ca4fabd6:o.radius})),e.watch(()=>[t.w,t.h],()=>l()),e.onMounted(()=>{l()});const l=()=>{};return(o,n)=>(e.openBlock(),e.createElementBlock("img",{class:"custom-image",width:o.w,height:o.h,src:o.url,alt:""},null,8,z))}}),J="",O=Object.freeze(Object.defineProperty({__proto__:null,default:h(v,[["__scopeId","data-v-51bcdfe3"]])},Symbol.toStringTag,{value:"Module"})),E=Object.freeze(Object.defineProperty({__proto__:null,default:e.defineComponent({__name:"index",props:{url:{},w:{},h:{},flip:{}},setup(c){const t=c;let l=e.ref(),o="",n=!0,r="";e.watch(()=>[t.w,t.h],()=>u()),e.watch(()=>{var p,s;return[(p=t.flip)==null?void 0:p.horizontal,(s=t.flip)==null?void 0:s.vertical]},()=>d()),e.onMounted(()=>{o=l.value.getContext("2d"),u()});const u=()=>{let p=t.w,s=t.h;l.value.width=p,l.value.height=s,n?(n=!1,r=document.createElement("img"),r.src=t.url,r.onload=()=>{o.drawImage(r,0,0,p,s),d()}):d()},d=()=>{const{vertical:p,horizontal:s}=t.flip??{};let _=t.w,a=t.h;const g=s?-1:1,i=p?-1:1;o.clearRect(0,0,_,a),o.translate(_/2-_*g/2,a/2-a*i/2),o.scale(g,i),o.drawImage(r,0,0,_,a),o.setTransform(1,0,0,1,0,0)};return(p,s)=>(e.openBlock(),e.createElementBlock("canvas",{ref_key:"canvas",ref:l},null,512))}})},Symbol.toStringTag,{value:"Module"})),T={class:"text-wrap"},j=e.defineComponent({__name:"index",props:{modelValue:{default:""},defaultModelValue:{default:""},data:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""},fontSize:{default:""},borderColor:{default:""},w:{},h:{}},setup(c){return e.useCssVars(t=>({"46dd5ff7":t.color,"7f931c9c":t.bgColor,c746d0b6:t.padding,a4c36304:t.radius,"522c9048":t.fontSize,"27fc0faa":t.borderColor})),(t,l)=>(e.openBlock(),e.createElementBlock("div",T,e.toDisplayString(t.modelValue||t.defaultModelValue),1))}}),Z="",I=Object.freeze(Object.defineProperty({__proto__:null,default:h(j,[["__scopeId","data-v-8233b39d"]])},Symbol.toStringTag,{value:"Module"})),P=["contenteditable"],H=e.defineComponent({__name:"index",props:{modelValue:{default:""},defaultModelValue:{},data:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""},fontSize:{default:""},borderColor:{default:""},w:{},h:{},noWordWrap:{type:Boolean,default:!1},overEllipsis:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},hasModelValue:{type:Boolean}},emits:["update:modelValue","update:defaultModelValue","click"],setup(c,{emit:t}){const l=c;e.useCssVars(s=>({"00cd0a69":s.color,"863570b8":s.bgColor,cde924d2:s.padding,"31a3f24c":s.radius,"7015a02a":s.fontSize,aedef5c6:s.borderColor,ba981f16:s.noWordWrap?"nowrap":"","58ddca96":s.overEllipsis?"hidden":"auto","6b9be9da":s.overEllipsis?"ellipsis":"unset"}));let o=e.ref(!1),n=e.ref();const r=async()=>{l.disabled||(o.value=!0,u(n.value),await e.nextTick(),n.value.focus())},u=s=>{const _=window.getSelection(),a=document.createRange();a.selectNodeContents(s),_.removeAllRanges(),_.addRange(a)},d=()=>{o.value=!1},p=s=>{l.hasModelValue&&t("update:modelValue",s.target.innerText),t("update:defaultModelValue",s.target.innerText)};return(s,_)=>(e.openBlock(),e.createElementBlock("div",{contenteditable:e.unref(o),onBlur:d,onInput:p,ref_key:"text",ref:n,class:e.normalizeClass({"text-wrap":!0,"can-edit":e.unref(o)}),onDblclick:r},e.toDisplayString(s.modelValue||s.defaultModelValue),43,P))}}),te="",R=Object.freeze(Object.defineProperty({__proto__:null,default:h(H,[["__scopeId","data-v-b9e7c0b0"]])},Symbol.toStringTag,{value:"Module"})),U=["innerHTML"],A=e.defineComponent({__name:"index",props:{url:{},color:{default:""},bgColor:{default:""},fillColor:{default:""},padding:{default:""},radius:{default:""},fontSize:{default:""},iconUseSelfColor:{type:Boolean}},setup(c){return e.useCssVars(t=>({"46bf371c":t.color,"5a1a592f":t.fillColor,"1d6b7926":t.bgColor,"651f2d40":t.padding,"5f884d3a":t.radius,"6f5fc4fe":t.fontSize})),(t,l)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass({"icon-wrap":!0,"color-self":t.iconUseSelfColor}),innerHTML:t.url},null,10,U))}}),oe="",W=Object.freeze(Object.defineProperty({__proto__:null,default:h(A,[["__scopeId","data-v-6b52c610"]])},Symbol.toStringTag,{value:"Module"})),N={class:"img-scale-wrap"},D=["src"],F=e.defineComponent({__name:"index",props:{url:{},w:{},h:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""},lockAspectRatio:{type:Boolean,default:!1},position:{default:"left"},imgWidth:{},imgHeight:{}},setup(c){const t=c;e.useCssVars(n=>({ef6c025e:n.color,"58f6c20c":n.bgColor,"351ce7ff":n.padding,cc74ea38:n.radius}));let l=e.computed(()=>({[t.position]:0,width:t.imgWidth,height:t.imgHeight})),o=e.computed(()=>({[t.position]:0,width:t.lockAspectRatio?t.w+"px":void 0,height:t.lockAspectRatio?t.h+"px":void 0}));return(n,r)=>(e.openBlock(),e.createElementBlock("div",N,[e.createElementVNode("div",{class:"img-scale-reduce",style:e.normalizeStyle(e.unref(l))},[e.createElementVNode("img",{class:"img-scale",src:n.url,alt:"",style:e.normalizeStyle(e.unref(o))},null,12,D)],4)]))}}),ne="";let L=Object.assign({"./Group/index.vue":$,"./Image/index.vue":O,"./Picture/index.vue":E,"./Shape/index.vue":I,"./Text/index.vue":R,"./icon-svg/index.vue":W,"./img-scale/index.vue":Object.freeze(Object.defineProperty({__proto__:null,default:h(F,[["__scopeId","data-v-321d426b"]])},Symbol.toStringTag,{value:"Module"})),"./preview/index.vue":b});const k=c=>L[`./${c}/index.vue`],X=e.defineComponent({name:"dragPannelPreview"}),Y=e.defineComponent({...X,props:{pannel:{},modelValue:{default:()=>({})},disabled:{type:Boolean,default:!1},parentWidth:{default:0}},emits:["click"],setup(c,{emit:t}){const l=c;let o=e.ref(),n=e.ref({});e.onMounted(()=>{u()});const r=a=>({width:a.w==="auto"?a.w:a.w+"px",height:a.h==="auto"?a.h:a.h+"px",fontSize:l.pannel.fontSize||a.fontSize,zIndex:a.z||"auto",transform:`translate(${a.x||0}px, ${a.y||0}px) rotate(${a.r||0}deg)`}),u=async()=>{await e.nextTick();let a={transformOrigin:"0% 0%",width:l.pannel.width+"px",height:l.pannel.height+"px",color:l.pannel.color,fontSize:l.pannel.fontSize,backgroundColor:l.pannel.bgColor},g=o.value.getBoundingClientRect(),{endRate:i,translateX:f,translateY:m}=d(g.width,g.height);n.value={...a,transform:`translate(${f}px, ${m}px) scale(${i})`}},d=(a,g)=>{let i=a/l.pannel.width,f=g/l.pannel.height,m=i>f?f:i,C=i<=f?0:a*m,M=f<=i?0:g*m;return{endRate:m,translateX:C>0?a/2-l.pannel.width/2*m:C,translateY:M>0?g/2-l.pannel.height/2*m:M}},p=a=>k(a).default,s=a=>{a.self.click&&(console.log("click"),t("click",a))},_=a=>w(a,l.modelValue);return(a,g)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"wrapRef",ref:o,class:"drag-editor-preivew-wrap"},[e.createElementVNode("div",{class:e.normalizeClass({"drag-editor-preivew":!0}),style:e.normalizeStyle(e.unref(n))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.pannel.components,i=>(e.openBlock(),e.createElementBlock("div",{class:"preview-item-wrap",style:e.normalizeStyle(r(i))},[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(p(i.self.name)),e.mergeProps({data:i,h:i.h,w:i.w},_(i),{onClickCapture:e.withModifiers(f=>s(i),["self"]),modelValue:a.modelValue[i.self.modelValue],"onUpdate:modelValue":f=>a.modelValue[i.self.modelValue]=f,defaultModelValue:i.self.defaultModelValue,"onUpdate:defaultModelValue":f=>i.self.defaultModelValue=f,groupModel:a.modelValue,disabled:!0}),null,16,["data","h","w","onClickCapture","modelValue","onUpdate:modelValue","defaultModelValue","onUpdate:defaultModelValue","groupModel"]))],4))),256))],4)],512))}}),se="",y=h(Y,[["__scopeId","data-v-b2568ace"]]);return y.install=c=>{c.component(y.name,y)},y});
