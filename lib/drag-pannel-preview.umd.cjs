(function(){"use strict";try{if(typeof document<"u"){var a=document.createElement("style");a.appendChild(document.createTextNode(".group-wrap[data-v-efe5d5a7]{position:absolute;left:0;top:0;width:100%;height:100%}.group-wrap .group-item[data-v-efe5d5a7]{position:absolute}.custom-image[data-v-51bcdfe3]{color:var(--35be3580);background-color:var(--7a3808fb);padding:var(--565e2eee);border-radius:var(--ca4fabd6)}.shap-wrap[data-v-400016bf]{word-break:break-all;box-sizing:border-box;height:100%;color:var(--34b705a8);background-color:var(--c38521ba);padding:var(--7a639516);border-radius:var(--7af95eed);font-size:var(--8c7b2eea);border:var(--4a7ad51c)}.text-wrap[data-v-8f822377]{color:var(--47b5a944);background-color:var(--27bcc882);padding:var(--6f707c9c);border-radius:var(--7061a25e);font-size:var(--2863cf6f);border:var(--7aff53b8);word-break:break-all;white-space:var(--3b2782fa);overflow:var(--514c5593);text-overflow:var(--71345cf5);text-align:var(--70e03432);width:100%;height:100%;box-sizing:border-box}.icon-wrap[data-v-6b52c610]{color:var(--46bf371c);stroke:var(--46bf371c);fill:var(--5a1a592f);background-color:var(--1d6b7926);padding:var(--651f2d40);border-radius:var(--5f884d3a);font-size:var(--6f5fc4fe)}.icon-wrap.color-self[data-v-6b52c610] *{color:var(--46bf371c);stroke:var(--46bf371c);fill:var(--5a1a592f)}.img-scale-wrap[data-v-c83ce927]{position:relative;width:100%;height:100%;color:var(--806595a2);background-color:var(--86f44e2c);padding:var(--cea80246);border-radius:var(--52a92046)}.img-scale-wrap .img-scale-reduce[data-v-c83ce927]{position:absolute;overflow:hidden;width:100%;height:100%;transition:.1s}.img-scale-wrap .img-scale[data-v-c83ce927]{display:block;position:absolute;width:100%;height:100%;-webkit-user-drag:none}.drag-editor-preivew-wrap[data-v-b9ca1a47]{width:100%;height:100%;min-width:200px;min-height:200px}.drag-editor-preivew[data-v-b9ca1a47]{width:100%;height:100%}.drag-editor-preivew[data-v-b9ca1a47] .handle{display:none!important}.preview-item-wrap[data-v-b9ca1a47]{touch-action:none;position:absolute;box-sizing:border-box;-webkit-user-select:none;user-select:none}.preview-item-wrap img[data-v-b9ca1a47]{-webkit-user-drag:none}.dycomponent-class[hide][data-v-b9ca1a47]{display:none}")),document.head.appendChild(a)}}catch(e){console.error("vite-plugin-css-injected-by-js",e)}})();
(function(e,b){typeof exports=="object"&&typeof module<"u"?module.exports=b(require("vue")):typeof define=="function"&&define.amd?define(["vue"],b):(e=typeof globalThis<"u"?globalThis:e||self,e["drag-pannel-preview"]=b(e.Vue))})(this,function(e){"use strict";const b=Object.freeze(Object.defineProperty({__proto__:null,get default(){return y}},Symbol.toStringTag,{value:"Module"})),w=(c,t)=>{let l=c.self,a=l.activeValue,n=l.prop,d=l.activeMode,f=l.activeMap;if(!n||!d||!f)return l;let r=!1;switch(d){case"大于":t[n]>a&&(r=!0);break;case"小于":t[n]<a&&(r=!0);break;case"等于":t[n]==a&&(r=!0);break;case"不等于":t[n]!=a&&(r=!0);break;case"大于等于":t[n]>=a&&(r=!0);break;case"小于等于":t[n]<a&&(r=!0);break;case"存在":t[n]!==void 0&&t[n]!==null&&(r=!0);break;case"不存在":(t[n]===void 0||t[n]===null)&&(r=!0);break}let i={};return r&&(i=V(f,t)),{...l,...i}},V=(c,t)=>{var d,f;let l={},a=/\$\{(.*?)\}.*/g;try{l=JSON.parse(c);for(var n in l){let r=l[n];if(a.test(r)){let i=/\$\{(.*?)\}/g,s=((d=r.match(i))==null?void 0:d[0])??"",u=r.split(s),o=s.replace(/[\$|{|}]/g,""),_=(t==null?void 0:t[o])??"";l[n]=(f=u.join)==null?void 0:f.call(u,_)}}}catch(r){console.error("解析 activeMap 失败",r)}return l},S={class:"group-wrap"},B=["a"],x=e.defineComponent({__name:"index",props:{data:{},modelValue:{default:()=>({})},groupModel:{default:()=>({})},disabled:{type:Boolean}},setup(c){const t=c,l=d=>k(d).default,a=d=>({width:d.w=="auto"?d.w:d.w+"px",height:d.h=="auto"?d.h:d.h+"px",transform:`translate(${d.x}px, ${d.y}px) rotate(${d.r||0}deg)`}),n=d=>w(d,t.groupModel);return(d,f)=>(e.openBlock(),e.createElementBlock("div",S,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(d.data.group,r=>(e.openBlock(),e.createElementBlock("div",{a:r.active,class:"group-item",style:e.normalizeStyle(a(r))},[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(l(r.self.name)),e.mergeProps({data:r,h:r.h,w:r.w},n(r),{modelValue:d.groupModel[r.self.modelValue],"onUpdate:modelValue":i=>d.groupModel[r.self.modelValue]=i,defaultModelValue:r.self.defaultModelValue,"onUpdate:defaultModelValue":i=>r.self.defaultModelValue=i,disabled:!0}),null,16,["data","h","w","modelValue","onUpdate:modelValue","defaultModelValue","onUpdate:defaultModelValue"]))],12,B))),256))]))}}),q="",h=(c,t)=>{const l=c.__vccOpts||c;for(const[a,n]of t)l[a]=n;return l},$=Object.freeze(Object.defineProperty({__proto__:null,default:h(x,[["__scopeId","data-v-efe5d5a7"]])},Symbol.toStringTag,{value:"Module"})),z=["width","height","src"],v=e.defineComponent({__name:"index",props:{url:{},w:{},h:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""}},setup(c){const t=c;e.useCssVars(a=>({"35be3580":a.color,"7a3808fb":a.bgColor,"565e2eee":a.padding,ca4fabd6:a.radius})),e.watch(()=>[t.w,t.h],()=>l()),e.onMounted(()=>{l()});const l=()=>{};return(a,n)=>(e.openBlock(),e.createElementBlock("img",{class:"custom-image",width:a.w,height:a.h,src:a.url,alt:""},null,8,z))}}),J="",O=Object.freeze(Object.defineProperty({__proto__:null,default:h(v,[["__scopeId","data-v-51bcdfe3"]])},Symbol.toStringTag,{value:"Module"})),E=Object.freeze(Object.defineProperty({__proto__:null,default:e.defineComponent({__name:"index",props:{url:{},w:{},h:{},flip:{}},setup(c){const t=c;let l=e.ref(),a="",n=!0,d="";e.watch(()=>[t.w,t.h],()=>f()),e.watch(()=>{var i,s;return[(i=t.flip)==null?void 0:i.horizontal,(s=t.flip)==null?void 0:s.vertical]},()=>r()),e.onMounted(()=>{a=l.value.getContext("2d"),f()});const f=()=>{let i=t.w,s=t.h;l.value.width=i,l.value.height=s,n?(n=!1,d=document.createElement("img"),d.src=t.url,d.onload=()=>{a.drawImage(d,0,0,i,s),r()}):r()},r=()=>{const{vertical:i,horizontal:s}=t.flip??{};let u=t.w,o=t.h;const _=s?-1:1,p=i?-1:1;a.clearRect(0,0,u,o),a.translate(u/2-u*_/2,o/2-o*p/2),a.scale(_,p),a.drawImage(d,0,0,u,o),a.setTransform(1,0,0,1,0,0)};return(i,s)=>(e.openBlock(),e.createElementBlock("canvas",{ref_key:"canvas",ref:l},null,512))}})},Symbol.toStringTag,{value:"Module"})),j={class:"shap-wrap"},T=e.defineComponent({__name:"index",props:{modelValue:{default:""},defaultModelValue:{default:""},data:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""},fontSize:{default:""},borderColor:{default:""},w:{},h:{}},setup(c){return e.useCssVars(t=>({"34b705a8":t.color,c38521ba:t.bgColor,"7a639516":t.padding,"7af95eed":t.radius,"8c7b2eea":t.fontSize,"4a7ad51c":t.borderColor})),(t,l)=>(e.openBlock(),e.createElementBlock("div",j,e.toDisplayString(t.modelValue||t.defaultModelValue),1))}}),Z="",I=Object.freeze(Object.defineProperty({__proto__:null,default:h(T,[["__scopeId","data-v-400016bf"]])},Symbol.toStringTag,{value:"Module"})),P=["contenteditable"],H=e.defineComponent({__name:"index",props:{modelValue:{default:""},defaultModelValue:{},data:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""},fontSize:{default:""},borderColor:{default:""},align:{},w:{},h:{},noWordWrap:{type:Boolean,default:!1},overEllipsis:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},hasModelValue:{type:Boolean}},emits:["update:modelValue","update:defaultModelValue","click"],setup(c,{emit:t}){const l=c;e.useCssVars(s=>({"47b5a944":s.color,"27bcc882":s.bgColor,"6f707c9c":s.padding,"7061a25e":s.radius,"2863cf6f":s.fontSize,"7aff53b8":s.borderColor,"3b2782fa":s.noWordWrap?"nowrap":"","514c5593":s.overEllipsis?"hidden":"visible","71345cf5":s.overEllipsis?"ellipsis":"unset","70e03432":s.align?s.align:"left"}));let a=e.ref(!1),n=e.ref();const d=async()=>{l.disabled||(a.value=!0,f(n.value),await e.nextTick(),n.value.focus())},f=s=>{const u=window.getSelection(),o=document.createRange();o.selectNodeContents(s),u.removeAllRanges(),u.addRange(o)},r=()=>{a.value=!1},i=s=>{l.hasModelValue&&t("update:modelValue",s.target.innerText),t("update:defaultModelValue",s.target.innerText)};return(s,u)=>(e.openBlock(),e.createElementBlock("div",{contenteditable:e.unref(a),onBlur:r,onInput:i,ref_key:"text",ref:n,class:e.normalizeClass({"text-wrap":!0,"can-edit":e.unref(a)}),onDblclick:d},e.toDisplayString(s.modelValue||s.defaultModelValue),43,P))}}),te="",R=Object.freeze(Object.defineProperty({__proto__:null,default:h(H,[["__scopeId","data-v-8f822377"]])},Symbol.toStringTag,{value:"Module"})),U=["innerHTML"],W=e.defineComponent({__name:"index",props:{url:{},color:{default:""},bgColor:{default:""},fillColor:{default:""},padding:{default:""},radius:{default:""},fontSize:{default:""},iconUseSelfColor:{type:Boolean}},setup(c){return e.useCssVars(t=>({"46bf371c":t.color,"5a1a592f":t.fillColor,"1d6b7926":t.bgColor,"651f2d40":t.padding,"5f884d3a":t.radius,"6f5fc4fe":t.fontSize})),(t,l)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass({"icon-wrap":!0,"color-self":t.iconUseSelfColor}),innerHTML:t.url},null,10,U))}}),ae="",A=Object.freeze(Object.defineProperty({__proto__:null,default:h(W,[["__scopeId","data-v-6b52c610"]])},Symbol.toStringTag,{value:"Module"})),N={class:"img-scale-wrap"},D=["src"],F=e.defineComponent({__name:"index",props:{url:{},w:{},h:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""},lockAspectRatio:{type:Boolean,default:!1},position:{default:"left"},imgWidth:{},imgHeight:{}},setup(c){const t=c;e.useCssVars(n=>({"806595a2":n.color,"86f44e2c":n.bgColor,cea80246:n.padding,"52a92046":n.radius}));let l=e.computed(()=>({[t.position]:0,width:t.imgWidth,height:t.imgHeight})),a=e.computed(()=>({[t.position]:0,width:t.lockAspectRatio?t.w+"px":void 0,height:t.lockAspectRatio?t.h+"px":void 0}));return(n,d)=>(e.openBlock(),e.createElementBlock("div",N,[e.createElementVNode("div",{class:"img-scale-reduce",style:e.normalizeStyle(e.unref(l))},[e.createElementVNode("img",{class:"img-scale",src:n.url,alt:"",style:e.normalizeStyle(e.unref(a))},null,12,D)],4)]))}}),ne="";let L=Object.assign({"./Group/index.vue":$,"./Image/index.vue":O,"./Picture/index.vue":E,"./Shape/index.vue":I,"./Text/index.vue":R,"./icon-svg/index.vue":A,"./img-scale/index.vue":Object.freeze(Object.defineProperty({__proto__:null,default:h(F,[["__scopeId","data-v-c83ce927"]])},Symbol.toStringTag,{value:"Module"})),"./preview/index.vue":b});const k=c=>L[`./${c}/index.vue`],X=e.defineComponent({name:"dragPannelPreview"}),Y=e.defineComponent({...X,props:{pannel:{},modelValue:{default:()=>({})},disabled:{type:Boolean,default:!1},parentWidth:{default:0}},emits:["click"],setup(c,{emit:t}){const l=c;let a=e.ref(),n=e.ref({});e.onMounted(()=>{f()});const d=o=>({width:o.w==="auto"?o.w:o.w+"px",height:o.h==="auto"?o.h:o.h+"px",fontSize:l.pannel.fontSize||o.fontSize,zIndex:o.z||"auto",transform:`translate(${o.x||0}px, ${o.y||0}px) rotate(${o.r||0}deg)`}),f=async()=>{await e.nextTick();let o={transformOrigin:"0% 0%",width:l.pannel.width+"px",height:l.pannel.height+"px",color:l.pannel.color,fontSize:l.pannel.fontSize,backgroundColor:l.pannel.bgColor},_=a.value.getBoundingClientRect(),{endRate:p,translateX:g,translateY:m}=r(_.width,_.height);n.value={...o,transform:`translate(${g}px, ${m}px) scale(${p})`}},r=(o,_)=>{let p=o/l.pannel.width,g=_/l.pannel.height,m=p>g?g:p,C=p<=g?0:o*m,M=g<=p?0:_*m;return{endRate:m,translateX:C>0?o/2-l.pannel.width/2*m:C,translateY:M>0?_/2-l.pannel.height/2*m:M}},i=o=>k(o).default,s=o=>{o.self.click&&(console.log("click"),t("click",o))},u=o=>w(o,l.modelValue);return(o,_)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"wrapRef",ref:a,class:"drag-editor-preivew-wrap"},[e.createElementVNode("div",{class:e.normalizeClass({"drag-editor-preivew":!0}),style:e.normalizeStyle(e.unref(n))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.pannel.components,p=>(e.openBlock(),e.createElementBlock("div",{class:"preview-item-wrap",style:e.normalizeStyle(d(p))},[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(i(p.self.name)),e.mergeProps({class:"dycomponent-class",data:p,h:p.h,w:p.w},u(p),{onClickCapture:g=>s(p),modelValue:o.modelValue[p.self.modelValue],"onUpdate:modelValue":g=>o.modelValue[p.self.modelValue]=g,defaultModelValue:p.self.defaultModelValue,"onUpdate:defaultModelValue":g=>p.self.defaultModelValue=g,groupModel:o.modelValue,disabled:!0}),null,16,["data","h","w","onClickCapture","modelValue","onUpdate:modelValue","defaultModelValue","onUpdate:defaultModelValue","groupModel"]))],4))),256))],4)],512))}}),se="",y=h(Y,[["__scopeId","data-v-b9ca1a47"]]);return y.install=c=>{c.component(y.name,y)},y});
