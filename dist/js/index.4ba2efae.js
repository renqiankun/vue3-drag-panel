import{G as D,a as L,ag as B,l as C,M as j,O as w,H as Ye,a5 as Zt,P as it,p as I,K as be,S as $,T as ie,V as Bt,d as ge,n as Re,m as A,F as Y,a7 as ae,I as de,J as Q,u as g,a2 as Me,Q as Ie,b as Z,aw as ce,e as F,ax as Dt,r as Pt,X as ea,g as ta,o as aa,s as It,Z as ue,c as oa,U as v,A as ve,z as Ke,Y as $t,R as me,ay as la,az as na,E as ia,as as sa}from"./base-module.a8b61ce6.js";import{E as Pe,d as ra,a as da,c as ua,i as ca}from"./element-plus.fccf1f22.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function o(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(n){if(n.ep)return;n.ep=!0;const l=o(n);fetch(n.href,l)}})();const fa=["accept"],je=D({__name:"index",props:{accept:{default:""},maxSize:{default:1/0},text:{default:"上传文件"},preCheck:{}},emits:["change"],setup(t,{emit:e}){const o=t;let a=L("");const n=async c=>{var f,y;var s=((y=(f=c.target)==null?void 0:f.files)==null?void 0:y[0])??{};try{c.target.value=""}catch{}let i=s.name,r=s.size,m=o.maxSize,u=i.lastIndexOf("."),d=i.slice(u),h=o.accept.split(",");if(h.length>0&&h.indexOf(d)<=-1)return Pe.error("文件格式错误，请重新上传!"),!1;if(r>m)return Pe.error("文件不可大于10M");e("change",s)},l=async()=>{var s,i,r;if(o.preCheck){var c=await((s=o.preCheck)==null?void 0:s.call(o));if(!c)return}(r=(i=a.value).click)==null||r.call(i)};return(c,s)=>{const i=B("el-button");return C(),j(i,be({type:"primary",plain:"",onClick:l},c.$attrs),{default:w(()=>[Ye(c.$slots,"default",{},()=>[$(ie(c.text),1)]),(C(),j(Zt,{to:"body"},[it(I("input",{type:"file",ref_key:"uploadRef",ref:a,onChange:n,accept:c.accept},null,40,fa),[[Bt,!1]])]))]),_:3},16)}}});(function(){try{if(typeof document<"u"){var t=document.createElement("style");t.appendChild(document.createTextNode(".group-wrap[data-v-a7d365c4]{position:absolute;left:0;top:0;width:100%;height:100}.group-wrap .group-item[data-v-a7d365c4]{position:absolute}.custom-image[data-v-51bcdfe3]{color:var(--35be3580);background-color:var(--7a3808fb);padding:var(--565e2eee);border-radius:var(--ca4fabd6)}.text-wrap[data-v-8233b39d]{height:100%;color:var(--46dd5ff7);background-color:var(--7f931c9c);padding:var(--c746d0b6);border-radius:var(--a4c36304);font-size:var(--522c9048);border:var(--27fc0faa);word-break:break-all}.text-wrap[data-v-b9e7c0b0]{color:var(--00cd0a69);background-color:var(--863570b8);padding:var(--cde924d2);border-radius:var(--31a3f24c);font-size:var(--7015a02a);border:var(--aedef5c6);word-break:break-all;white-space:var(--ba981f16);overflow:var(--58ddca96);text-overflow:var(--6b9be9da)}.icon-wrap[data-v-6b52c610]{color:var(--46bf371c);stroke:var(--46bf371c);fill:var(--5a1a592f);background-color:var(--1d6b7926);padding:var(--651f2d40);border-radius:var(--5f884d3a);font-size:var(--6f5fc4fe)}.icon-wrap.color-self[data-v-6b52c610] *{color:var(--46bf371c);stroke:var(--46bf371c);fill:var(--5a1a592f)}.img-scale-wrap[data-v-321d426b]{position:relative;width:100%;height:100%;color:var(--ef6c025e);background-color:var(--58f6c20c);padding:var(--351ce7ff);border-radius:var(--cc74ea38)}.img-scale-wrap .img-scale-reduce[data-v-321d426b]{position:absolute;overflow:hidden;width:100%;height:100%;transition:.1s}.img-scale-wrap .img-scale[data-v-321d426b]{display:block;position:absolute;width:100%;height:100%}.drag-editor-preivew-wrap[data-v-b2568ace]{width:100%;height:100%;min-width:200px;min-height:200px}.drag-editor-preivew[data-v-b2568ace]{width:100%;height:100%}.drag-editor-preivew[data-v-b2568ace] .handle{display:none!important}.preview-item-wrap[data-v-b2568ace]{touch-action:none;position:absolute;box-sizing:border-box;-webkit-user-select:none;user-select:none}")),document.head.appendChild(t)}}catch(e){console.error("vite-plugin-css-injected-by-js",e)}})();const ha=Object.freeze(Object.defineProperty({__proto__:null,get default(){return Be}},Symbol.toStringTag,{value:"Module"}));function He(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>(t==="x"?Math.random()*16|0:"r&0x3"|"0x8").toString(16))}const Wt=(t,e)=>{let o=t.self,a=o.activeValue,n=o.prop,l=o.activeMode,c=o.activeMap;if(!n||!l||!c)return o;let s=!1;switch(l){case"大于":e[n]>a&&(s=!0);break;case"小于":e[n]<a&&(s=!0);break;case"等于":e[n]==a&&(s=!0);break;case"不等于":e[n]!=a&&(s=!0);break;case"大于等于":e[n]>=a&&(s=!0);break;case"小于等于":e[n]<a&&(s=!0);break;case"存在":e[n]!==void 0&&e[n]!==null&&(s=!0);break;case"不存在":e[n]===void 0&&e[n]===null&&(s=!0);break}let i={};return s&&(i=pa(c,e)),{...o,...i}},pa=(t,e)=>{let o={},a=/\$\{(.*?)\}/g;try{o=JSON.parse(t);for(var n in o){let l=o[n];if(a.test(l)){let c=l.replace(/[\$|{|}]/g,"");o[n]=(e==null?void 0:e[c])??void 0}}}catch(l){console.error("解析 activeMap 失败",l)}return o},ma={class:"group-wrap"},ga=["a"],va=D({__name:"index",props:{data:{},modelValue:{default:()=>({})},groupModel:{default:()=>({})},disabled:{type:Boolean}},setup(t){const e=t,o=l=>Nt(l).default,a=l=>({width:l.w=="auto"?l.w:l.w+"px",height:l.h=="auto"?l.h:l.h+"px",transform:`translate(${l.x}px, ${l.y}px) rotate(${l.r||0}deg)`}),n=l=>Wt(l,e.groupModel);return(l,c)=>(C(),A("div",ma,[(C(!0),A(Y,null,ae(l.data.group,s=>(C(),A("div",{a:s.active,class:"group-item",style:Q(a(s))},[(C(),j(Ie(o(s.self.name)),be({data:s,h:s.h,w:s.w},n(s),{modelValue:l.groupModel[s.self.modelValue],"onUpdate:modelValue":i=>l.groupModel[s.self.modelValue]=i,defaultModelValue:s.self.defaultModelValue,"onUpdate:defaultModelValue":i=>s.self.defaultModelValue=i,disabled:!0}),null,16,["data","h","w","modelValue","onUpdate:modelValue","defaultModelValue","onUpdate:defaultModelValue"]))],12,ga))),256))]))}}),Se=(t,e)=>{const o=t.__vccOpts||t;for(const[a,n]of e)o[a]=n;return o},ba=Se(va,[["__scopeId","data-v-a7d365c4"]]),ya=Object.freeze(Object.defineProperty({__proto__:null,default:ba},Symbol.toStringTag,{value:"Module"})),_a=["width","height","src"],wa=D({__name:"index",props:{url:{},w:{},h:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""}},setup(t){const e=t;ce(a=>({"35be3580":a.color,"7a3808fb":a.bgColor,"565e2eee":a.padding,ca4fabd6:a.radius})),Z(()=>[e.w,e.h],()=>o()),ge(()=>{o()});const o=()=>{};return(a,n)=>(C(),A("img",{class:"custom-image",width:a.w,height:a.h,src:a.url,alt:""},null,8,_a))}}),xa=Se(wa,[["__scopeId","data-v-51bcdfe3"]]),Va=Object.freeze(Object.defineProperty({__proto__:null,default:xa},Symbol.toStringTag,{value:"Module"})),Ma=D({__name:"index",props:{url:{},w:{},h:{},flip:{}},setup(t){const e=t;let o=L(),a="",n=!0,l="";Z(()=>[e.w,e.h],()=>c()),Z(()=>{var i,r;return[(i=e.flip)==null?void 0:i.horizontal,(r=e.flip)==null?void 0:r.vertical]},()=>s()),ge(()=>{a=o.value.getContext("2d"),c()});const c=()=>{let i=e.w,r=e.h;o.value.width=i,o.value.height=r,n?(n=!1,l=document.createElement("img"),l.src=e.url,l.onload=()=>{a.drawImage(l,0,0,i,r),s()}):s()},s=()=>{const{vertical:i,horizontal:r}=e.flip??{};let m=e.w,u=e.h;const d=r?-1:1,h=i?-1:1;a.clearRect(0,0,m,u),a.translate(m/2-m*d/2,u/2-u*h/2),a.scale(d,h),a.drawImage(l,0,0,m,u),a.setTransform(1,0,0,1,0,0)};return(i,r)=>(C(),A("canvas",{ref_key:"canvas",ref:o},null,512))}}),Sa=Object.freeze(Object.defineProperty({__proto__:null,default:Ma},Symbol.toStringTag,{value:"Module"})),Ca={class:"text-wrap"},ka=D({__name:"index",props:{modelValue:{default:""},defaultModelValue:{default:""},data:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""},fontSize:{default:""},borderColor:{default:""},w:{},h:{}},setup(t){return ce(e=>({"46dd5ff7":e.color,"7f931c9c":e.bgColor,c746d0b6:e.padding,a4c36304:e.radius,"522c9048":e.fontSize,"27fc0faa":e.borderColor})),(e,o)=>(C(),A("div",Ca,ie(e.modelValue||e.defaultModelValue),1))}}),Ra=Se(ka,[["__scopeId","data-v-8233b39d"]]),Aa=Object.freeze(Object.defineProperty({__proto__:null,default:Ra},Symbol.toStringTag,{value:"Module"})),za=["contenteditable"],Ta=D({__name:"index",props:{modelValue:{default:""},defaultModelValue:{},data:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""},fontSize:{default:""},borderColor:{default:""},w:{},h:{},noWordWrap:{type:Boolean,default:!1},overEllipsis:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},hasModelValue:{type:Boolean}},emits:["update:modelValue","update:defaultModelValue","click"],setup(t,{emit:e}){const o=t;ce(r=>({"00cd0a69":r.color,"863570b8":r.bgColor,cde924d2:r.padding,"31a3f24c":r.radius,"7015a02a":r.fontSize,aedef5c6:r.borderColor,ba981f16:r.noWordWrap?"nowrap":"","58ddca96":r.overEllipsis?"hidden":"auto","6b9be9da":r.overEllipsis?"ellipsis":"unset"}));let a=L(!1),n=L();const l=async()=>{o.disabled||(a.value=!0,c(n.value),await Re(),n.value.focus())},c=r=>{const m=window.getSelection(),u=document.createRange();u.selectNodeContents(r),m.removeAllRanges(),m.addRange(u)},s=()=>{a.value=!1},i=r=>{o.hasModelValue&&e("update:modelValue",r.target.innerText),e("update:defaultModelValue",r.target.innerText)};return(r,m)=>(C(),A("div",{contenteditable:g(a),onBlur:s,onInput:i,ref_key:"text",ref:n,class:de({"text-wrap":!0,"can-edit":g(a)}),onDblclick:l},ie(r.modelValue||r.defaultModelValue),43,za))}}),La=Se(Ta,[["__scopeId","data-v-b9e7c0b0"]]),Ha=Object.freeze(Object.defineProperty({__proto__:null,default:La},Symbol.toStringTag,{value:"Module"})),Ea=["innerHTML"],Ua=D({__name:"index",props:{url:{},color:{default:""},bgColor:{default:""},fillColor:{default:""},padding:{default:""},radius:{default:""},fontSize:{default:""},iconUseSelfColor:{type:Boolean}},setup(t){return ce(e=>({"46bf371c":e.color,"5a1a592f":e.fillColor,"1d6b7926":e.bgColor,"651f2d40":e.padding,"5f884d3a":e.radius,"6f5fc4fe":e.fontSize})),(e,o)=>(C(),A("div",{class:de({"icon-wrap":!0,"color-self":e.iconUseSelfColor}),innerHTML:e.url},null,10,Ea))}}),Oa=Se(Ua,[["__scopeId","data-v-6b52c610"]]),Ba=Object.freeze(Object.defineProperty({__proto__:null,default:Oa},Symbol.toStringTag,{value:"Module"})),Da={class:"img-scale-wrap"},Pa=["src"],Ia=D({__name:"index",props:{url:{},w:{},h:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""},lockAspectRatio:{type:Boolean,default:!1},position:{default:"left"},imgWidth:{},imgHeight:{}},setup(t){const e=t;ce(n=>({ef6c025e:n.color,"58f6c20c":n.bgColor,"351ce7ff":n.padding,cc74ea38:n.radius}));let o=F(()=>({[e.position]:0,width:e.imgWidth,height:e.imgHeight})),a=F(()=>({[e.position]:0,width:e.lockAspectRatio?e.w+"px":void 0,height:e.lockAspectRatio?e.h+"px":void 0}));return(n,l)=>(C(),A("div",Da,[I("div",{class:"img-scale-reduce",style:Q(g(o))},[I("img",{class:"img-scale",src:n.url,alt:"",style:Q(g(a))},null,12,Pa)],4)]))}}),$a=Se(Ia,[["__scopeId","data-v-321d426b"]]),Wa=Object.freeze(Object.defineProperty({__proto__:null,default:$a},Symbol.toStringTag,{value:"Module"}));let Na=Object.assign({"./Group/index.vue":ya,"./Image/index.vue":Va,"./Picture/index.vue":Sa,"./Shape/index.vue":Aa,"./Text/index.vue":Ha,"./icon-svg/index.vue":Ba,"./img-scale/index.vue":Wa,"./preview/index.vue":ha});const Nt=t=>Na[`./${t}/index.vue`];He(),He(),He(),He(),He();const ja=D({name:"dragPannelPreview"}),Fa=D({...ja,props:{pannel:{},modelValue:{default:()=>({})},disabled:{type:Boolean,default:!1},parentWidth:{default:0}},emits:["click"],setup(t,{emit:e}){const o=t;let a=L(),n=L({});ge(()=>{c()});const l=u=>({width:u.w==="auto"?u.w:u.w+"px",height:u.h==="auto"?u.h:u.h+"px",fontSize:o.pannel.fontSize||u.fontSize,zIndex:u.z||"auto",transform:`translate(${u.x||0}px, ${u.y||0}px) rotate(${u.r||0}deg)`}),c=async()=>{await Re();let u={transformOrigin:"0% 0%",width:o.pannel.width+"px",height:o.pannel.height+"px",color:o.pannel.color,fontSize:o.pannel.fontSize,backgroundColor:o.pannel.bgColor},d=a.value.getBoundingClientRect(),{endRate:h,translateX:f,translateY:y}=s(d.width,d.height);n.value={...u,transform:`translate(${f}px, ${y}px) scale(${h})`}},s=(u,d)=>{let h=u/o.pannel.width,f=d/o.pannel.height,y=h>f?f:h,_=h<=f?0:u*y,k=f<=h?0:d*y;return{endRate:y,translateX:_>0?u/2-o.pannel.width/2*y:_,translateY:k>0?d/2-o.pannel.height/2*y:k}},i=u=>Nt(u).default,r=u=>{u.self.click&&(console.log("click"),e("click",u))},m=u=>Wt(u,o.modelValue);return(u,d)=>(C(),A("div",{ref_key:"wrapRef",ref:a,class:"drag-editor-preivew-wrap"},[I("div",{class:de({"drag-editor-preivew":!0}),style:Q(g(n))},[(C(!0),A(Y,null,ae(u.pannel.components,h=>(C(),A("div",{class:"preview-item-wrap",style:Q(l(h))},[(C(),j(Ie(i(h.self.name)),be({data:h,h:h.h,w:h.w},m(h),{onClickCapture:Me(f=>r(h),["self"]),modelValue:u.modelValue[h.self.modelValue],"onUpdate:modelValue":f=>u.modelValue[h.self.modelValue]=f,defaultModelValue:h.self.defaultModelValue,"onUpdate:defaultModelValue":f=>h.self.defaultModelValue=f,groupModel:u.modelValue,disabled:!0}),null,16,["data","h","w","onClickCapture","modelValue","onUpdate:modelValue","defaultModelValue","onUpdate:defaultModelValue","groupModel"]))],4))),256))],4)],512))}}),Be=Se(Fa,[["__scopeId","data-v-b2568ace"]]);Be.install=t=>{t.component(Be.name,Be)};let jt={snap:!0,snapTolerance:5,parent:!0,debug:!1,rotatable:!0,r:0,active:!1,preventDeactivation:!1,resizable:!0,lockAspectRatio:!0},De=L(1);L(500);L(1200);function le(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>(t==="x"?Math.random()*16|0:"r&0x3"|"0x8").toString(16))}const st=(t,e)=>{let o=t.self,a=o.activeValue,n=o.prop,l=o.activeMode,c=o.activeMap;if(!n||!l||!c)return o;let s=!1;switch(l){case"大于":e[n]>a&&(s=!0);break;case"小于":e[n]<a&&(s=!0);break;case"等于":e[n]==a&&(s=!0);break;case"不等于":e[n]!=a&&(s=!0);break;case"大于等于":e[n]>=a&&(s=!0);break;case"小于等于":e[n]<a&&(s=!0);break;case"存在":e[n]!==void 0&&e[n]!==null&&(s=!0);break;case"不存在":e[n]===void 0&&e[n]===null&&(s=!0);break}let i={};return s&&(i=Xa(c,e)),{...o,...i}},Xa=(t,e)=>{let o={},a=/\$\{(.*?)\}/g;try{o=JSON.parse(t);for(var n in o){let l=o[n];if(a.test(l)){let c=l.replace(/[\$|{|}]/g,"");o[n]=(e==null?void 0:e[c])??void 0}}}catch(l){console.error("解析 activeMap 失败",l)}return o},Ya=t=>{let e,o,a,n;return t.forEach(l=>{l.x=parseFloat(l.x),l.y=parseFloat(l.y),l.h=parseFloat(l.h),l.w=parseFloat(l.w),(e===void 0||l.x<e)&&(e=l.x),(o===void 0||l.x+l.w>o)&&(o=l.x+l.w),(a===void 0||l.y<a)&&(a=l.y),(n===void 0||l.y+l.h>n)&&(n=l.y+l.h)}),{left:e,right:o,top:a,bottom:n}},rt=(t,e)=>{for(let o of Object.keys(t))t[o]=(e==null?void 0:e[o])??t[o]};function Ja(t,e){let o,a,n;const l=L(!0),c=()=>{l.value=!0,n()};Z(t,c,{flush:"sync"});const s=typeof e=="function"?e:e.get,i=typeof e=="function"?void 0:e.set,r=Dt((m,u)=>(a=m,n=u,{get(){return l.value&&(o=s(),l.value=!1),a(),o},set(d){i==null||i(d)}}));return Object.isExtensible(r)&&(r.trigger=c),r}function qe(t){return ta()?(aa(t),!0):!1}function te(t){return typeof t=="function"?t():g(t)}const Ae=typeof window<"u"&&typeof document<"u",Ga=Object.prototype.toString,Ft=t=>Ga.call(t)==="[object Object]",ke=()=>{},ot=Ka();function Ka(){var t;return Ae&&((t=window==null?void 0:window.navigator)==null?void 0:t.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent)}const yt={mounted:"mounted",updated:"updated",unmounted:"unmounted"};function qa(...t){if(t.length!==1)return ea(...t);const e=t[0];return typeof e=="function"?Pt(Dt(()=>({get:e,set:ke}))):L(e)}function Qa(t,e,o={}){const{immediate:a=!0}=o,n=L(!1);let l=null;function c(){l&&(clearTimeout(l),l=null)}function s(){n.value=!1,c()}function i(...r){c(),n.value=!0,l=setTimeout(()=>{n.value=!1,l=null,t(...r)},te(e))}return a&&(n.value=!0,Ae&&i()),qe(s),{isPending:Pt(n),start:i,stop:s}}function _t(t,e,o){return Z(t,(a,n,l)=>{a&&e(a,n,l)},o)}function Za(t){var e;const o=te(t);return(e=o==null?void 0:o.$el)!=null?e:o}const Qe=Ae?window:void 0,eo=Ae?window.navigator:void 0;function ne(...t){let e,o,a,n;if(typeof t[0]=="string"||Array.isArray(t[0])?([o,a,n]=t,e=Qe):[e,o,a,n]=t,!e)return ke;Array.isArray(o)||(o=[o]),Array.isArray(a)||(a=[a]);const l=[],c=()=>{l.forEach(m=>m()),l.length=0},s=(m,u,d,h)=>(m.addEventListener(u,d,h),()=>m.removeEventListener(u,d,h)),i=Z(()=>[Za(e),te(n)],([m,u])=>{if(c(),!m)return;const d=Ft(u)?{...u}:u;l.push(...o.flatMap(h=>a.map(f=>s(m,h,f,d))))},{immediate:!0,flush:"post"}),r=()=>{i(),c()};return qe(r),r}function to(t){return typeof t=="function"?t:typeof t=="string"?e=>e.key===t:Array.isArray(t)?e=>t.includes(e.key):()=>!0}function $e(...t){let e,o,a={};t.length===3?(e=t[0],o=t[1],a=t[2]):t.length===2?typeof t[1]=="object"?(e=!0,o=t[0],a=t[1]):(e=t[0],o=t[1]):(e=!0,o=t[0]);const{target:n=Qe,eventName:l="keydown",passive:c=!1,dedupe:s=!1}=a,i=to(e);return ne(n,l,m=>{m.repeat&&te(s)||i(m)&&o(m)},c)}function ao(t={}){var e;const{window:o=Qe,deep:a=!0}=t,n=(e=t.document)!=null?e:o==null?void 0:o.document,l=()=>{var s;let i=n==null?void 0:n.activeElement;if(a)for(;i!=null&&i.shadowRoot;)i=(s=i==null?void 0:i.shadowRoot)==null?void 0:s.activeElement;return i},c=Ja(()=>null,()=>l());return o&&(ne(o,"blur",s=>{s.relatedTarget===null&&c.trigger()},!0),ne(o,"focus",c.trigger,!0)),c}function oo(){const t=L(!1);return oa()&&ge(()=>{t.value=!0}),t}function lo(t){const e=oo();return F(()=>(e.value,!!t()))}function no(t={}){const{navigator:e=eo,read:o=!1,source:a,copiedDuring:n=1500,legacy:l=!1}=t,c=lo(()=>e&&"clipboard"in e),s=F(()=>c.value||l),i=L(""),r=L(!1),m=Qa(()=>r.value=!1,n);function u(){c.value?e.clipboard.readText().then(y=>{i.value=y}):i.value=f()}s.value&&o&&ne(["copy","cut"],u);async function d(y=te(a)){s.value&&y!=null&&(c.value?await e.clipboard.writeText(y):h(y),i.value=y,r.value=!0,m.start())}function h(y){const _=document.createElement("textarea");_.value=y??"",_.style.position="absolute",_.style.opacity="0",document.body.appendChild(_),_.select(),document.execCommand("copy"),_.remove()}function f(){var y,_,k;return(k=(_=(y=document==null?void 0:document.getSelection)==null?void 0:y.call(document))==null?void 0:_.toString())!=null?k:""}return{isSupported:s,text:i,copied:r,copy:d}}function io(t,e={}){const o=L(!1),a=It(null);let n=0;if(Ae){const l=typeof e=="function"?{onDrop:e}:e,c=s=>{var i,r;const m=Array.from((r=(i=s.dataTransfer)==null?void 0:i.files)!=null?r:[]);return a.value=m.length===0?null:m};ne(t,"dragenter",s=>{var i;s.preventDefault(),n+=1,o.value=!0,(i=l.onEnter)==null||i.call(l,c(s),s)}),ne(t,"dragover",s=>{var i;s.preventDefault(),(i=l.onOver)==null||i.call(l,c(s),s)}),ne(t,"dragleave",s=>{var i;s.preventDefault(),n-=1,n===0&&(o.value=!1),(i=l.onLeave)==null||i.call(l,c(s),s)}),ne(t,"drop",s=>{var i;s.preventDefault(),n=0,o.value=!1,(i=l.onDrop)==null||i.call(l,c(s),s)})}return{files:a,isOverDropZone:o}}const so={ctrl:"control",command:"meta",cmd:"meta",option:"alt",up:"arrowup",down:"arrowdown",left:"arrowleft",right:"arrowright"};function ro(t={}){const{reactive:e=!1,target:o=Qe,aliasMap:a=so,passive:n=!0,onEventFired:l=ke}=t,c=ue(new Set),s={toJSON(){return{}},current:c},i=e?ue(s):s,r=new Set,m=new Set;function u(y,_){y in i&&(e?i[y]=_:i[y].value=_)}function d(){c.clear();for(const y of m)u(y,!1)}function h(y,_){var k,E;const S=(k=y.key)==null?void 0:k.toLowerCase(),x=[(E=y.code)==null?void 0:E.toLowerCase(),S].filter(Boolean);S&&(_?c.add(S):c.delete(S));for(const M of x)m.add(M),u(M,_);S==="meta"&&!_?(r.forEach(M=>{c.delete(M),u(M,!1)}),r.clear()):typeof y.getModifierState=="function"&&y.getModifierState("Meta")&&_&&[...c,...x].forEach(M=>r.add(M))}ne(o,"keydown",y=>(h(y,!0),l(y)),{passive:n}),ne(o,"keyup",y=>(h(y,!1),l(y)),{passive:n}),ne("blur",d,{passive:!0}),ne("focus",d,{passive:!0});const f=new Proxy(i,{get(y,_,k){if(typeof _!="string")return Reflect.get(y,_,k);if(_=_.toLowerCase(),_ in a&&(_=a[_]),!(_ in i))if(/[+_-]/.test(_)){const S=_.split(/[+_-]/g).map(b=>b.trim());i[_]=F(()=>S.every(b=>te(f[b])))}else i[_]=L(!1);const E=Reflect.get(y,_,k);return e?te(E):E}});return f}/*!
 * Compressor.js v1.2.1
 * https://fengyuanchen.github.io/compressorjs
 *
 * Copyright 2018-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2023-02-28T14:09:41.732Z
 */function wt(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),o.push.apply(o,a)}return o}function We(t){for(var e=1;e<arguments.length;e++){var o=arguments[e]!=null?arguments[e]:{};e%2?wt(Object(o),!0).forEach(function(a){fo(t,a,o[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):wt(Object(o)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(o,a))})}return t}function uo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xt(t,e){for(var o=0;o<e.length;o++){var a=e[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,Xt(a.key),a)}}function co(t,e,o){return e&&xt(t.prototype,e),o&&xt(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function fo(t,e,o){return e=Xt(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Je(){return Je=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(t[a]=o[a])}return t},Je.apply(this,arguments)}function ho(t,e){if(typeof t!="object"||t===null)return t;var o=t[Symbol.toPrimitive];if(o!==void 0){var a=o.call(t,e||"default");if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xt(t){var e=ho(t,"string");return typeof e=="symbol"?e:String(e)}var Yt={exports:{}};(function(t){typeof window>"u"||function(e){var o=e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype,a=e.Blob&&function(){try{return!!new Blob}catch{return!1}}(),n=a&&e.Uint8Array&&function(){try{return new Blob([new Uint8Array(100)]).size===100}catch{return!1}}(),l=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,c=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,s=(a||l)&&e.atob&&e.ArrayBuffer&&e.Uint8Array&&function(i){var r,m,u,d,h,f,y,_,k;if(r=i.match(c),!r)throw new Error("invalid data URI");for(m=r[2]?r[1]:"text/plain"+(r[3]||";charset=US-ASCII"),u=!!r[4],d=i.slice(r[0].length),u?h=atob(d):h=decodeURIComponent(d),f=new ArrayBuffer(h.length),y=new Uint8Array(f),_=0;_<h.length;_+=1)y[_]=h.charCodeAt(_);return a?new Blob([n?y:f],{type:m}):(k=new l,k.append(f),k.getBlob(m))};e.HTMLCanvasElement&&!o.toBlob&&(o.mozGetAsFile?o.toBlob=function(i,r,m){var u=this;setTimeout(function(){m&&o.toDataURL&&s?i(s(u.toDataURL(r,m))):i(u.mozGetAsFile("blob",r))})}:o.toDataURL&&s&&(o.msToBlob?o.toBlob=function(i,r,m){var u=this;setTimeout(function(){(r&&r!=="image/png"||m)&&o.toDataURL&&s?i(s(u.toDataURL(r,m))):i(u.msToBlob(r))})}:o.toBlob=function(i,r,m){var u=this;setTimeout(function(){i(s(u.toDataURL(r,m)))})})),t.exports?t.exports=s:e.dataURLtoBlob=s}(window)})(Yt);var Vt=Yt.exports,po=function(e){return typeof Blob>"u"?!1:e instanceof Blob||Object.prototype.toString.call(e)==="[object Blob]"},Mt={strict:!0,checkOrientation:!0,retainExif:!1,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},mo=typeof window<"u"&&typeof window.document<"u",ye=mo?window:{},Ge=function(e){return e>0&&e<1/0},go=Array.prototype.slice;function dt(t){return Array.from?Array.from(t):go.call(t)}var vo=/^image\/.+$/;function lt(t){return vo.test(t)}function bo(t){var e=lt(t)?t.substr(6):"";return e==="jpeg"&&(e="jpg"),".".concat(e)}var Jt=String.fromCharCode;function yo(t,e,o){var a="",n;for(o+=e,n=e;n<o;n+=1)a+=Jt(t.getUint8(n));return a}var _o=ye.btoa;function St(t,e){for(var o=[],a=8192,n=new Uint8Array(t);n.length>0;)o.push(Jt.apply(null,dt(n.subarray(0,a)))),n=n.subarray(a);return"data:".concat(e,";base64,").concat(_o(o.join("")))}function wo(t){var e=new DataView(t),o;try{var a,n,l;if(e.getUint8(0)===255&&e.getUint8(1)===216)for(var c=e.byteLength,s=2;s+1<c;){if(e.getUint8(s)===255&&e.getUint8(s+1)===225){n=s;break}s+=1}if(n){var i=n+4,r=n+10;if(yo(e,i,4)==="Exif"){var m=e.getUint16(r);if(a=m===18761,(a||m===19789)&&e.getUint16(r+2,a)===42){var u=e.getUint32(r+4,a);u>=8&&(l=r+u)}}}if(l){var d=e.getUint16(l,a),h,f;for(f=0;f<d;f+=1)if(h=l+f*12+2,e.getUint16(h,a)===274){h+=8,o=e.getUint16(h,a),e.setUint16(h,1,a);break}}}catch{o=1}return o}function xo(t){var e=0,o=1,a=1;switch(t){case 2:o=-1;break;case 3:e=-180;break;case 4:a=-1;break;case 5:e=90,a=-1;break;case 6:e=90;break;case 7:e=90,o=-1;break;case 8:e=-90;break}return{rotate:e,scaleX:o,scaleY:a}}var Vo=/\.\d*(?:0|9){12}\d*$/;function Ct(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return Vo.test(t)?Math.round(t*e)/e:t}function Ee(t){var e=t.aspectRatio,o=t.height,a=t.width,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"none",l=Ge(a),c=Ge(o);if(l&&c){var s=o*e;(n==="contain"||n==="none")&&s>a||n==="cover"&&s<a?o=a/e:a=o*e}else l?o=a/e:c&&(a=o*e);return{width:a,height:o}}function Mo(t){for(var e=dt(new Uint8Array(t)),o=e.length,a=[],n=0;n+3<o;){var l=e[n],c=e[n+1];if(l===255&&c===218)break;if(l===255&&c===216)n+=2;else{var s=e[n+2]*256+e[n+3],i=n+s+2,r=e.slice(n,i);a.push(r),n=i}}return a.reduce(function(m,u){return u[0]===255&&u[1]===225?m.concat(u):m},[])}function So(t,e){var o=dt(new Uint8Array(t));if(o[2]!==255||o[3]!==224)return t;var a=o[4]*256+o[5],n=[255,216].concat(e,o.slice(4+a));return new Uint8Array(n)}var Co=ye.ArrayBuffer,tt=ye.FileReader,xe=ye.URL||ye.webkitURL,ko=/\.\w+$/,Ro=ye.Compressor,Ao=function(){function t(e,o){uo(this,t),this.file=e,this.exif=[],this.image=new Image,this.options=We(We({},Mt),o),this.aborted=!1,this.result=null,this.init()}return co(t,[{key:"init",value:function(){var o=this,a=this.file,n=this.options;if(!po(a)){this.fail(new Error("The first argument must be a File or Blob object."));return}var l=a.type;if(!lt(l)){this.fail(new Error("The first argument must be an image File or Blob object."));return}if(!xe||!tt){this.fail(new Error("The current browser does not support image compression."));return}Co||(n.checkOrientation=!1,n.retainExif=!1);var c=l==="image/jpeg",s=c&&n.checkOrientation,i=c&&n.retainExif;if(xe&&!s&&!i)this.load({url:xe.createObjectURL(a)});else{var r=new tt;this.reader=r,r.onload=function(m){var u=m.target,d=u.result,h={},f=1;s&&(f=wo(d),f>1&&Je(h,xo(f))),i&&(o.exif=Mo(d)),s||i?!xe||f>1?h.url=St(d,l):h.url=xe.createObjectURL(a):h.url=d,o.load(h)},r.onabort=function(){o.fail(new Error("Aborted to read the image with FileReader."))},r.onerror=function(){o.fail(new Error("Failed to read the image with FileReader."))},r.onloadend=function(){o.reader=null},s||i?r.readAsArrayBuffer(a):r.readAsDataURL(a)}}},{key:"load",value:function(o){var a=this,n=this.file,l=this.image;l.onload=function(){a.draw(We(We({},o),{},{naturalWidth:l.naturalWidth,naturalHeight:l.naturalHeight}))},l.onabort=function(){a.fail(new Error("Aborted to load the image."))},l.onerror=function(){a.fail(new Error("Failed to load the image."))},ye.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(ye.navigator.userAgent)&&(l.crossOrigin="anonymous"),l.alt=n.name,l.src=o.url}},{key:"draw",value:function(o){var a=this,n=o.naturalWidth,l=o.naturalHeight,c=o.rotate,s=c===void 0?0:c,i=o.scaleX,r=i===void 0?1:i,m=o.scaleY,u=m===void 0?1:m,d=this.file,h=this.image,f=this.options,y=document.createElement("canvas"),_=y.getContext("2d"),k=Math.abs(s)%180===90,E=(f.resize==="contain"||f.resize==="cover")&&Ge(f.width)&&Ge(f.height),S=Math.max(f.maxWidth,0)||1/0,b=Math.max(f.maxHeight,0)||1/0,x=Math.max(f.minWidth,0)||0,M=Math.max(f.minHeight,0)||0,p=n/l,R=f.width,O=f.height;if(k){var P=[b,S];S=P[0],b=P[1];var U=[M,x];x=U[0],M=U[1];var X=[O,R];R=X[0],O=X[1]}E&&(p=R/O);var fe=Ee({aspectRatio:p,width:S,height:b},"contain");S=fe.width,b=fe.height;var _e=Ee({aspectRatio:p,width:x,height:M},"cover");if(x=_e.width,M=_e.height,E){var we=Ee({aspectRatio:p,width:R,height:O},f.resize);R=we.width,O=we.height}else{var re=Ee({aspectRatio:p,width:R,height:O}),ee=re.width;R=ee===void 0?n:ee;var se=re.height;O=se===void 0?l:se}R=Math.floor(Ct(Math.min(Math.max(R,x),S))),O=Math.floor(Ct(Math.min(Math.max(O,M),b)));var V=-R/2,T=-O/2,W=R,z=O,H=[];if(E){var G=0,oe=0,N=n,Ze=l,ft=Ee({aspectRatio:p,width:n,height:l},{contain:"cover",cover:"contain"}[f.resize]);N=ft.width,Ze=ft.height,G=(n-N)/2,oe=(l-Ze)/2,H.push(G,oe,N,Ze)}if(H.push(V,T,W,z),k){var ht=[O,R];R=ht[0],O=ht[1]}y.width=R,y.height=O,lt(f.mimeType)||(f.mimeType=d.type);var pt="transparent";d.size>f.convertSize&&f.convertTypes.indexOf(f.mimeType)>=0&&(f.mimeType="image/jpeg");var mt=f.mimeType==="image/jpeg";if(mt&&(pt="#fff"),_.fillStyle=pt,_.fillRect(0,0,R,O),f.beforeDraw&&f.beforeDraw.call(this,_,y),!this.aborted&&(_.save(),_.translate(R/2,O/2),_.rotate(s*Math.PI/180),_.scale(r,u),_.drawImage.apply(_,[h].concat(H)),_.restore(),f.drew&&f.drew.call(this,_,y),!this.aborted)){var gt=function(Te){if(!a.aborted){var vt=function(Le){return a.done({naturalWidth:n,naturalHeight:l,result:Le})};if(Te&&mt&&f.retainExif&&a.exif&&a.exif.length>0){var bt=function(Le){return vt(Vt(St(So(Le,a.exif),f.mimeType)))};if(Te.arrayBuffer)Te.arrayBuffer().then(bt).catch(function(){a.fail(new Error("Failed to read the compressed image with Blob.arrayBuffer()."))});else{var Ce=new tt;a.reader=Ce,Ce.onload=function(et){var Le=et.target;bt(Le.result)},Ce.onabort=function(){a.fail(new Error("Aborted to read the compressed image with FileReader."))},Ce.onerror=function(){a.fail(new Error("Failed to read the compressed image with FileReader."))},Ce.onloadend=function(){a.reader=null},Ce.readAsArrayBuffer(Te)}}else vt(Te)}};y.toBlob?y.toBlob(gt,f.mimeType,f.quality):gt(Vt(y.toDataURL(f.mimeType,f.quality)))}}},{key:"done",value:function(o){var a=o.naturalWidth,n=o.naturalHeight,l=o.result,c=this.file,s=this.image,i=this.options;if(xe&&s.src.indexOf("blob:")===0&&xe.revokeObjectURL(s.src),l)if(i.strict&&!i.retainExif&&l.size>c.size&&i.mimeType===c.type&&!(i.width>a||i.height>n||i.minWidth>a||i.minHeight>n||i.maxWidth<a||i.maxHeight<n))l=c;else{var r=new Date;l.lastModified=r.getTime(),l.lastModifiedDate=r,l.name=c.name,l.name&&l.type!==c.type&&(l.name=l.name.replace(ko,bo(l.type)))}else l=c;this.result=l,i.success&&i.success.call(this,l)}},{key:"fail",value:function(o){var a=this.options;if(a.error)a.error.call(this,o);else throw o}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=Ro,t}},{key:"setDefaults",value:function(o){Je(Mt,o)}}]),t}();const zo={class:"img-wrap"},To=["src"],Lo=D({__name:"upload-img",props:{accept:{default:"*"}},emits:["change"],setup(t,{emit:e}){const o=t;let a=L(!1),n=L(),l="",c=It(""),s=ue({quality:.8,width:void 0,height:void 0,url:""});const i=async()=>{a.value=!0,await Re()},r=L();io(r,_=>{let k=(_==null?void 0:_[0])??"";k&&d(k)});const u=()=>{l&&d(l)},d=_=>{let k=o.accept,E=_.name,S=E.substring(E.lastIndexOf(".")).toLowerCase();if(k!="*"&&!(o.accept.split(",").indexOf(S)>-1)){Pe.error("文件格式有误");return}l=_,new Ao(_,{quality:s.quality,width:s.width||void 0,height:s.height||void 0,success(b){c.value=b;let x=new FileReader;x.onload=()=>{s.url=x.result,x=null},x.readAsDataURL(b)},error(){Pe.error("压缩图片失败")}})},h=()=>{a.value=!1},f=()=>{c.value&&(e("change",{url:s.url,file:c.value}),h())},y=()=>{n.value.resetFields(),s.url="",l=null,c.value=null};return(_,k)=>{const E=B("el-input-number"),S=B("el-form-item"),b=B("el-button"),x=B("el-form"),M=B("el-dialog");return C(),j(b,be({onClick:i},_.$attrs),{default:w(()=>[Ye(_.$slots,"default",{},()=>[$("上传图片")],!0),v(M,{"append-to-body":"","destroy-on-close":"",width:"1200px",modelValue:g(a),"onUpdate:modelValue":k[3]||(k[3]=p=>ve(a)?a.value=p:a=p),onClose:y},{footer:w(()=>[v(b,{onClick:h},{default:w(()=>[$("关闭")]),_:1}),v(b,{type:"primary",onClick:f},{default:w(()=>[$("确认")]),_:1})]),default:w(()=>[I("div",{class:"drap-wrap",ref_key:"dropZoneRef",ref:r},[v(je,{accept:_.accept,onChange:d},{default:w(()=>[$("拖拽或点击选择图片")]),_:1},8,["accept"])],512),v(x,{ref_key:"formRef",ref:n,style:{"margin-top":"20px"},model:g(s),inline:""},{default:w(()=>[v(S,{label:"质量"},{default:w(()=>[v(E,{modelValue:g(s).quality,"onUpdate:modelValue":k[0]||(k[0]=p=>g(s).quality=p),step:.1,max:1,min:.1},null,8,["modelValue"])]),_:1}),v(S,{label:"宽度",prop:"width"},{default:w(()=>[v(E,{modelValue:g(s).width,"onUpdate:modelValue":k[1]||(k[1]=p=>g(s).width=p)},null,8,["modelValue"])]),_:1}),v(S,{label:"高度",prop:"height"},{default:w(()=>[v(E,{modelValue:g(s).height,"onUpdate:modelValue":k[2]||(k[2]=p=>g(s).height=p)},null,8,["modelValue"])]),_:1}),v(S,null,{default:w(()=>{var p;return[v(b,{type:"primary",onClick:u},{default:w(()=>[$("重新处理")]),_:1}),$(" "+ie(((p=g(c))==null?void 0:p.size)/1e3||0)+"KB ",1)]}),_:1})]),_:1},8,["model"]),I("div",zo,[I("img",{class:"img",src:g(s).url,alt:""},null,8,To)])]),_:1},8,["modelValue"])]),_:3},16)}}});const J=(t,e)=>{const o=t.__vccOpts||t;for(const[a,n]of e)o[a]=n;return o},Ho=J(Lo,[["__scopeId","data-v-84c5a84a"]]);let Gt="pannel-json";const Eo=t=>{try{sessionStorage[Gt]=JSON.stringify(t)}catch{}},Uo=()=>{let t={};try{t=JSON.parse(sessionStorage[Gt]||"{}")}catch{}return t},Oo=D({__name:"history",setup(t){let e=Ke("pannel",ue({components:[]})),o=L([]);ge(()=>{n()}),$t(()=>{o.value=null,a.value=null});let a=L("");const n=()=>{a.value=Z(()=>e,i=>{l(i)},{deep:!0,flush:"post",immediate:!0})},l=ra(i=>{try{o.value.unshift(JSON.parse(JSON.stringify(i)))}catch{}},1e3),c=i=>{var r;(r=a.value)==null||r.call(a),a.value=null,rt(e,i)},s=()=>{var i;a.value?((i=a.value)==null||i.call(a),a.value=null):n()};return(i,r)=>{const m=B("el-icon"),u=B("el-button"),d=B("el-dropdown-item"),h=B("el-dropdown-menu"),f=B("el-dropdown");return C(),A(Y,null,[v(f,{style:{margin:"0 10px"},"hide-on-click":!1,"max-height":"300"},{dropdown:w(()=>[v(h,null,{default:w(()=>[(C(!0),A(Y,null,ae(g(o),(y,_)=>(C(),j(d,{onClick:Me(k=>c(y),["self"])},{default:w(()=>[$("序号 "+ie(g(o).length-_),1)]),_:2},1032,["onClick"]))),256))]),_:1})]),default:w(()=>[v(u,{type:"primary",plain:""},{default:w(()=>[$(" 历史"),v(m,{class:"el-icon--right"},{default:w(()=>[v(g(da))]),_:1})]),_:1})]),_:1}),v(u,{onClick:r[0]||(r[0]=y=>s()),plain:"",type:"primary"},{default:w(()=>[$(ie(g(a)?"自动保存中":"已暂停保存"),1)]),_:1})],64)}}}),Bo={class:"toolbar-wrap"},Do={class:"label"},Po={class:"preview-wrap"},Io={class:"preview-wrap-json"},$o=D({__name:"index",setup(t){let e=Ke("pannel",ue({components:[]})),o=ue({name1:"哈哈",state:1});setInterval(()=>{o.state=o.state==1?2:1,o.rate=o.rate=="40%"?"100%":"40%"},1e3);let a=F(()=>e.components.filter(S=>S.active)),n=L(!1);const l=()=>{n.value=!0,Eo(e),setTimeout(()=>{n.value=!1},500)},c=({url:S})=>{let b=new Image;b.src=S,b.onload=()=>{e.components.push({w:b.width,h:b.height,self:{id:le(),name:"Image",desc:"图片",url:S}})}},s=S=>{const b=new FileReader;b.onload=()=>{const x=b.result;let M=new Image;M.src=x,M.onload=()=>{e.components.push({w:M.width,h:M.height,self:{id:le(),name:"Image",desc:"图片",url:x}})}},b.readAsDataURL(S)},i=S=>{let b=new FileReader,x=new FileReader;b.onload=()=>{const M=b.result;let p=new Image;p.src=M,p.onload=()=>{let R=p.width,O=p.height;x.onload=()=>{e.components.push({w:R,h:O,self:{id:le(),name:"icon-svg",desc:"缩放图片",url:x.result}}),x.abort(),b.abort(),b=null,x=null},x.readAsText(S)}},b.readAsDataURL(S)};let r=L(!1);const m=()=>{r.value=!0};let u=L(!1);const d=()=>{u.value=!0},h=S=>{const b=new FileReader;b.onload=()=>{const x=b.result;let M=new Image;M.src=x,M.onload=()=>{e.components.push({w:M.width,h:M.height,self:{id:le(),name:"img-scale",url:x}})}},b.readAsDataURL(S)},f=async()=>{let S=a.value||[],b=[];S.forEach(X=>{X.self.name=="Group"?b.push(..._(X)):b.push(X)});let{left:x,right:M,top:p,bottom:R}=Ya(b),O=b.map(X=>({...X,active:!1,preventDeactivation:!1,x:X.x-x,y:X.y-p})),P=e.components.filter(X=>a.value.every(fe=>X!==fe)),U={x,y:p,w:M-x,h:R-p,lockAspectRatio:!1,self:{id:le(),desc:"组合",name:"Group"},group:O};P.push(U),await Re(),e.components=P},y=()=>{var M;let S=((M=a.value)==null?void 0:M[0])??{},b=_(S),x=e.components.filter(p=>S!==p);x.push(...b),e.components=x},_=S=>{let b=(S==null?void 0:S.group)??[],x=S.x,M=S.y;return b.map(p=>({...p,x:x+p.x,y:M+p.y}))};let k=L();const E=()=>{let S=k.value.innerText;try{let b=JSON.parse(S);rt(e,b),u.value=!1}catch{Pe.error("解析数据失败")}};return(S,b)=>{var R,O,P;const x=B("el-button"),M=B("el-input-number"),p=B("el-dialog");return C(),A(Y,null,[I("div",Bo,[v(Ho,{accept:".png,.gif,.jpg,.jpeg",type:"primary",plain:"",onChange:c},{default:w(()=>[$("上传图片并压缩")]),_:1}),v(je,{accept:".png,.gif,.jpg,.jpeg",onChange:s},{default:w(()=>[$("上传图片")]),_:1}),v(je,{accept:".svg",onChange:i},{default:w(()=>[$("上传svg")]),_:1}),v(je,{accept:".png,.gif,.jpg,.jpeg",onChange:h},{default:w(()=>[$("上传缩放图片")]),_:1}),v(x,{type:"primary",plain:"",onClick:m},{default:w(()=>[$("预览")]),_:1}),v(x,{type:"primary",plain:"",onClick:d},{default:w(()=>[$("json")]),_:1}),v(x,{type:"primary",disabled:g(a).length<=1,plain:"",onClick:f},{default:w(()=>[$(" 组合")]),_:1},8,["disabled"]),v(x,{type:"primary",disabled:g(a).length!=1||((P=(O=(R=g(a))==null?void 0:R[0])==null?void 0:O.self)==null?void 0:P.name)!="Group",plain:"",onClick:b[0]||(b[0]=U=>y())},{default:w(()=>[$(" 拆分")]),_:1},8,["disabled"]),v(x,{style:{width:"100px"},loading:g(n),type:"primary",plain:"",onClick:b[1]||(b[1]=U=>l())},{default:w(()=>[$("临时缓存 ")]),_:1},8,["loading"]),v(Oo),I("div",Do,[$(" 缩放 "),v(M,{size:"small",step:.1,modelValue:g(De),"onUpdate:modelValue":b[2]||(b[2]=U=>ve(De)?De.value=U:null)},null,8,["modelValue"])])]),v(p,{"align-center":"","append-to-body":"",width:"1040px",title:"预览","destroy-on-close":"",modelValue:g(r),"onUpdate:modelValue":b[4]||(b[4]=U=>ve(r)?r.value=U:r=U)},{default:w(()=>[I("div",Po,[g(r)?(C(),j(g(Be),{key:0,pannel:g(e),modelValue:g(o),"onUpdate:modelValue":b[3]||(b[3]=U=>ve(o)?o.value=U:o=U)},null,8,["pannel","modelValue"])):me("",!0)])]),_:1},8,["modelValue"]),v(p,{"align-center":"","append-to-body":"",width:"1200px",title:"预览JSON",modelValue:g(u),"onUpdate:modelValue":b[5]||(b[5]=U=>ve(u)?u.value=U:u=U)},{footer:w(()=>[v(x,{type:"primary",onClick:E},{default:w(()=>[$("确认")]),_:1})]),default:w(()=>[I("div",Io,[I("pre",{ref_key:"currentPannel",ref:k,style:{"min-height":"200px"},contenteditable:""},ie(g(e)),513)])]),_:1},8,["modelValue"])],64)}}});const Wo=J($o,[["__scopeId","data-v-c54ac859"]]),No=D({__name:"index",setup(t,{expose:e}){let o=L([]),a=L([]);return e({init:l=>{o.value=l.vLine,a.value=l.hLine}}),(l,c)=>(C(),A(Y,null,[(C(!0),A(Y,null,ae(g(o),(s,i)=>it((C(),A("span",{class:"ref-line v-line",key:"v_"+i,style:Q({left:s.position,top:s.origin,height:s.lineLength})},null,4)),[[Bt,s.display]])),128)),(C(!0),A(Y,null,ae(g(a),(s,i)=>(C(),A("span",{class:"ref-line h-line",key:"h_"+i,style:Q({top:s.position,left:s.origin,width:s.lineLength})},null,4))),128))],64))}});const jo=J(No,[["__scopeId","data-v-3b7aeeb1"]]),Fo={class:"group-wrap"},Xo=["a"],Yo=D({__name:"index",props:{data:{},modelValue:{default:()=>({})},groupModel:{default:()=>({})},disabled:{type:Boolean}},setup(t){const e=t,o=l=>ut(l).default,a=l=>({width:l.w=="auto"?l.w:l.w+"px",height:l.h=="auto"?l.h:l.h+"px",transform:`translate(${l.x}px, ${l.y}px) rotate(${l.r||0}deg)`}),n=l=>st(l,e.groupModel);return(l,c)=>(C(),A("div",Fo,[(C(!0),A(Y,null,ae(l.data.group,s=>(C(),A("div",{a:s.active,class:"group-item",style:Q(a(s))},[(C(),j(Ie(o(s.self.name)),be({data:s,h:s.h,w:s.w},n(s),{modelValue:l.groupModel[s.self.modelValue],"onUpdate:modelValue":i=>l.groupModel[s.self.modelValue]=i,defaultModelValue:s.self.defaultModelValue,"onUpdate:defaultModelValue":i=>s.self.defaultModelValue=i,disabled:!0}),null,16,["data","h","w","modelValue","onUpdate:modelValue","defaultModelValue","onUpdate:defaultModelValue"]))],12,Xo))),256))]))}});const Jo=J(Yo,[["__scopeId","data-v-a7d365c4"]]),Go=Object.freeze(Object.defineProperty({__proto__:null,default:Jo},Symbol.toStringTag,{value:"Module"})),Ko=["width","height","src"],qo=D({__name:"index",props:{url:{},w:{},h:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""}},setup(t){const e=t;ce(a=>({"35be3580":a.color,"7a3808fb":a.bgColor,"565e2eee":a.padding,ca4fabd6:a.radius})),Z(()=>[e.w,e.h],()=>o()),ge(()=>{o()});const o=()=>{};return(a,n)=>(C(),A("img",{class:"custom-image",width:a.w,height:a.h,src:a.url,alt:""},null,8,Ko))}});const Qo=J(qo,[["__scopeId","data-v-51bcdfe3"]]),Zo=Object.freeze(Object.defineProperty({__proto__:null,default:Qo},Symbol.toStringTag,{value:"Module"})),el=D({__name:"index",props:{url:{},w:{},h:{},flip:{}},setup(t){const e=t;let o=L(),a="",n=!0,l="";Z(()=>[e.w,e.h],()=>c()),Z(()=>{var i,r;return[(i=e.flip)==null?void 0:i.horizontal,(r=e.flip)==null?void 0:r.vertical]},()=>s()),ge(()=>{a=o.value.getContext("2d"),c()});const c=()=>{let i=e.w,r=e.h;o.value.width=i,o.value.height=r,n?(n=!1,l=document.createElement("img"),l.src=e.url,l.onload=()=>{a.drawImage(l,0,0,i,r),s()}):s()},s=()=>{const{vertical:i,horizontal:r}=e.flip??{};let m=e.w,u=e.h;const d=r?-1:1,h=i?-1:1;a.clearRect(0,0,m,u),a.translate(m/2-m*d/2,u/2-u*h/2),a.scale(d,h),a.drawImage(l,0,0,m,u),a.setTransform(1,0,0,1,0,0)};return(i,r)=>(C(),A("canvas",{ref_key:"canvas",ref:o},null,512))}}),tl=Object.freeze(Object.defineProperty({__proto__:null,default:el},Symbol.toStringTag,{value:"Module"})),al={class:"text-wrap"},ol=D({__name:"index",props:{modelValue:{default:""},defaultModelValue:{default:""},data:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""},fontSize:{default:""},borderColor:{default:""},w:{},h:{}},setup(t){return ce(e=>({"46dd5ff7":e.color,"7f931c9c":e.bgColor,c746d0b6:e.padding,a4c36304:e.radius,"522c9048":e.fontSize,"27fc0faa":e.borderColor})),(e,o)=>(C(),A("div",al,ie(e.modelValue||e.defaultModelValue),1))}});const ll=J(ol,[["__scopeId","data-v-8233b39d"]]),nl=Object.freeze(Object.defineProperty({__proto__:null,default:ll},Symbol.toStringTag,{value:"Module"})),il=["contenteditable"],sl=D({__name:"index",props:{modelValue:{default:""},defaultModelValue:{},data:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""},fontSize:{default:""},borderColor:{default:""},w:{},h:{},noWordWrap:{type:Boolean,default:!1},overEllipsis:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},hasModelValue:{type:Boolean}},emits:["update:modelValue","update:defaultModelValue","click"],setup(t,{emit:e}){const o=t;ce(r=>({"00cd0a69":r.color,"863570b8":r.bgColor,cde924d2:r.padding,"31a3f24c":r.radius,"7015a02a":r.fontSize,aedef5c6:r.borderColor,ba981f16:r.noWordWrap?"nowrap":"","58ddca96":r.overEllipsis?"hidden":"auto","6b9be9da":r.overEllipsis?"ellipsis":"unset"}));let a=L(!1),n=L();const l=async()=>{o.disabled||(a.value=!0,c(n.value),await Re(),n.value.focus())},c=r=>{const m=window.getSelection(),u=document.createRange();u.selectNodeContents(r),m.removeAllRanges(),m.addRange(u)},s=()=>{a.value=!1},i=r=>{o.hasModelValue&&e("update:modelValue",r.target.innerText),e("update:defaultModelValue",r.target.innerText)};return(r,m)=>(C(),A("div",{contenteditable:g(a),onBlur:s,onInput:i,ref_key:"text",ref:n,class:de({"text-wrap":!0,"can-edit":g(a)}),onDblclick:l},ie(r.modelValue||r.defaultModelValue),43,il))}});const rl=J(sl,[["__scopeId","data-v-b9e7c0b0"]]),dl=Object.freeze(Object.defineProperty({__proto__:null,default:rl},Symbol.toStringTag,{value:"Module"})),ul=["innerHTML"],cl=D({__name:"index",props:{url:{},color:{default:""},bgColor:{default:""},fillColor:{default:""},padding:{default:""},radius:{default:""},fontSize:{default:""},iconUseSelfColor:{type:Boolean}},setup(t){return ce(e=>({"46bf371c":e.color,"5a1a592f":e.fillColor,"1d6b7926":e.bgColor,"651f2d40":e.padding,"5f884d3a":e.radius,"6f5fc4fe":e.fontSize})),(e,o)=>(C(),A("div",{class:de({"icon-wrap":!0,"color-self":e.iconUseSelfColor}),innerHTML:e.url},null,10,ul))}});const fl=J(cl,[["__scopeId","data-v-6b52c610"]]),hl=Object.freeze(Object.defineProperty({__proto__:null,default:fl},Symbol.toStringTag,{value:"Module"})),pl={class:"img-scale-wrap"},ml=["src"],gl=D({__name:"index",props:{url:{},w:{},h:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""},lockAspectRatio:{type:Boolean,default:!1},position:{default:"left"},imgWidth:{},imgHeight:{}},setup(t){const e=t;ce(n=>({ef6c025e:n.color,"58f6c20c":n.bgColor,"351ce7ff":n.padding,cc74ea38:n.radius}));let o=F(()=>({[e.position]:0,width:e.imgWidth,height:e.imgHeight})),a=F(()=>({[e.position]:0,width:e.lockAspectRatio?e.w+"px":void 0,height:e.lockAspectRatio?e.h+"px":void 0}));return(n,l)=>(C(),A("div",pl,[I("div",{class:"img-scale-reduce",style:Q(g(o))},[I("img",{class:"img-scale",src:n.url,alt:"",style:Q(g(a))},null,12,ml)],4)]))}});const vl=J(gl,[["__scopeId","data-v-321d426b"]]),bl=Object.freeze(Object.defineProperty({__proto__:null,default:vl},Symbol.toStringTag,{value:"Module"})),yl=D({name:"dragPannelPreview"}),_l=D({...yl,props:{pannel:{},modelValue:{default:()=>({})},disabled:{type:Boolean,default:!1},parentWidth:{default:0}},emits:["click"],setup(t,{emit:e}){const o=t;let a=L(),n=L({});ge(()=>{c()});const l=u=>({width:u.w==="auto"?u.w:u.w+"px",height:u.h==="auto"?u.h:u.h+"px",fontSize:o.pannel.fontSize||u.fontSize,zIndex:u.z||"auto",transform:`translate(${u.x||0}px, ${u.y||0}px) rotate(${u.r||0}deg)`}),c=async()=>{await Re();let u={transformOrigin:"0% 0%",width:o.pannel.width+"px",height:o.pannel.height+"px",color:o.pannel.color,fontSize:o.pannel.fontSize,backgroundColor:o.pannel.bgColor},d=a.value.getBoundingClientRect(),{endRate:h,translateX:f,translateY:y}=s(d.width,d.height);n.value={...u,transform:`translate(${f}px, ${y}px) scale(${h})`}},s=(u,d)=>{let h=u/o.pannel.width,f=d/o.pannel.height,y=h>f?f:h,_=h<=f?0:u*y,k=f<=h?0:d*y;return{endRate:y,translateX:_>0?u/2-o.pannel.width/2*y:_,translateY:k>0?d/2-o.pannel.height/2*y:k}},i=u=>ut(u).default,r=u=>{u.self.click&&(console.log("click"),e("click",u))},m=u=>st(u,o.modelValue);return(u,d)=>(C(),A("div",{ref_key:"wrapRef",ref:a,class:"drag-editor-preivew-wrap"},[I("div",{class:de({"drag-editor-preivew":!0}),style:Q(g(n))},[(C(!0),A(Y,null,ae(u.pannel.components,h=>(C(),A("div",{class:"preview-item-wrap",style:Q(l(h))},[(C(),j(Ie(i(h.self.name)),be({data:h,h:h.h,w:h.w},m(h),{onClickCapture:Me(f=>r(h),["self"]),modelValue:u.modelValue[h.self.modelValue],"onUpdate:modelValue":f=>u.modelValue[h.self.modelValue]=f,defaultModelValue:h.self.defaultModelValue,"onUpdate:defaultModelValue":f=>h.self.defaultModelValue=f,groupModel:u.modelValue,disabled:!0}),null,16,["data","h","w","onClickCapture","modelValue","onUpdate:modelValue","defaultModelValue","onUpdate:defaultModelValue","groupModel"]))],4))),256))],4)],512))}});const wl=J(_l,[["__scopeId","data-v-b2568ace"]]),xl=Object.freeze(Object.defineProperty({__proto__:null,default:wl},Symbol.toStringTag,{value:"Module"}));let Vl=Object.assign({"./Group/index.vue":Go,"./Image/index.vue":Zo,"./Picture/index.vue":tl,"./Shape/index.vue":nl,"./Text/index.vue":dl,"./icon-svg/index.vue":hl,"./img-scale/index.vue":bl,"./preview/index.vue":xl});const ut=t=>Vl[`./${t}/index.vue`];function Oe(t){var e;const o=te(t);return(e=o==null?void 0:o.$el)!=null?e:o}const Kt=Ae?window:void 0;function Fe(...t){let e,o,a,n;if(typeof t[0]=="string"||Array.isArray(t[0])?([o,a,n]=t,e=Kt):[e,o,a,n]=t,!e)return ke;Array.isArray(o)||(o=[o]),Array.isArray(a)||(a=[a]);const l=[],c=()=>{l.forEach(m=>m()),l.length=0},s=(m,u,d,h)=>(m.addEventListener(u,d,h),()=>m.removeEventListener(u,d,h)),i=Z(()=>[Oe(e),te(n)],([m,u])=>{if(c(),!m)return;const d=Ft(u)?{...u}:u;l.push(...o.flatMap(h=>a.map(f=>s(m,h,f,d))))},{immediate:!0,flush:"post"}),r=()=>{i(),c()};return qe(r),r}let kt=!1;function Rt(t,e,o={}){const{window:a=Kt,ignore:n=[],capture:l=!0,detectIframe:c=!1}=o;if(!a)return;ot&&!kt&&(kt=!0,Array.from(a.document.body.children).forEach(d=>d.addEventListener("click",ke)),a.document.documentElement.addEventListener("click",ke));let s=!0;const i=d=>n.some(h=>{if(typeof h=="string")return Array.from(a.document.querySelectorAll(h)).some(f=>f===d.target||d.composedPath().includes(f));{const f=Oe(h);return f&&(d.target===f||d.composedPath().includes(f))}}),m=[Fe(a,"click",d=>{const h=Oe(t);if(!(!h||h===d.target||d.composedPath().includes(h))){if(d.detail===0&&(s=!i(d)),!s){s=!0;return}e(d)}},{passive:!0,capture:l}),Fe(a,"pointerdown",d=>{const h=Oe(t);h&&(s=!d.composedPath().includes(h)&&!i(d))},{passive:!0}),c&&Fe(a,"blur",d=>{setTimeout(()=>{var h;const f=Oe(t);((h=a.document.activeElement)==null?void 0:h.tagName)==="IFRAME"&&!(f!=null&&f.contains(a.document.activeElement))&&e(d)},0)})].filter(Boolean);return()=>m.forEach(d=>d())}const Ml={[yt.mounted](t,e){const o=!e.modifiers.bubble;if(typeof e.value=="function")t.__onClickOutside_stop=Rt(t,e.value,{capture:o});else{const[a,n]=e.value;t.__onClickOutside_stop=Rt(t,a,Object.assign({capture:o},n))}},[yt.unmounted](t){t.__onClickOutside_stop()}};function at(t){return typeof Window<"u"&&t instanceof Window?t.document.documentElement:typeof Document<"u"&&t instanceof Document?t.documentElement:t}function qt(t){const e=window.getComputedStyle(t);if(e.overflowX==="scroll"||e.overflowY==="scroll"||e.overflowX==="auto"&&t.clientWidth<t.scrollWidth||e.overflowY==="auto"&&t.clientHeight<t.scrollHeight)return!0;{const o=t.parentNode;return!o||o.tagName==="BODY"?!1:qt(o)}}function Sl(t){const e=t||window.event,o=e.target;return qt(o)?!1:e.touches.length>1?!0:(e.preventDefault&&e.preventDefault(),!1)}function Cl(t,e=!1){const o=L(e);let a=null,n;Z(qa(t),s=>{const i=at(te(s));if(i){const r=i;n=r.style.overflow,o.value&&(r.style.overflow="hidden")}},{immediate:!0});const l=()=>{const s=at(te(t));!s||o.value||(ot&&(a=Fe(s,"touchmove",i=>{Sl(i)},{passive:!1})),s.style.overflow="hidden",o.value=!0)},c=()=>{const s=at(te(t));!s||!o.value||(ot&&(a==null||a()),s.style.overflow=n,o.value=!1)};return qe(c),F({get(){return o.value},set(s){s?l():c()}})}function kl(){let t=!1;const e=L(!1);return(o,a)=>{if(e.value=a.value,t)return;t=!0;const n=Cl(o,a.value);Z(e,l=>n.value=l)}}kl();function At(...t){return F(()=>t.every(e=>te(e)))}const Rl=["onClick"],Al=D({__name:"index",props:{pannel:{},modelValue:{default:()=>({})},disabled:{type:Boolean,default:!1},active:{default:()=>[]}},emits:["refLineParams"],setup(t,{expose:e,emit:o}){const a=t;let n=L(!1),l=F(()=>({transform:`scale(${De.value})`,transformOrigin:"50% 0%",width:a.pannel.width+"px",height:a.pannel.height+"px",color:a.pannel.color,fontSize:a.pannel.fontSize,backgroundColor:a.pannel.bgColor}));const{text:c,copy:s}=no({legacy:!0});let i=L(),r=ue({isAllAsync:!1,controlKey:!1,draggingId:null,prevOffsetX:0,prevOffsetY:0});ge(()=>{d()}),$t(()=>{_()});const m=V=>({fontSize:a.pannel.fontSize||V.fontSize}),u=V=>{var T;return((T=ut(V))==null?void 0:T.default)??""},d=()=>{const V=ao(),T=F(()=>{var H,G,oe;return((H=V.value)==null?void 0:H.tagName)!=="INPUT"&&((G=V.value)==null?void 0:G.tagName)!=="TEXTAREA"&&((oe=V.value)==null?void 0:oe.getAttribute("contenteditable"))!=="true"&&n.value}),{Ctrl_C:W,Ctrl_V:z}=ro();_t(At(W,T),()=>{h()}),_t(At(z,T),()=>{f()}),$e(["ArrowDown"],H=>{T.value&&(H.preventDefault(),re("down"))}),$e(["ArrowLeft"],H=>{T.value&&(H.preventDefault(),re("left"))}),$e(["ArrowRight"],H=>{T.value&&(H.preventDefault(),re("right"))}),$e(["ArrowUp"],H=>{T.value&&(H.preventDefault(),re("up"))})},h=()=>{if(a.active.length)try{let V=JSON.stringify(a.active);s(V)}catch{}};let f=()=>{try{a.pannel.components.forEach(T=>{T.active=!1});let V=JSON.parse(c.value);V.forEach(T=>{T.active=!0,T.self.id=le()}),a.pannel.components.push(...V)}catch{}};const y=()=>{n.value=!0,window.addEventListener("keydown",E),window.addEventListener("keyup",S),window.addEventListener("keydown",b),window.addEventListener("keyup",x)},_=()=>{window.removeEventListener("keydown",E),window.removeEventListener("keyup",S),window.removeEventListener("keydown",b),window.removeEventListener("keyup",x)},k=()=>{_(),n.value=!1},E=V=>{V.keyCode===32&&(V.preventDefault(),r.isAllAsync=!0)},S=V=>{V.keyCode===32&&(V.preventDefault(),r.isAllAsync=!1)},b=V=>{V.keyCode===17&&(r.controlKey=!0)},x=V=>{V.keyCode===17&&(r.controlKey=!1)};let M=L();const p=V=>{var T;(T=M.value)==null||T.init(V)},R=V=>{r.controlKey?V.preventDeactivation=!0:a.pannel.components.forEach(T=>{T.active=!1,T.preventDeactivation=!1}),V.preventDeactivation=!0,V.active=!0},O=V=>{V.active=!1,V.preventDeactivation=!1},P=()=>{a.disabled||(y(),!(r.controlKey&&n)&&a.pannel.components.forEach(V=>{V.active=!1,V.preventDeactivation=!1}))},U=(V,T,W,z,H)=>{Object.assign(H,{x:V,y:T,w:W||H.width,h:z||H.width})},X=(V,T,W)=>{r.draggingId=V;const z=T-(V.x??0),H=W-(V.y??0),G=_e(z),oe=we(H);if(!r.isAllAsync){a.pannel.components.forEach(N=>{N.active&&N!==V&&(N.x=(N.x??0)+G,N.y=(N.y??0)+oe)});return}a.pannel.components.forEach(N=>{N!==V&&(N.x=(N.x??0)+G,N.y=(N.y??0)+oe)})},fe=(V,T,W)=>{a.pannel.components.forEach(z=>{z===V&&(z.x=T,z.y=W)}),r.draggingId=null,r.prevOffsetX=0,r.prevOffsetY=0},_e=V=>{const T=V-r.prevOffsetX;return r.prevOffsetX=V,T},we=V=>{const T=V-r.prevOffsetY;return r.prevOffsetY=V,T},re=V=>{let T=0,W=0;switch(V){case"up":W=-1;break;case"down":W=1;break;case"left":T=-1;break;case"right":T=1;break}a.pannel.components.forEach(z=>{z.active&&(z.x=(z.x??0)+T,z.y=(z.y??0)+W)})},ee=(V,T)=>{T.r=V},se=V=>st(V,a.modelValue);return e({ref:i}),(V,T)=>{const W=B("VueDragResizeRotate");return it((C(),A("div",{ref_key:"dragRef",ref:i,class:de({"drag-editor-wrap":!0,disabled:V.disabled}),onClick:Me(P,["self","stop"]),onMousedown:T[0]||(T[0]=z=>y()),style:Q(g(l))},[(C(!0),A(Y,null,ae(V.pannel.components,z=>(C(),j(W,be({...g(jt),...z,self:"",dySelf:""},{h:z.h=="auto"?z.h:parseFloat(z.h)||0,w:z.w=="auto"?z.w:parseFloat(z.w)||0,onActivated:H=>R(z),onDeactivated:H=>O(z),onRefLineParams:p,onResizing:(H,G,oe,N)=>U(H,G,oe,N,z),onResizestop:(H,G,oe,N)=>U(H,G,oe,N,z),onDragging:(H,G)=>X(z,H,G),onDragstop:(H,G)=>fe(z,H,G),onRotating:H=>ee(H,z),onRotatestop:H=>ee(H,z),scaleRatio:g(De)}),{default:w(()=>[(C(),j(Ie(u(z.self.name)),be({key:z.self.id,data:z,h:z.h,w:z.w},se(z),{style:m(z),hasModelValue:!!z.self.modelValue,modelValue:V.modelValue[z.self.modelValue],"onUpdate:modelValue":H=>V.modelValue[z.self.modelValue]=H,defaultModelValue:z.self.defaultModelValue,"onUpdate:defaultModelValue":H=>z.self.defaultModelValue=H,groupModel:V.modelValue}),null,16,["data","h","w","style","hasModelValue","modelValue","onUpdate:modelValue","defaultModelValue","onUpdate:defaultModelValue","groupModel"]))]),_:2},1040,["h","w","onActivated","onDeactivated","onResizing","onResizestop","onDragging","onDragstop","onRotating","onRotatestop","scaleRatio"]))),256)),v(jo,{ref_key:"subLineRef",ref:M},null,512)],46,Rl)),[[g(Ml),k]])}}});const zl=J(Al,[["__scopeId","data-v-d4d46cc9"]]),zt=""+new URL("../gif/gif.5a563899.gif",import.meta.url).href,Tt=[{w:"auto",h:"auto",self:{id:le(),name:"Text",desc:"文本",modelValue:"",defaultModelValue:"文本"},dySelf:{}},{w:200,h:200,self:{id:le(),name:"Image",desc:"图片",url:zt},dySelf:{}},{w:100,h:100,self:{id:le(),name:"icon-svg",desc:"svg",url:'<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" data-v-ea893728=""><path fill="currentColor" d="M600.704 64a32 32 0 0 1 30.464 22.208l35.2 109.376c14.784 7.232 28.928 15.36 42.432 24.512l112.384-24.192a32 32 0 0 1 34.432 15.36L944.32 364.8a32 32 0 0 1-4.032 37.504l-77.12 85.12a357.12 357.12 0 0 1 0 49.024l77.12 85.248a32 32 0 0 1 4.032 37.504l-88.704 153.6a32 32 0 0 1-34.432 15.296L708.8 803.904c-13.44 9.088-27.648 17.28-42.368 24.512l-35.264 109.376A32 32 0 0 1 600.704 960H423.296a32 32 0 0 1-30.464-22.208L357.696 828.48a351.616 351.616 0 0 1-42.56-24.64l-112.32 24.256a32 32 0 0 1-34.432-15.36L79.68 659.2a32 32 0 0 1 4.032-37.504l77.12-85.248a357.12 357.12 0 0 1 0-48.896l-77.12-85.248A32 32 0 0 1 79.68 364.8l88.704-153.6a32 32 0 0 1 34.432-15.296l112.32 24.256c13.568-9.152 27.776-17.408 42.56-24.64l35.2-109.312A32 32 0 0 1 423.232 64H600.64zm-23.424 64H446.72l-36.352 113.088-24.512 11.968a294.113 294.113 0 0 0-34.816 20.096l-22.656 15.36-116.224-25.088-65.28 113.152 79.68 88.192-1.92 27.136a293.12 293.12 0 0 0 0 40.192l1.92 27.136-79.808 88.192 65.344 113.152 116.224-25.024 22.656 15.296a294.113 294.113 0 0 0 34.816 20.096l24.512 11.968L446.72 896h130.688l36.48-113.152 24.448-11.904a288.282 288.282 0 0 0 34.752-20.096l22.592-15.296 116.288 25.024 65.28-113.152-79.744-88.192 1.92-27.136a293.12 293.12 0 0 0 0-40.256l-1.92-27.136 79.808-88.128-65.344-113.152-116.288 24.96-22.592-15.232a287.616 287.616 0 0 0-34.752-20.096l-24.448-11.904L577.344 128zM512 320a192 192 0 1 1 0 384 192 192 0 0 1 0-384zm0 64a128 128 0 1 0 0 256 128 128 0 0 0 0-256z"></path></svg>'},dySelf:{}},{w:100,h:100,self:{id:le(),name:"Shape",desc:"图形",borderColor:"solid 1px #333",prop:"state",activeValue:"1",activeMap:'{"bgColor":"red"}'},dySelf:{}},{w:200,h:200,self:{id:le(),name:"img-scale",desc:"缩放图片",url:zt},dySelf:{}}],Tl=["data-index"],Ll=D({__name:"components-list",setup(t){const e=o=>{let a=JSON.stringify(Tt[o.target.dataset.index]);o.dataTransfer.setData("component",a)};return(o,a)=>(C(),A("div",{class:"component-list",onDragstart:e},[(C(!0),A(Y,null,ae(g(Tt),(n,l)=>(C(),A("div",{key:l,class:"list",draggable:!0,"data-index":l},[I("span",null,ie(n.self.desc),1)],8,Tl))),128))],32))}});const Hl=J(Ll,[["__scopeId","data-v-eac31297"]]),El={class:"com-list-wrap"},Ul={class:"com-wrap"},Ol={class:"real-com-wrap"},Bl=["onClick"],Dl=["onClick"],Pl=D({__name:"index",setup(t){let e=Ke("pannel",L({}));const o=n=>{n.active=!0},a=n=>{e.components=e.components.filter(l=>l!==n)};return(n,l)=>{const c=B("el-icon"),s=B("el-scrollbar");return C(),A("div",El,[I("div",Ul,[v(Hl)]),v(s,{height:"50%",always:""},{default:w(()=>[I("div",Ol,[(C(!0),A(Y,null,ae(g(e).components,i=>(C(),A("div",{class:de({"com-item":!0,active:i.active}),onClick:r=>o(i)},[I("div",{class:"close-wrap",onClick:Me(r=>a(i),["stop"])},[v(c,null,{default:w(()=>[v(g(ua))]),_:1})],8,Dl),$(" "+ie(i.self.desc||i.self.name)+" "+ie(i.self.name=="Group"?i.group.length:""),1)],10,Bl))),256))])]),_:1})])}}});const Il=J(Pl,[["__scopeId","data-v-d9d007a9"]]),$l=D({__name:"platform",props:{pannel:{}},setup(t){return(e,o)=>{const a=B("el-input"),n=B("el-form-item"),l=B("el-input-number"),c=B("el-color-picker"),s=B("el-form");return C(),j(s,{size:"small"},{default:w(()=>[v(n,{label:"版本"},{default:w(()=>[v(a,{modelValue:e.pannel.version,"onUpdate:modelValue":o[0]||(o[0]=i=>e.pannel.version=i)},null,8,["modelValue"])]),_:1}),v(n,{label:"描述"},{default:w(()=>[v(a,{modelValue:e.pannel.desc,"onUpdate:modelValue":o[1]||(o[1]=i=>e.pannel.desc=i)},null,8,["modelValue"])]),_:1}),v(n,{label:"宽度"},{default:w(()=>[v(l,{modelValue:e.pannel.width,"onUpdate:modelValue":o[2]||(o[2]=i=>e.pannel.width=i)},null,8,["modelValue"])]),_:1}),v(n,{label:"高度"},{default:w(()=>[v(l,{modelValue:e.pannel.height,"onUpdate:modelValue":o[3]||(o[3]=i=>e.pannel.height=i)},null,8,["modelValue"])]),_:1}),v(n,{label:"文字颜色"},{default:w(()=>[v(c,{modelValue:e.pannel.color,"onUpdate:modelValue":o[4]||(o[4]=i=>e.pannel.color=i)},null,8,["modelValue"])]),_:1}),v(n,{label:"背景色"},{default:w(()=>[v(c,{modelValue:e.pannel.bgColor,"onUpdate:modelValue":o[5]||(o[5]=i=>e.pannel.bgColor=i)},null,8,["modelValue"])]),_:1}),v(n,{label:"文字大小"},{default:w(()=>[v(a,{placeholder:"0px",modelValue:e.pannel.fontSize,"onUpdate:modelValue":o[6]||(o[6]=i=>e.pannel.fontSize=i)},null,8,["modelValue"])]),_:1})]),_:1})}}});const Wl=J($l,[["__scopeId","data-v-6ad875fe"]]),Qt=t=>(la("data-v-7056c102"),t=t(),na(),t),Nl={key:2},jl={key:3},Fl={key:4},Xl=Qt(()=>I("br",null,null,-1)),Yl=Qt(()=>I("br",null,null,-1)),Jl=D({__name:"componentsAttr",props:{active:{}},setup(t){const e=t;let o=L(["1","3","2"]),a=F(()=>{if(e.active){let u={...jt,...e.active};return Object.assign(e.active,u)}return e.active}),n=[{label:"靠上",value:"top"},{label:"靠下",value:"bottom"},{label:"靠左",value:"left"},{label:"靠右",value:"right"}],l=[{label:"大于",value:"大于"},{label:"小于",value:"小于"},{label:"等于",value:"等于"},{label:"不等于",value:"不等于"},{label:"大于等于",value:"大于等于"},{label:"小于等于",value:"小于等于"},{label:"存在(!null && !undefind)",value:"存在"},{label:"不存在(null || undefind)",value:"不存在"}],c=["Text","Shape"],s=F(()=>c.indexOf(e.active.self.name)>-1),i=F(()=>e.active.self.name=="Image"),r=F(()=>e.active.self.name=="img-scale"),m=F(()=>e.active.self.name=="icon-svg");return(u,d)=>{const h=B("el-input"),f=B("el-form-item"),y=B("el-switch"),_=B("el-color-picker"),k=B("el-form"),E=B("el-collapse-item"),S=B("el-option"),b=B("el-select"),x=B("el-input-number"),M=B("el-collapse");return C(),j(M,{modelValue:g(o),"onUpdate:modelValue":d[36]||(d[36]=p=>ve(o)?o.value=p:o=p)},{default:w(()=>[v(E,{title:"特有属性",name:"1"},{default:w(()=>[v(k,{size:"small"},{default:w(()=>[v(f,{label:"组件名称",title:"self.name"},{default:w(()=>[v(h,{disabled:"",modelValue:g(a).self.name,"onUpdate:modelValue":d[0]||(d[0]=p=>g(a).self.name=p)},null,8,["modelValue"])]),_:1}),v(f,{label:"组件id",title:"self.id"},{default:w(()=>[v(h,{modelValue:g(a).self.id,"onUpdate:modelValue":d[1]||(d[1]=p=>g(a).self.id=p)},null,8,["modelValue"])]),_:1}),v(f,{label:"点击事件",title:"self.click"},{default:w(()=>[v(y,{modelValue:g(a).self.click,"onUpdate:modelValue":d[2]||(d[2]=p=>g(a).self.click=p)},null,8,["modelValue"])]),_:1}),v(f,{label:"width",title:"w"},{default:w(()=>[v(h,{modelValue:g(a).w,"onUpdate:modelValue":d[3]||(d[3]=p=>g(a).w=p)},null,8,["modelValue"])]),_:1}),v(f,{label:"height",title:"h"},{default:w(()=>[v(h,{modelValue:g(a).h,"onUpdate:modelValue":d[4]||(d[4]=p=>g(a).h=p)},null,8,["modelValue"])]),_:1}),g(r)?(C(),j(f,{key:0,label:"图片内部宽度",title:"self.imgWidth"},{default:w(()=>[v(h,{modelValue:g(a).self.imgWidth,"onUpdate:modelValue":d[5]||(d[5]=p=>g(a).self.imgWidth=p),placeholder:"动态控制%"},null,8,["modelValue"])]),_:1})):me("",!0),g(r)?(C(),j(f,{key:1,label:"图片内部高度",title:"self.imgHeight"},{default:w(()=>[v(h,{modelValue:g(a).self.imgHeight,"onUpdate:modelValue":d[6]||(d[6]=p=>g(a).self.imgHeight=p),placeholder:"动态控制%"},null,8,["modelValue"])]),_:1})):me("",!0),g(m)?(C(),A("div",Nl,[v(f,{label:"icon自定义颜色",title:"self.iconUseSelfColor"},{default:w(()=>[v(y,{modelValue:g(a).self.iconUseSelfColor,"onUpdate:modelValue":d[7]||(d[7]=p=>g(a).self.iconUseSelfColor=p)},null,8,["modelValue"])]),_:1}),v(f,{label:"icon背景色",title:"self.fillColor"},{default:w(()=>[v(_,{modelValue:g(a).self.fillColor,"onUpdate:modelValue":d[8]||(d[8]=p=>g(a).self.fillColor=p)},null,8,["modelValue"])]),_:1})])):me("",!0),v(f,{label:"颜色",title:"self.color"},{default:w(()=>[v(_,{modelValue:g(a).self.color,"onUpdate:modelValue":d[9]||(d[9]=p=>g(a).self.color=p)},null,8,["modelValue"])]),_:1}),v(f,{label:"背景色",title:"self.bgColor"},{default:w(()=>[v(_,{modelValue:g(a).self.bgColor,"onUpdate:modelValue":d[10]||(d[10]=p=>g(a).self.bgColor=p)},null,8,["modelValue"])]),_:1}),v(f,{label:"边框",title:"self.borderColor"},{default:w(()=>[v(h,{placeholder:"solid 1px #000000",modelValue:g(a).self.borderColor,"onUpdate:modelValue":d[11]||(d[11]=p=>g(a).self.borderColor=p)},null,8,["modelValue"])]),_:1}),v(f,{label:"padding",title:"self.padding"},{default:w(()=>[v(h,{modelValue:g(a).self.padding,"onUpdate:modelValue":d[12]||(d[12]=p=>g(a).self.padding=p),placeholder:"0px 0px 0px 0px"},null,8,["modelValue"])]),_:1}),v(f,{label:"radius",title:"self.radius"},{default:w(()=>[v(h,{modelValue:g(a).self.radius,"onUpdate:modelValue":d[13]||(d[13]=p=>g(a).self.radius=p),placeholder:"0px 0px 0px 0px"},null,8,["modelValue"])]),_:1}),v(f,{label:"文字大小",title:"self.fontSize"},{default:w(()=>[v(h,{modelValue:g(a).self.fontSize,"onUpdate:modelValue":d[14]||(d[14]=p=>g(a).self.fontSize=p),placeholder:"0px"},null,8,["modelValue"])]),_:1}),v(f,{label:"modelValue",title:"self.modelValue"},{default:w(()=>[v(h,{placeholder:"绑定属性",modelValue:g(a).self.modelValue,"onUpdate:modelValue":d[15]||(d[15]=p=>g(a).self.modelValue=p)},null,8,["modelValue"])]),_:1}),g(s)?(C(),A("div",jl,[v(f,{label:"默认值",title:"self.defaultModelValue"},{default:w(()=>[v(h,{modelValue:g(a).self.defaultModelValue,"onUpdate:modelValue":d[16]||(d[16]=p=>g(a).self.defaultModelValue=p)},null,8,["modelValue"])]),_:1}),v(f,{label:"禁止换行",title:"self.noWordWrap"},{default:w(()=>[v(y,{modelValue:g(a).self.noWordWrap,"onUpdate:modelValue":d[17]||(d[17]=p=>g(a).self.noWordWrap=p)},null,8,["modelValue"])]),_:1}),v(f,{label:"超出省略",title:"self.overEllipsis"},{default:w(()=>[v(y,{modelValue:g(a).self.overEllipsis,"onUpdate:modelValue":d[18]||(d[18]=p=>g(a).self.overEllipsis=p)},null,8,["modelValue"])]),_:1})])):me("",!0),g(i)||g(r)?(C(),A("div",Fl,[v(f,{label:"url",title:"self.url"},{default:w(()=>[v(h,{modelValue:g(a).self.url,"onUpdate:modelValue":d[19]||(d[19]=p=>g(a).self.url=p)},null,8,["modelValue"])]),_:1})])):me("",!0)]),_:1})]),_:1}),v(E,{title:"逻辑处理",name:"3"},{default:w(()=>[v(k,{size:"small","label-position":"top"},{default:w(()=>[v(f,{label:"prop",title:"self.prop"},{default:w(()=>[v(h,{placeholder:"绑定属性",modelValue:g(a).self.prop,"onUpdate:modelValue":d[20]||(d[20]=p=>g(a).self.prop=p)},null,8,["modelValue"])]),_:1}),v(f,{label:"值匹配"},{default:w(()=>[v(b,{title:"self.activeMode",modelValue:g(a).self.activeMode,"onUpdate:modelValue":d[21]||(d[21]=p=>g(a).self.activeMode=p)},{default:w(()=>[(C(!0),A(Y,null,ae(g(l),p=>(C(),j(S,{label:p.label,value:p.value},null,8,["label","value"]))),256))]),_:1},8,["modelValue"]),Xl,Yl,v(h,{title:"self.activeValue",placeholder:`1 (${g(a).self.prop||"prop"}${g(a).self.activeMode||""}1)`,modelValue:g(a).self.activeValue,"onUpdate:modelValue":d[22]||(d[22]=p=>g(a).self.activeValue=p)},null,8,["placeholder","modelValue"])]),_:1}),v(f,{label:"匹配后重置属性",title:"self.activeMap"},{default:w(()=>[v(h,{type:"textarea",placeholder:'{"bgColor":"red || ${red}"}',modelValue:g(a).self.activeMap,"onUpdate:modelValue":d[23]||(d[23]=p=>g(a).self.activeMap=p)},null,8,["modelValue"])]),_:1}),g(r)?(C(),j(f,{key:0,label:"图片比例固定",title:"self.lockAspectRatio"},{default:w(()=>[v(y,{modelValue:g(a).self.lockAspectRatio,"onUpdate:modelValue":d[24]||(d[24]=p=>g(a).self.lockAspectRatio=p)},null,8,["modelValue"])]),_:1})):me("",!0),g(r)?(C(),j(f,{key:1,label:"图片比例起始位置",title:"self.position"},{default:w(()=>[v(b,{modelValue:g(a).self.position,"onUpdate:modelValue":d[25]||(d[25]=p=>g(a).self.position=p)},{default:w(()=>[(C(!0),A(Y,null,ae(g(n),p=>(C(),j(S,{label:p.label,value:p.value},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})):me("",!0)]),_:1})]),_:1}),v(E,{title:"通用属性",name:"2"},{default:w(()=>[v(k,{size:"small"},{default:w(()=>[v(f,{label:"left"},{default:w(()=>[v(x,{modelValue:g(a).x,"onUpdate:modelValue":d[26]||(d[26]=p=>g(a).x=p)},null,8,["modelValue"])]),_:1}),v(f,{label:"top"},{default:w(()=>[v(x,{modelValue:g(a).y,"onUpdate:modelValue":d[27]||(d[27]=p=>g(a).y=p)},null,8,["modelValue"])]),_:1}),v(f,{label:"zIndex"},{default:w(()=>[v(x,{modelValue:g(a).z,"onUpdate:modelValue":d[28]||(d[28]=p=>g(a).z=p)},null,8,["modelValue"])]),_:1}),v(f,{label:"旋转"},{default:w(()=>[v(x,{min:0,modelValue:g(a).r,"onUpdate:modelValue":d[29]||(d[29]=p=>g(a).r=p)},null,8,["modelValue"])]),_:1}),v(f,{label:"锁定比例"},{default:w(()=>[v(y,{modelValue:g(a).lockAspectRatio,"onUpdate:modelValue":d[30]||(d[30]=p=>g(a).lockAspectRatio=p)},null,8,["modelValue"])]),_:1}),v(f,{label:"缩放"},{default:w(()=>[v(y,{modelValue:g(a).resizable,"onUpdate:modelValue":d[31]||(d[31]=p=>g(a).resizable=p)},null,8,["modelValue"])]),_:1}),v(f,{label:"旋转"},{default:w(()=>[v(y,{modelValue:g(a).rotatable,"onUpdate:modelValue":d[32]||(d[32]=p=>g(a).rotatable=p)},null,8,["modelValue"])]),_:1}),v(f,{label:"父级约束"},{default:w(()=>[v(y,{modelValue:g(a).parent,"onUpdate:modelValue":d[33]||(d[33]=p=>g(a).parent=p)},null,8,["modelValue"])]),_:1}),v(f,{label:"吸附"},{default:w(()=>[v(y,{modelValue:g(a).snap,"onUpdate:modelValue":d[34]||(d[34]=p=>g(a).snap=p)},null,8,["modelValue"])]),_:1}),v(f,{label:"吸附距离"},{default:w(()=>[v(x,{modelValue:g(a).snapTolerance,"onUpdate:modelValue":d[35]||(d[35]=p=>g(a).snapTolerance=p)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}});const Gl=J(Jl,[["__scopeId","data-v-7056c102"]]),Kl={class:"wrap"},ql=D({__name:"index",props:{active:{default:()=>({})},activeLength:{}},setup(t){const e=t;let o=L(""),a=Ke("pannel",ue({}));return Z(()=>e.activeLength,n=>{n==1?o.value="com":o.value="plat"},{immediate:!0}),(n,l)=>{const c=B("el-tab-pane"),s=B("el-tabs");return C(),A("div",Kl,[v(s,{modelValue:g(o),"onUpdate:modelValue":l[0]||(l[0]=i=>ve(o)?o.value=i:o=i),class:"demo-tabs"},{default:w(()=>[v(c,{label:"平台",name:"plat"},{default:w(()=>[v(Wl,{pannel:g(a)},null,8,["pannel"])]),_:1}),v(c,{label:"组件",name:"com"},{default:w(()=>[n.activeLength==1?(C(),j(Gl,{key:0,active:n.active},null,8,["active"])):me("",!0)]),_:1})]),_:1},8,["modelValue"])])}}});const Ql=J(ql,[["__scopeId","data-v-fba398cd"]]),Zl={class:"container"},en={class:"left"},tn={class:"mid",ref:"midRef"},an={class:"right"},on=D({__name:"App",setup(t){let e=ue({version:"0.1",desc:"描述",width:1e3,height:700,bgColor:void 0,color:void 0,fontSize:void 0,components:[]});try{let i=Uo();rt(e,i)}catch{}let o=L(),a=L();ia("pannel",e);let n=F(()=>{var i,r;return(r=(i=e.components)==null?void 0:i.filter)==null?void 0:r.call(i,m=>m.active)});Z(()=>e.width,()=>{var i,r;(r=(i=a.value)==null?void 0:i.update)==null||r.call(i)},{flush:"post"});let l=ue({name1:"哈哈",state:1});setInterval(()=>{l.state=l.state==1?2:1,l.red=l.red=="red"?"green":"red",l.rate=l.rate=="40%"?"100%":"40%"},1e3);const c=i=>{i.preventDefault(),i.stopPropagation();const r=i.dataTransfer.getData("component");let m=JSON.parse(r);const u=o.value.ref.getBoundingClientRect();m&&(m.y=i.clientY-u.y,m.x=i.clientX-u.x,m.self.id=le(),e.components.push(m))},s=i=>{i.preventDefault(),i.dataTransfer.dropEffect="copy"};return(i,r)=>{const m=B("el-scrollbar");return C(),A(Y,null,[v(Wo),I("div",Zl,[I("div",en,[v(Il)]),I("div",tn,[v(m,{ref_key:"editScrollRef",ref:a,always:""},{default:w(()=>[v(zl,{ref_key:"editorRef",ref:o,onDrop:c,onDragover:s,pannel:g(e),modelValue:g(l),"onUpdate:modelValue":r[0]||(r[0]=u=>ve(l)?l.value=u:l=u),active:g(n)},null,8,["pannel","modelValue","active"])]),_:1},512)],512),I("div",an,[v(m,null,{default:w(()=>[v(Ql,{activeLength:g(n).length,active:g(n)[0]},null,8,["activeLength","active"])]),_:1})])])],64)}}});const ln=J(on,[["__scopeId","data-v-5881cd32"]]);const Lt=new WeakMap;function nn(t){let e=Lt.get(t);return e||Lt.set(t,e=Object.create(null)),e}function q(t,e,...o){t&&t.$emit&&t.$emit(e,...o);const a=nn(t)[e];return a&&a.map(n=>n.apply(t,o)),t}function Ht(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Function]"}function Ue(t,e,o,a=1){const n=Math.round(e/a/t[0])*t[0],l=Math.round(o/a/t[1])*t[1];return[n,l]}function Et(t,e,o){return t-e-o}function Ut(t,e,o){return t-e-o}function K(t,e,o){return e!==null&&t<e?e:o!==null&&o<t?o:t}function Ne(t,e,o,a,n){const l=Math.PI/180*n,c=Math.cos(l),s=Math.sin(l);let i=o-t,r=a-e;return{x:i*c-r*s+t,y:i*s+r*c+e}}function sn(t,e){let o=Math.atan2(e,t);return o=Math.round(180/Math.PI*o),o<0&&(o=360+o),o}function Ot(t,e,o){let a=t;const n=["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"].find(l=>Ht(a[l]));if(!Ht(a[n]))return!1;do{if(a[n](e))return!0;if(a===o)return!1;a=a.parentNode}while(a);return!1}function rn(t){const e=window.getComputedStyle(t);return[parseFloat(e.getPropertyValue("width"),10),parseFloat(e.getPropertyValue("height"),10)]}function Ve(t,e,o){t&&(t.attachEvent?t.attachEvent("on"+e,o):t.addEventListener?t.addEventListener(e,o,!0):t["on"+e]=o)}function he(t,e,o){t&&(t.detachEvent?t.detachEvent("on"+e,o):t.removeEventListener?t.removeEventListener(e,o,!0):t["on"+e]=null)}const Xe={mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"},touch:{start:"touchstart",move:"touchmove",stop:"touchend"}},dn={userSelect:"none",MozUserSelect:"none",WebkitUserSelect:"none",MsUserSelect:"none"},un={userSelect:"auto",MozUserSelect:"auto",WebkitUserSelect:"auto",MsUserSelect:"auto"};let pe=Xe.mouse;var ze={name:"VueDragResizeRotate",props:{className:{type:String,default:"vue-drag-resize-rotate"},classNameDraggable:{type:String,default:"draggable"},classNameResizable:{type:String,default:"resizable"},classNameRotatable:{type:String,default:"rotatable"},classNameDragging:{type:String,default:"dragging"},classNameResizing:{type:String,default:"resizing"},classNameRotating:{type:String,default:"rotating"},classNameActive:{type:String,default:"active"},classNameHandle:{type:String,default:"handle"},disableUserSelect:{type:Boolean,default:!0},enableNativeDrag:{type:Boolean,default:!1},preventDeactivation:{type:Boolean,default:!1},active:{type:Boolean,default:!1},draggable:{type:Boolean,default:!0},resizable:{type:Boolean,default:!0},rotatable:{type:Boolean,default:!1},lockAspectRatio:{type:Boolean,default:!1},outsideAspectRatio:{type:[Number,String],default:0},w:{type:[Number,String],default:200,validator:t=>typeof t=="number"?t>0:t==="auto"},h:{type:[Number,String],default:200,validator:t=>typeof t=="number"?t>0:t==="auto"},minWidth:{type:Number,default:0,validator:t=>t>=0},minHeight:{type:Number,default:0,validator:t=>t>=0},maxWidth:{type:Number,default:1/0,validator:t=>t>=0},maxHeight:{type:Number,default:1/0,validator:t=>t>=0},x:{type:[String,Number],default:0},y:{type:[String,Number],default:0},z:{type:[String,Number],default:"auto",validator:t=>typeof t=="string"?t==="auto":t>=0},r:{type:[String,Number],default:0},handles:{type:Array,default:()=>["tl","tm","tr","mr","br","bm","bl","ml","rot"],validator:t=>{const e=new Set(["tl","tm","tr","mr","br","bm","bl","ml","rot"]);return new Set(t.filter(o=>e.has(o))).size===t.length}},dragHandle:{type:String,default:null},dragCancel:{type:String,default:null},axis:{type:String,default:"both",validator:t=>["x","y","both"].includes(t)},grid:{type:Array,default:()=>[1,1]},parent:{type:[Boolean,String],default:!1},onDragStart:{type:Function,default:()=>!0},onDrag:{type:Function,default:()=>!0},onResizeStart:{type:Function,default:()=>!0},onResize:{type:Function,default:()=>!0},onRotateStart:{type:Function,default:()=>!0},onRotate:{type:Function,default:()=>!0},isConflictCheck:{type:Boolean,default:!1},snap:{type:Boolean,default:!1},snapBorder:{type:Boolean,default:!1},snapTolerance:{type:Number,default:5,validator:function(t){return typeof t=="number"}},scaleRatio:{type:Number,default:1,validator:t=>typeof t=="number"},handleInfo:{type:Object,default:()=>({size:8,offset:-4,switch:!0})}},data:function(){return{left:this.x,top:this.y,right:null,bottom:null,rotate:this.r,width:null,height:null,widthTouched:!1,heightTouched:!1,aspectFactor:null,parentWidth:null,parentHeight:null,minW:this.minWidth,minH:this.minHeight,maxW:this.maxWidth,maxH:this.maxHeight,handle:null,enabled:this.active,resizing:!1,dragging:!1,rotating:!1,zIndex:this.z,lastCenterX:0,lastCenterY:0,parentX:0,parentY:0}},computed:{handleStyle(){return t=>{if(!this.handleInfo.switch)return{display:this.enabled?"block":"none"};if(t==="rot"&&!this.rotatable)return{display:"none"};if(t!=="rot"&&!this.resizable)return{display:"none"};const e=(this.handleInfo.size/this.scaleRatio).toFixed(2),o=(this.handleInfo.offset/this.scaleRatio).toFixed(2),a=(e/2).toFixed(2),n={tl:{top:`${o}px`,left:`${o}px`},tm:{top:`${o}px`,left:`calc(50% - ${a}px)`},tr:{top:`${o}px`,right:`${o}px`},mr:{top:`calc(50% - ${a}px)`,right:`${o}px`},br:{bottom:`${o}px`,right:`${o}px`},bm:{bottom:`${o}px`,right:`calc(50% - ${a}px)`},bl:{bottom:`${o}px`,left:`${o}px`},ml:{top:`calc(50% - ${a}px)`,left:`${o}px`},rot:{top:`-${e*3}px`,left:"50%"}},l={width:n[t].width||`${e}px`,height:n[t].height||`${e}px`,top:n[t].top,left:n[t].left,right:n[t].right,bottom:n[t].bottom},c={tl:0,tm:1,tr:2,mr:3,br:4,bm:5,bl:6,ml:7,rot:8};if(t!=="rot"){const s=["nw-resize","n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize","w-resize"],r=this.rotate+22.5,m=Math.floor(r/45);let u=(c[t]+m)%8;l.cursor=s[u]}return l.display=this.enabled?"block":"none",l}},style(){return{transform:`translate(${this.left}px, ${this.top}px) rotate(${this.rotate}deg)`,width:this.computedWidth,height:this.computedHeight,zIndex:this.zIndex,fontSize:this.handleInfo.size*2+"px",...this.dragging&&this.disableUserSelect?dn:un}},actualHandles(){return!this.resizable&&!this.rotatable?[]:this.handles},computedWidth(){return this.w==="auto"&&!this.widthTouched?"auto":this.width+"px"},computedHeight(){return this.h==="auto"&&!this.heightTouched?"auto":this.height+"px"}},watch:{active(t){this.enabled=t,t?(this.updateParentSize(),q(this,"activated")):q(this,"deactivated")},x(t){this.resizing||this.dragging||(this.parent&&(this.bounds=this.calcDragLimits()),this.moveHorizontally(t))},y(t){this.resizing||this.dragging||(this.parent&&(this.bounds=this.calcDragLimits()),this.moveVertically(t))},z(t){(t>=0||t==="auto")&&(this.zIndex=t)},r(t){t>=0&&(this.rotate=t%360)},lockAspectRatio(t){t?this.outsideAspectRatio?this.aspectFactor=this.outsideAspectRatio:this.aspectFactor=this.width/this.height:this.aspectFactor=void 0},outsideAspectRatio(t){t&&(this.aspectFactor=t)},minWidth(t){t>0&&t<=this.width&&(this.minW=t)},minHeight(t){t>0&&t<=this.height&&(this.minH=t)},maxWidth(t){this.maxW=t},maxHeight(t){this.maxH=t},w(t){this.resizing||this.dragging||(this.parent&&(this.bounds=this.calcResizeLimits()),this.changeWidth(t))},h(t){this.resizing||this.dragging||(this.parent&&(this.bounds=this.calcResizeLimits()),this.changeHeight(t))}},created:function(){this.maxWidth&&this.minWidth>this.maxWidth&&console.warn("[Vdr warn]: Invalid prop: minWidth cannot be greater than maxWidth"),this.maxWidth&&this.minHeight>this.maxHeight&&console.warn("[Vdr warn]: Invalid prop: minHeight cannot be greater than maxHeight"),this.elmX=0,this.elmY=0,this.elmW=0,this.elmH=0,this.lastCenterX=0,this.lastCenterY=0,this.fixedXName="",this.fixedYName="",this.fixedX=0,this.fixedY=0,this.TL={},this.TR={},this.BL={},this.BR={},this.resetBoundsAndMouseState()},mounted:function(){this.enableNativeDrag||(this.$el.ondragstart=()=>!1);const[t,e]=this.getParentSize();this.parentWidth=t,this.parentHeight=e;const[o,a]=rn(this.$el);this.aspectFactor=(this.w!=="auto"?this.w:o)/(this.h!=="auto"?this.h:a),this.outsideAspectRatio&&(this.aspectFactor=this.outsideAspectRatio),this.width=this.w!=="auto"?this.w:o,this.height=this.h!=="auto"?this.h:a,this.right=this.parentWidth-this.width-this.left,this.bottom=this.parentHeight-this.height-this.top,this.settingAttribute(),Ve(document.documentElement,"mousedown",this.deselect),Ve(document.documentElement,"touchend touchcancel",this.deselect),Ve(window,"resize",this.checkParentSize)},beforeUnmount:function(){he(document.documentElement,"mousedown",this.deselect),he(document.documentElement,"touchstart",this.handleUp),he(document.documentElement,"mousemove",this.move),he(document.documentElement,"touchmove",this.move),he(document.documentElement,"mouseup",this.handleUp),he(document.documentElement,"touchend touchcancel",this.deselect),he(window,"resize",this.checkParentSize)},methods:{resetBoundsAndMouseState(){this.mouseClickPosition={mouseX:0,mouseY:0,x:0,y:0,w:0,h:0},this.bounds={minLeft:null,maxLeft:null,minRight:null,maxRight:null,minTop:null,maxTop:null,minBottom:null,maxBottom:null}},checkParentSize(){if(this.parent){const[t,e]=this.getParentSize();this.right=t-this.width-this.left,this.bottom=e-this.height-this.top,this.parentWidth=t,this.parentHeight=e}},updateParentSize(){const[t,e]=this.getParentSize();this.parentWidth=t,this.parentHeight=e},getParentSize(){if(this.parent===!0){const t=window.getComputedStyle(this.$el.parentNode,null),e=this.$el.parentNode.getBoundingClientRect();return this.parentX=e.x,this.parentY=e.y,[Math.round(parseFloat(t.getPropertyValue("width"),10)),Math.round(parseFloat(t.getPropertyValue("height"),10))]}if(typeof this.parent=="string"){const t=document.querySelector(this.parent);if(!(t instanceof HTMLElement))throw new Error(`The selector ${this.parent} does not match any element`);return[t.offsetWidth,t.offsetHeight]}return[null,null]},elementTouchDown(t){pe=Xe.touch,this.elementDown(t)},elementMouseDown(t){pe=Xe.mouse,this.elementDown(t)},elementDown(t){if(t instanceof MouseEvent&&t.which!==1)return;const e=t.target||t.srcElement;if(this.$el.contains(e)){if(this.onDragStart(t)===!1)return;if(this.dragHandle&&!Ot(e,this.dragHandle,this.$el)||this.dragCancel&&Ot(e,this.dragCancel,this.$el)){this.dragging=!1;return}this.enabled||(this.enabled=!0,q(this,"activated"),q(this,"update:active",!0)),this.draggable&&(this.dragging=!0),this.mouseClickPosition.mouseX=t.touches?t.touches[0].pageX:t.pageX,this.mouseClickPosition.mouseY=t.touches?t.touches[0].pageY:t.pageY,this.mouseClickPosition.left=this.left,this.mouseClickPosition.right=this.right,this.mouseClickPosition.top=this.top,this.mouseClickPosition.bottom=this.bottom,this.mouseClickPosition.width=this.width,this.mouseClickPosition.height=this.height,this.parent&&(this.bounds=this.calcDragLimits()),Ve(document.documentElement,pe.move,this.move),Ve(document.documentElement,pe.stop,this.handleUp)}},calcDragLimits(){return this.rotatable?{minLeft:-this.width/2,maxLeft:this.parentWidth-this.width/2,minRight:this.width/2,maxRight:this.parentWidth+this.width/2,minTop:-this.height/2,maxTop:this.parentHeight-this.height/2,minBottom:this.height/2,maxBottom:this.parentHeight+this.height/2}:{minLeft:this.left%this.grid[0],maxLeft:Math.floor((this.parentWidth-this.width-this.left)/this.grid[0])*this.grid[0]+this.left,minRight:this.right%this.grid[0],maxRight:Math.floor((this.parentWidth-this.width-this.right)/this.grid[0])*this.grid[0]+this.right,minTop:this.top%this.grid[1],maxTop:Math.floor((this.parentHeight-this.height-this.top)/this.grid[1])*this.grid[1]+this.top,minBottom:this.bottom%this.grid[1],maxBottom:Math.floor((this.parentHeight-this.height-this.bottom)/this.grid[1])*this.grid[1]+this.bottom}},deselect(t){const e=t.target||t.srcElement,o=new RegExp(this.className+"-([trmbl]{2})","");!this.$el.contains(e)&&!o.test(e.className)&&(this.enabled&&!this.preventDeactivation&&(this.enabled=!1,q(this,"deactivated"),q(this,"update:active",!1)),he(document.documentElement,pe.move,this.move)),this.resetBoundsAndMouseState()},handleTouchDown(t,e){pe=Xe.touch,this.handleDown(t,e)},handleDown(t,e){if(e instanceof MouseEvent&&e.which!==1||this.onResizeStart(t,e)===!1)return!1;e.stopPropagation&&e.stopPropagation(),this.handle=t,this.handle==="rot"?this.rotating=!0:this.resizing=!0;let{top:o,left:a,width:n,height:l}=this.$el.getBoundingClientRect();this.lastCenterX=window.pageXOffset+a+n/2,this.lastCenterY=window.pageYOffset+o+l/2;let c=this.left,s=this.top,i=this.width,r=this.height,m=c+i/2,u=s+r/2,d=this.rotate;this.TL=Ne(m,u,c,s,d),this.TR=Ne(m,u,c+i,s,d),this.BL=Ne(m,u,c,s+r,d),this.BR=Ne(m,u,c+i,s+r,d),this.mouseClickPosition.mouseX=e.touches?e.touches[0].pageX:e.pageX,this.mouseClickPosition.mouseY=e.touches?e.touches[0].pageY:e.pageY,this.mouseClickPosition.left=this.left,this.mouseClickPosition.right=this.right,this.mouseClickPosition.top=this.top,this.mouseClickPosition.bottom=this.bottom,this.mouseClickPosition.width=this.width,this.mouseClickPosition.height=this.height,this.bounds=this.calcResizeLimits(),Ve(document.documentElement,pe.move,this.move),Ve(document.documentElement,pe.stop,this.handleUp)},calcResizeLimits(){let t=this.minW,e=this.minH,o=this.maxW,a=this.maxH;const[n,l]=this.grid,c=this.width,s=this.height,i=this.left,r=this.top,m=this.right,u=this.bottom;o=o-o%n,a=a-a%l;const d={minLeft:null,maxLeft:null,minTop:null,maxTop:null,minRight:null,maxRight:null,minBottom:null,maxBottom:null};return this.parent?(d.minLeft=i,d.maxLeft=i+Math.floor((c-t)/n),d.minTop=r,d.maxTop=r+Math.floor((s-e)/l),d.minRight=m,d.maxRight=m+Math.floor((c-t)/n),d.minBottom=u,d.maxBottom=u+Math.floor((s-e)/l),o&&(d.minLeft=Math.max(d.minLeft,this.parentWidth-m-o),d.minRight=Math.max(d.minRight,this.parentWidth-i-o)),a&&(d.minTop=Math.max(d.minTop,this.parentHeight-u-a),d.minBottom=Math.max(d.minBottom,this.parentHeight-r-a))):(d.minLeft=null,d.maxLeft=i+Math.floor(c-t),d.minTop=null,d.maxTop=r+Math.floor(s-e),d.minRight=null,d.maxRight=m+Math.floor(c-t),d.minBottom=null,d.maxBottom=u+Math.floor(s-e),o&&(d.minLeft=-(m+o),d.minRight=-(i+o)),a&&(d.minTop=-(u+a),d.minBottom=-(r+a)),this.lockAspectRatio&&o&&a&&(d.minLeft=Math.min(d.minLeft,-(m+o)),d.minTop=Math.min(d.minTop,-(a+u)),d.minRight=Math.min(d.minRight,-i-o),d.minBottom=Math.min(d.minBottom,-r-a))),d},move(t){this.resizing?this.handleResize(t):this.dragging?this.handleDrag(t):this.rotating&&this.handleRotate(t)},getMouseCoordinate(t){return t.type.indexOf("touch")!==-1?{x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY}:{x:t.pageX||t.clientX+document.documentElement.scrollLeft,y:t.pageY||t.clientY+document.documentElement.scrollTop}},handleRotate(t){const{x:e,y:o}=this.getMouseCoordinate(t),a=e-this.lastCenterX,n=o-this.lastCenterY;this.rotate=(sn(a,n)+90)%360,q(this,"rotating",this.rotate)},async handleDrag(t){const e=this.axis,o=this.grid,a=this.bounds,n=this.mouseClickPosition,l=e&&e!=="y"?n.mouseX-(t.touches?t.touches[0].pageX:t.pageX):0,c=e&&e!=="x"?n.mouseY-(t.touches?t.touches[0].pageY:t.pageY):0,[s,i]=Ue(o,l,c,this.scaleRatio),r=K(n.left-s,a.minLeft,a.maxLeft),m=K(n.top-i,a.minTop,a.maxTop);if(this.onDrag(r,m)===!1)return;const u=K(n.right+s,a.minRight,a.maxRight),d=K(n.bottom+i,a.minBottom,a.maxBottom);this.left=r,this.top=m,this.right=u,this.bottom=d,await this.snapCheck(),q(this,"dragging",this.left,this.top)},moveHorizontally(t){const[e]=Ue(this.grid,t,this.top,this.scale),o=K(e,this.bounds.minLeft,this.bounds.maxLeft);this.left=o,this.right=this.parentWidth-this.width-o},moveVertically(t){const[,e]=Ue(this.grid,this.left,t,this.scale),o=K(e,this.bounds.minTop,this.bounds.maxTop);this.top=o,this.bottom=this.parentHeight-this.height-o},handleResize(t){const e=this.handle,o=this.scaleRatio,{TL:a,TR:n,BL:l,BR:c}=this;let{x:s,y:i}=this.getMouseCoordinate(t);!this.rotatable&&this.parent&&(s=K(s,this.parentX,this.parentX+this.parentWidth*o),i=K(i,this.parentY,this.parentY+this.parentHeight*o));let r=s-this.mouseClickPosition.mouseX,m=i-this.mouseClickPosition.mouseY;r=r/o,m=m/o;let u,d,h,f,y,_,k,E,S,b={},x={},M={},p={},R={},O={},P={},U={};if(e.includes("m")){switch(e){case"tm":u=r+(a.x+n.x)/2,d=m+(a.y+n.y)/2,b=l,x=a,M=c,p={x:u-b.x,y:d-b.y},R={x:x.x-b.x,y:x.y-b.y},h=(p.x*R.x+p.y*R.y)/(Math.pow(R.x,2)+Math.pow(R.y,2)),P={x:M.x-b.x,y:M.y-b.y},U={x:R.x*h,y:R.y*h};break;case"bm":u=r+(l.x+c.x)/2,d=m+(l.y+c.y)/2,b=a,x=l,M=n,p={x:u-b.x,y:d-b.y},R={x:x.x-b.x,y:x.y-b.y},h=(p.x*R.x+p.y*R.y)/(Math.pow(R.x,2)+Math.pow(R.y,2)),P={x:M.x-b.x,y:M.y-b.y},U={x:R.x*h,y:R.y*h};break;case"ml":u=r+(a.x+l.x)/2,d=m+(a.y+l.y)/2,b=c,x=l,M=n,p={x:u-b.x,y:d-b.y},R={x:x.x-b.x,y:x.y-b.y},h=(p.x*R.x+p.y*R.y)/(Math.pow(R.x,2)+Math.pow(R.y,2)),U={x:M.x-b.x,y:M.y-b.y},P={x:R.x*h,y:R.y*h};break;case"mr":u=r+(n.x+n.x)/2,d=m+(n.y+n.y)/2,b=l,x=c,M=a,p={x:u-b.x,y:d-b.y},R={x:x.x-b.x,y:x.y-b.y},h=(p.x*R.x+p.y*R.y)/(Math.pow(R.x,2)+Math.pow(R.y,2)),U={x:M.x-b.x,y:M.y-b.y},P={x:R.x*h,y:R.y*h};break}_=b.x+(P.x+U.x)/2,k=b.y+(P.y+U.y)/2,E=Math.sqrt(Math.pow(P.x,2)+Math.pow(P.y,2)),S=Math.sqrt(Math.pow(U.x,2)+Math.pow(U.y,2))}else{switch(e){case"tl":u=r+a.x,d=m+a.y,b=c,x=l,M=n;break;case"tr":u=r+n.x,d=m+n.y,b=l,x=c,M=a;break;case"bl":u=r+l.x,d=m+l.y,b=n,x=a,M=c;break;case"br":u=r+c.x,d=m+c.y,b=a,x=n,M=l;break}p={x:u-b.x,y:d-b.y},R={x:x.x-b.x,y:x.y-b.y},O={x:M.x-b.x,y:M.y-b.y},f=(p.x*R.x+p.y*R.y)/(Math.pow(R.x,2)+Math.pow(R.y,2)),y=(p.x*O.x+p.y*O.y)/(Math.pow(O.x,2)+Math.pow(O.y,2)),P={x:R.x*f,y:R.y*f},U={x:O.x*y,y:O.y*y},_=b.x+(P.x+U.x)/2,k=b.y+(P.y+U.y)/2,E=Math.sqrt(Math.pow(P.x,2)+Math.pow(P.y,2)),S=Math.sqrt(Math.pow(U.x,2)+Math.pow(U.y,2))}this.left=_-E/2,this.top=k-S/2,E=K(E,this.minW||0,this.maxW),S=K(S,this.minH||0,this.maxH),this.parent&&(E=K(E,0,this.parentWidth),S=K(S,0,this.parentHeight)),this.lockAspectRatio&&(console.log(this.lockAspectRatio,this.aspectFactor),E/S>this.aspectFactor?E=S*this.aspectFactor:S=E/this.aspectFactor),this.width=E,this.height=S,q(this,"resizing",this.left,this.top,this.width,this.height)},changeWidth(t){const[e]=Ue(this.grid,t,0,this.scale),o=this.parentWidth-e-this.left;let a=this.bottom;this.lockAspectRatio&&(a=this.bottom-(this.right-o)/this.aspectFactor);const n=Et(this.parentWidth,this.left,o),l=Ut(this.parentHeight,this.top,a);this.right=o,this.bottom=a,this.width=n,this.height=l},changeHeight(t){const[,e]=Ue(this.grid,0,t,this.scale),o=this.parentHeight-e-this.top;let a=this.right;this.lockAspectRatio&&(a=this.right-(this.bottom-o)*this.aspectFactor);const n=Et(this.parentWidth,this.left,a),l=Ut(this.parentHeight,this.top,o);this.right=a,this.bottom=o,this.width=n,this.height=l},async handleUp(t){this.handle=null;const e=new Array(3).fill({display:!1,position:"",origin:"",lineLength:""}),o={vLine:[],hLine:[]};for(const l in o)o[l]=JSON.parse(JSON.stringify(e));const{x:a,y:n}=this.getMouseCoordinate(t);this.lastMouseX=a,this.lastMouseY=n,this.resizing&&(this.resizing=!1,await this.conflictCheck(),q(this,"refLineParams",o),q(this,"resizestop",this.left,this.top,this.width,this.height)),this.dragging&&(this.dragging=!1,await this.conflictCheck(),q(this,"refLineParams",o),q(this,"dragstop",this.left,this.top)),this.rotating&&(this.rotating=!1,q(this,"rotatestop",this.rotate)),this.resetBoundsAndMouseState(),he(document.documentElement,pe.move,this.move)},settingAttribute(){this.$el.setAttribute("data-is-check",`${this.isConflictCheck}`),this.$el.setAttribute("data-is-snap",`${this.snap}`)},conflictCheck(){const t=this.top,e=this.left,o=this.width,a=this.height;if(this.isConflictCheck){const n=this.$el.parentNode.childNodes;for(const l of n)if(l.className!==void 0&&!l.className.split(" ").includes(this.classNameActive)&&l.getAttribute("data-is-check")!==null&&l.getAttribute("data-is-check")!=="false"){const c=l.offsetWidth,s=l.offsetHeight,[i,r]=this.formatTransformVal(l.style.transform),m=t>=r&&e>=i&&r+s>t&&i+c>e||t<=r&&e<i&&t+a>r&&e+o>i,u=e<=i&&t>=r&&e+o>i&&t<r+s||t<r&&e>i&&t+a>r&&e<i+c,d=t<=r&&e>=i&&t+a>r&&e<i+c||t>=r&&e<=i&&t<r+s&&e>i+c,h=t<=r&&e>=i&&t+a>r&&e<i+c||t>=r&&e<=i&&t<r+s&&e>i+c,f=e>=i&&t>=r&&e<i+c&&t<r+s||t>r&&e<=i&&e+o>i&&t<r+s,y=t<=r&&e>=i&&t+a>r&&e<i+c||t>=r&&e<=i&&t<r+s&&e+o>i;(m||u||d||h||f||y)&&(this.top=this.mouseClickPosition.top,this.left=this.mouseClickPosition.left,this.width=this.mouseClickPosition.width,this.height=this.mouseClickPosition.height)}}},async snapCheck(){if(this.snap){let t=this.width,e=this.height,o=this.left,a=this.left+t,n=this.top,l=this.top+e;const c=new Array(3).fill({display:!1,position:"",origin:"",lineLength:""}),s={vLine:[],hLine:[]};for(const y in s)s[y]=JSON.parse(JSON.stringify(c));const i={value:{x:[[],[],[]],y:[[],[],[]]},display:[],position:[]},r=this.$el.parentNode.childNodes,{groupWidth:m,groupHeight:u,groupLeft:d,groupTop:h,bln:f}=await this.getActiveAll(r);f||(t=m,e=u,o=d,a=d+m,n=h,l=h+u);for(const y of r)if(y.className!==void 0&&!y.className.split(" ").includes(this.classNameActive)&&y.getAttribute("data-is-snap")!==null&&y.getAttribute("data-is-snap")!=="false"){const[_,k,E]=this.formatTransformVal(y.style.transform);if((E-this.rotate)%90===0){const S=y.offsetWidth,b=y.offsetHeight,x=_+S,M=k+b,p=Math.abs(n+e/2-(k+b/2))<=this.snapTolerance,R=Math.abs(o+t/2-(_+S/2))<=this.snapTolerance,O=Math.abs(k-l)<=this.snapTolerance,P=Math.abs(M-l)<=this.snapTolerance,U=Math.abs(k-n)<=this.snapTolerance,X=Math.abs(M-n)<=this.snapTolerance,fe=Math.abs(_-a)<=this.snapTolerance,_e=Math.abs(x-a)<=this.snapTolerance,we=Math.abs(_-o)<=this.snapTolerance,re=Math.abs(x-o)<=this.snapTolerance;i.display=[O,P,U,X,p,p,fe,_e,we,re,R,R],i.position=[k,M,k,M,k+b/2,k+b/2,_,x,_,x,_+S/2,_+S/2],f&&(O&&(this.top=k-e,this.bottom=this.parentHeight-this.top-e,i.value.y[0].push(_,x,o,a)),U&&(this.top=k,this.bottom=this.parentHeight-this.top-e,i.value.y[0].push(_,x,o,a)),P&&(this.top=M-e,this.bottom=this.parentHeight-this.top-e,i.value.y[1].push(_,x,o,a)),X&&(this.top=M,this.bottom=this.parentHeight-this.top-e,i.value.y[1].push(_,x,o,a)),fe&&(this.left=_-t,this.right=this.parentWidth-this.left-t,i.value.x[0].push(k,M,n,l)),we&&(this.left=_,this.right=this.parentWidth-this.left-t,i.value.x[0].push(k,M,n,l)),_e&&(this.left=x-t,this.right=this.parentWidth-this.left-t,i.value.x[1].push(k,M,n,l)),re&&(this.left=x,this.right=this.parentWidth-this.left-t,i.value.x[1].push(k,M,n,l)),p&&(this.top=k+b/2-e/2,this.bottom=this.parentHeight-this.top-e,i.value.y[2].push(_,x,o,a)),R&&(this.left=_+S/2-t/2,this.right=this.parentWidth-this.left-t,i.value.x[2].push(k,M,n,l)),this.snapBorder&&(Math.abs(this.left-0)<=this.snapTolerance&&(this.left=0,this.right=this.parentWidth-this.left-t),Math.abs(this.right-0)<=this.snapTolerance&&(this.right=0,this.left=this.parentWidth-this.width-this.right),Math.abs(this.top-0)<=this.snapTolerance&&(this.top=0,this.bottom=this.parentHeight-this.top-e),Math.abs(this.bottom-0)<=this.snapTolerance&&(this.bottom=0,this.top=this.parentHeight-this.bottom-e)));let ee=this.bounds;this.left=K(this.left,ee.minLeft,ee.maxLeft),this.top=K(this.top,ee.minTop,ee.maxTop),this.right=K(this.right,ee.minRight,ee.maxRight),this.bottom=K(this.bottom,ee.minBottom,ee.maxBottom);const se=[0,1,0,1,2,2,0,1,0,1,2,2];for(let V=0;V<=se.length;V++){const T=V<6?"y":"x",W=V<6?"hLine":"vLine";if(i.display[V]){const{origin:z,length:H}=this.calcLineValues(i.value[T][se[V]]);s[W][se[V]].display=i.display[V],s[W][se[V]].position=i.position[V]+"px",s[W][se[V]].origin=z,s[W][se[V]].lineLength=H}}}}q(this,"refLineParams",s)}},calcLineValues(t){const e=Math.max(...t)-Math.min(...t)+"px",o=Math.min(...t)+"px";return{length:e,origin:o}},async getActiveAll(t){const e=[],o=[],a=[];let n=0,l=0,c=0,s=0;for(const m of t)m.className!==void 0&&m.className.split(" ").includes(this.classNameActive)&&e.push(m);const i=e.length;if(i>1){for(const m of e){const u=m.offsetLeft,d=u+m.offsetWidth,h=m.offsetTop,f=h+m.offsetHeight;o.push(u,d),a.push(h,f)}n=Math.max(...o)-Math.min(...o),l=Math.max(...a)-Math.min(...a),c=Math.min(...o),s=Math.min(...a)}return{groupWidth:n,groupHeight:l,groupLeft:c,groupTop:s,bln:i===1}},formatTransformVal(t){let[e,o,a=0]=t.match(/[\d|.]+/g);return o===void 0&&(o=0),[Number(e),Number(o),a]}},emits:["update:active","rotating","dragging","resizing","refLineParams","resizestop","dragstop","rotatestop","activated","deactivated"]};const cn=["onMousedown","onTouchstart"];function fn(t,e,o,a,n,l){return C(),A("div",{style:Q(l.style),class:de([{[o.classNameActive]:t.enabled,[o.classNameDragging]:t.dragging,[o.classNameResizing]:t.resizing,[o.classNameDraggable]:o.draggable,[o.classNameResizable]:o.resizable,[o.classNameRotating]:t.rotating,[o.classNameRotatable]:o.rotatable},o.className]),onMousedown:e[0]||(e[0]=(...c)=>l.elementMouseDown&&l.elementMouseDown(...c)),onTouchstart:e[1]||(e[1]=(...c)=>l.elementTouchDown&&l.elementTouchDown(...c))},[(C(!0),A(Y,null,ae(l.actualHandles,(c,s)=>(C(),A("div",{key:s,class:de([o.classNameHandle,o.classNameHandle+"-"+c]),style:Q(l.handleStyle(c,s)),onMousedown:Me(i=>l.handleDown(c,i),["stop","prevent"]),onTouchstart:Me(i=>l.handleTouchDown(c,i),["stop","prevent"])},[Ye(t.$slots,c)],46,cn))),128)),Ye(t.$slots,"default")],38)}ze.render=fn;ze.__scopeId="data-v-3c286975";ze.__file="src/components/vue-drag-resize-rotate/index.vue";function nt(t){nt.installed||(nt.installed=!0,t.component("VueDragResizeRotate",ze))}ze.install=nt;const ct=sa(ln);ct.use(ca);ct.use(ze);ct.mount("#app");
