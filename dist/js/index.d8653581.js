import{G as B,a as L,ag as U,l as V,M as j,O as w,H as Ye,a5 as Qt,P as rt,p as $,K as be,S as N,T as se,V as Ut,d as ge,n as $e,m as z,F as J,a7 as le,I as de,J as te,u as g,a2 as Se,Q as Ie,b as Z,aw as ce,e as X,ax as Bt,r as Dt,X as Zt,g as ea,o as ta,s as Pt,Z as ue,c as aa,U as v,A as ve,z as Ke,Y as $t,R as me,ay as oa,az as la,E as na,as as ia}from"./base-module.a8b61ce6.js";import{E as Pe,d as sa,a as ra,c as da,i as ua}from"./element-plus.fccf1f22.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))a(l);new MutationObserver(l=>{for(const n of l)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function o(l){const n={};return l.integrity&&(n.integrity=l.integrity),l.referrerPolicy&&(n.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?n.credentials="include":l.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(l){if(l.ep)return;l.ep=!0;const n=o(l);fetch(l.href,n)}})();const ca=["accept"],lt=B({__name:"index",props:{accept:{default:""},maxSize:{default:1/0},text:{default:"上传文件"},preCheck:{}},emits:["change"],setup(t,{emit:e}){const o=t;let a=L("");const l=async c=>{var p,y;var r=((y=(p=c.target)==null?void 0:p.files)==null?void 0:y[0])??{};try{c.target.value=""}catch{}let i=r.name,d=r.size,f=o.maxSize,u=i.lastIndexOf("."),s=i.slice(u),h=o.accept.split(",");if(h.length>0&&h.indexOf(s)<=-1)return Pe.error("文件格式错误，请重新上传!"),!1;if(d>f)return Pe.error("文件不可大于10M");e("change",r)},n=async()=>{var r,i,d;if(o.preCheck){var c=await((r=o.preCheck)==null?void 0:r.call(o));if(!c)return}(d=(i=a.value).click)==null||d.call(i)};return(c,r)=>{const i=U("el-button");return V(),j(i,be({type:"primary",plain:"",onClick:n},c.$attrs),{default:w(()=>[Ye(c.$slots,"default",{},()=>[N(se(c.text),1)]),(V(),j(Qt,{to:"body"},[rt($("input",{type:"file",ref_key:"uploadRef",ref:a,onChange:l,accept:c.accept},null,40,ca),[[Ut,!1]])]))]),_:3},16)}}});(function(){try{if(typeof document<"u"){var t=document.createElement("style");t.appendChild(document.createTextNode(".group-wrap[data-v-a7d365c4]{position:absolute;left:0;top:0;width:100%;height:100}.group-wrap .group-item[data-v-a7d365c4]{position:absolute}.custom-image[data-v-51bcdfe3]{color:var(--35be3580);background-color:var(--7a3808fb);padding:var(--565e2eee);border-radius:var(--ca4fabd6)}.text-wrap[data-v-8233b39d]{height:100%;color:var(--46dd5ff7);background-color:var(--7f931c9c);padding:var(--c746d0b6);border-radius:var(--a4c36304);font-size:var(--522c9048);border:var(--27fc0faa);word-break:break-all}.text-wrap[data-v-b9e7c0b0]{color:var(--00cd0a69);background-color:var(--863570b8);padding:var(--cde924d2);border-radius:var(--31a3f24c);font-size:var(--7015a02a);border:var(--aedef5c6);word-break:break-all;white-space:var(--ba981f16);overflow:var(--58ddca96);text-overflow:var(--6b9be9da)}.icon-wrap[data-v-6b52c610]{color:var(--46bf371c);stroke:var(--46bf371c);fill:var(--5a1a592f);background-color:var(--1d6b7926);padding:var(--651f2d40);border-radius:var(--5f884d3a);font-size:var(--6f5fc4fe)}.icon-wrap.color-self[data-v-6b52c610] *{color:var(--46bf371c);stroke:var(--46bf371c);fill:var(--5a1a592f)}.img-scale-wrap[data-v-321d426b]{position:relative;width:100%;height:100%;color:var(--ef6c025e);background-color:var(--58f6c20c);padding:var(--351ce7ff);border-radius:var(--cc74ea38)}.img-scale-wrap .img-scale-reduce[data-v-321d426b]{position:absolute;overflow:hidden;width:100%;height:100%;transition:.1s}.img-scale-wrap .img-scale[data-v-321d426b]{display:block;position:absolute;width:100%;height:100%}.drag-editor-preivew-wrap[data-v-b2568ace]{width:100%;height:100%;min-width:200px;min-height:200px}.drag-editor-preivew[data-v-b2568ace]{width:100%;height:100%}.drag-editor-preivew[data-v-b2568ace] .handle{display:none!important}.preview-item-wrap[data-v-b2568ace]{touch-action:none;position:absolute;box-sizing:border-box;-webkit-user-select:none;user-select:none}")),document.head.appendChild(t)}}catch(e){console.error("vite-plugin-css-injected-by-js",e)}})();const fa=Object.freeze(Object.defineProperty({__proto__:null,get default(){return Be}},Symbol.toStringTag,{value:"Module"}));function He(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>(t==="x"?Math.random()*16|0:"r&0x3"|"0x8").toString(16))}const It=(t,e)=>{let o=t.self,a=o.activeValue,l=o.prop,n=o.activeMode,c=o.activeMap;if(!l||!n||!c)return o;let r=!1;switch(n){case"大于":e[l]>a&&(r=!0);break;case"小于":e[l]<a&&(r=!0);break;case"等于":e[l]==a&&(r=!0);break;case"不等于":e[l]!=a&&(r=!0);break;case"大于等于":e[l]>=a&&(r=!0);break;case"小于等于":e[l]<a&&(r=!0);break;case"存在":e[l]!==void 0&&e[l]!==null&&(r=!0);break;case"不存在":e[l]===void 0&&e[l]===null&&(r=!0);break}let i={};return r&&(i=ha(c,e)),{...o,...i}},ha=(t,e)=>{let o={},a=/\$\{(.*?)\}/g;try{o=JSON.parse(t);for(var l in o){let n=o[l];if(a.test(n)){let c=n.replace(/[\$|{|}]/g,"");o[l]=(e==null?void 0:e[c])??void 0}}}catch(n){console.error("解析 activeMap 失败",n)}return o},pa={class:"group-wrap"},ma=["a"],ga=B({__name:"index",props:{data:{},modelValue:{default:()=>({})},groupModel:{default:()=>({})},disabled:{type:Boolean}},setup(t){const e=t,o=n=>Wt(n).default,a=n=>({width:n.w=="auto"?n.w:n.w+"px",height:n.h=="auto"?n.h:n.h+"px",transform:`translate(${n.x}px, ${n.y}px) rotate(${n.r||0}deg)`}),l=n=>It(n,e.groupModel);return(n,c)=>(V(),z("div",pa,[(V(!0),z(J,null,le(n.data.group,r=>(V(),z("div",{a:r.active,class:"group-item",style:te(a(r))},[(V(),j(Ie(o(r.self.name)),be({data:r,h:r.h,w:r.w},l(r),{modelValue:n.groupModel[r.self.modelValue],"onUpdate:modelValue":i=>n.groupModel[r.self.modelValue]=i,defaultModelValue:r.self.defaultModelValue,"onUpdate:defaultModelValue":i=>r.self.defaultModelValue=i,disabled:!0}),null,16,["data","h","w","modelValue","onUpdate:modelValue","defaultModelValue","onUpdate:defaultModelValue"]))],12,ma))),256))]))}}),Ce=(t,e)=>{const o=t.__vccOpts||t;for(const[a,l]of e)o[a]=l;return o},va=Ce(ga,[["__scopeId","data-v-a7d365c4"]]),ba=Object.freeze(Object.defineProperty({__proto__:null,default:va},Symbol.toStringTag,{value:"Module"})),ya=["width","height","src"],_a=B({__name:"index",props:{url:{},w:{},h:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""}},setup(t){const e=t;ce(a=>({"35be3580":a.color,"7a3808fb":a.bgColor,"565e2eee":a.padding,ca4fabd6:a.radius})),Z(()=>[e.w,e.h],()=>o()),ge(()=>{o()});const o=()=>{};return(a,l)=>(V(),z("img",{class:"custom-image",width:a.w,height:a.h,src:a.url,alt:""},null,8,ya))}}),wa=Ce(_a,[["__scopeId","data-v-51bcdfe3"]]),xa=Object.freeze(Object.defineProperty({__proto__:null,default:wa},Symbol.toStringTag,{value:"Module"})),Va=B({__name:"index",props:{url:{},w:{},h:{},flip:{}},setup(t){const e=t;let o=L(),a="",l=!0,n="";Z(()=>[e.w,e.h],()=>c()),Z(()=>{var i,d;return[(i=e.flip)==null?void 0:i.horizontal,(d=e.flip)==null?void 0:d.vertical]},()=>r()),ge(()=>{a=o.value.getContext("2d"),c()});const c=()=>{let i=e.w,d=e.h;o.value.width=i,o.value.height=d,l?(l=!1,n=document.createElement("img"),n.src=e.url,n.onload=()=>{a.drawImage(n,0,0,i,d),r()}):r()},r=()=>{const{vertical:i,horizontal:d}=e.flip??{};let f=e.w,u=e.h;const s=d?-1:1,h=i?-1:1;a.clearRect(0,0,f,u),a.translate(f/2-f*s/2,u/2-u*h/2),a.scale(s,h),a.drawImage(n,0,0,f,u),a.setTransform(1,0,0,1,0,0)};return(i,d)=>(V(),z("canvas",{ref_key:"canvas",ref:o},null,512))}}),Ma=Object.freeze(Object.defineProperty({__proto__:null,default:Va},Symbol.toStringTag,{value:"Module"})),Sa={class:"text-wrap"},Ca=B({__name:"index",props:{modelValue:{default:""},defaultModelValue:{default:""},data:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""},fontSize:{default:""},borderColor:{default:""},w:{},h:{}},setup(t){return ce(e=>({"46dd5ff7":e.color,"7f931c9c":e.bgColor,c746d0b6:e.padding,a4c36304:e.radius,"522c9048":e.fontSize,"27fc0faa":e.borderColor})),(e,o)=>(V(),z("div",Sa,se(e.modelValue||e.defaultModelValue),1))}}),ka=Ce(Ca,[["__scopeId","data-v-8233b39d"]]),Ra=Object.freeze(Object.defineProperty({__proto__:null,default:ka},Symbol.toStringTag,{value:"Module"})),Aa=["contenteditable"],za=B({__name:"index",props:{modelValue:{default:""},defaultModelValue:{},data:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""},fontSize:{default:""},borderColor:{default:""},w:{},h:{},noWordWrap:{type:Boolean,default:!1},overEllipsis:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},hasModelValue:{type:Boolean}},emits:["update:modelValue","update:defaultModelValue","click"],setup(t,{emit:e}){const o=t;ce(d=>({"00cd0a69":d.color,"863570b8":d.bgColor,cde924d2:d.padding,"31a3f24c":d.radius,"7015a02a":d.fontSize,aedef5c6:d.borderColor,ba981f16:d.noWordWrap?"nowrap":"","58ddca96":d.overEllipsis?"hidden":"auto","6b9be9da":d.overEllipsis?"ellipsis":"unset"}));let a=L(!1),l=L();const n=async()=>{o.disabled||(a.value=!0,c(l.value),await $e(),l.value.focus())},c=d=>{const f=window.getSelection(),u=document.createRange();u.selectNodeContents(d),f.removeAllRanges(),f.addRange(u)},r=()=>{a.value=!1},i=d=>{o.hasModelValue&&e("update:modelValue",d.target.innerText),e("update:defaultModelValue",d.target.innerText)};return(d,f)=>(V(),z("div",{contenteditable:g(a),onBlur:r,onInput:i,ref_key:"text",ref:l,class:de({"text-wrap":!0,"can-edit":g(a)}),onDblclick:n},se(d.modelValue||d.defaultModelValue),43,Aa))}}),Ta=Ce(za,[["__scopeId","data-v-b9e7c0b0"]]),La=Object.freeze(Object.defineProperty({__proto__:null,default:Ta},Symbol.toStringTag,{value:"Module"})),Ha=["innerHTML"],Ea=B({__name:"index",props:{url:{},color:{default:""},bgColor:{default:""},fillColor:{default:""},padding:{default:""},radius:{default:""},fontSize:{default:""},iconUseSelfColor:{type:Boolean}},setup(t){return ce(e=>({"46bf371c":e.color,"5a1a592f":e.fillColor,"1d6b7926":e.bgColor,"651f2d40":e.padding,"5f884d3a":e.radius,"6f5fc4fe":e.fontSize})),(e,o)=>(V(),z("div",{class:de({"icon-wrap":!0,"color-self":e.iconUseSelfColor}),innerHTML:e.url},null,10,Ha))}}),Oa=Ce(Ea,[["__scopeId","data-v-6b52c610"]]),Ua=Object.freeze(Object.defineProperty({__proto__:null,default:Oa},Symbol.toStringTag,{value:"Module"})),Ba={class:"img-scale-wrap"},Da=["src"],Pa=B({__name:"index",props:{url:{},w:{},h:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""},lockAspectRatio:{type:Boolean,default:!1},position:{default:"left"},imgWidth:{},imgHeight:{}},setup(t){const e=t;ce(l=>({ef6c025e:l.color,"58f6c20c":l.bgColor,"351ce7ff":l.padding,cc74ea38:l.radius}));let o=X(()=>({[e.position]:0,width:e.imgWidth,height:e.imgHeight})),a=X(()=>({[e.position]:0,width:e.lockAspectRatio?e.w+"px":void 0,height:e.lockAspectRatio?e.h+"px":void 0}));return(l,n)=>(V(),z("div",Ba,[$("div",{class:"img-scale-reduce",style:te(g(o))},[$("img",{class:"img-scale",src:l.url,alt:"",style:te(g(a))},null,12,Da)],4)]))}}),$a=Ce(Pa,[["__scopeId","data-v-321d426b"]]),Ia=Object.freeze(Object.defineProperty({__proto__:null,default:$a},Symbol.toStringTag,{value:"Module"}));let Wa=Object.assign({"./Group/index.vue":ba,"./Image/index.vue":xa,"./Picture/index.vue":Ma,"./Shape/index.vue":Ra,"./Text/index.vue":La,"./icon-svg/index.vue":Ua,"./img-scale/index.vue":Ia,"./preview/index.vue":fa});const Wt=t=>Wa[`./${t}/index.vue`];He(),He(),He(),He(),He();const Na=B({name:"dragPannelPreview"}),ja=B({...Na,props:{pannel:{},modelValue:{default:()=>({})},disabled:{type:Boolean,default:!1},parentWidth:{default:0}},emits:["click"],setup(t,{emit:e}){const o=t;let a=L(),l=L({});ge(()=>{c()});const n=u=>({width:u.w==="auto"?u.w:u.w+"px",height:u.h==="auto"?u.h:u.h+"px",fontSize:o.pannel.fontSize||u.fontSize,zIndex:u.z||"auto",transform:`translate(${u.x||0}px, ${u.y||0}px) rotate(${u.r||0}deg)`}),c=async()=>{await $e();let u={transformOrigin:"0% 0%",width:o.pannel.width+"px",height:o.pannel.height+"px",color:o.pannel.color,fontSize:o.pannel.fontSize,backgroundColor:o.pannel.bgColor},s=a.value.getBoundingClientRect(),{endRate:h,translateX:p,translateY:y}=r(s.width,s.height);l.value={...u,transform:`translate(${p}px, ${y}px) scale(${h})`}},r=(u,s)=>{let h=u/o.pannel.width,p=s/o.pannel.height,y=h>p?p:h,_=h<=p?0:u*y,C=p<=h?0:s*y;return{endRate:y,translateX:_>0?u/2-o.pannel.width/2*y:_,translateY:C>0?s/2-o.pannel.height/2*y:C}},i=u=>Wt(u).default,d=u=>{u.self.click&&(console.log("click"),e("click",u))},f=u=>It(u,o.modelValue);return(u,s)=>(V(),z("div",{ref_key:"wrapRef",ref:a,class:"drag-editor-preivew-wrap"},[$("div",{class:de({"drag-editor-preivew":!0}),style:te(g(l))},[(V(!0),z(J,null,le(u.pannel.components,h=>(V(),z("div",{class:"preview-item-wrap",style:te(n(h))},[(V(),j(Ie(i(h.self.name)),be({data:h,h:h.h,w:h.w},f(h),{onClickCapture:Se(p=>d(h),["self"]),modelValue:u.modelValue[h.self.modelValue],"onUpdate:modelValue":p=>u.modelValue[h.self.modelValue]=p,defaultModelValue:h.self.defaultModelValue,"onUpdate:defaultModelValue":p=>h.self.defaultModelValue=p,groupModel:u.modelValue,disabled:!0}),null,16,["data","h","w","onClickCapture","modelValue","onUpdate:modelValue","defaultModelValue","onUpdate:defaultModelValue","groupModel"]))],4))),256))],4)],512))}}),Be=Ce(ja,[["__scopeId","data-v-b2568ace"]]);Be.install=t=>{t.component(Be.name,Be)};let Nt={snap:!0,snapTolerance:5,parent:!0,debug:!1,rotatable:!0,r:0,active:!1,preventDeactivation:!1,resizable:!0,lockAspectRatio:!0},De=L(1);L(500);L(1200);function re(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>(t==="x"?Math.random()*16|0:"r&0x3"|"0x8").toString(16))}const dt=(t,e)=>{let o=t.self,a=o.activeValue,l=o.prop,n=o.activeMode,c=o.activeMap;if(!l||!n||!c)return o;let r=!1;switch(n){case"大于":e[l]>a&&(r=!0);break;case"小于":e[l]<a&&(r=!0);break;case"等于":e[l]==a&&(r=!0);break;case"不等于":e[l]!=a&&(r=!0);break;case"大于等于":e[l]>=a&&(r=!0);break;case"小于等于":e[l]<a&&(r=!0);break;case"存在":e[l]!==void 0&&e[l]!==null&&(r=!0);break;case"不存在":e[l]===void 0&&e[l]===null&&(r=!0);break}let i={};return r&&(i=Fa(c,e)),{...o,...i}},Fa=(t,e)=>{let o={},a=/\$\{(.*?)\}/g;try{o=JSON.parse(t);for(var l in o){let n=o[l];if(a.test(n)){let c=n.replace(/[\$|{|}]/g,"");o[l]=(e==null?void 0:e[c])??void 0}}}catch(n){console.error("解析 activeMap 失败",n)}return o},Xa=t=>{let e,o,a,l;return t.forEach(n=>{let c=(parseFloat(n.fontSize)||16)/2,r=32,i=parseFloat(n.x),d=parseFloat(n.y),f=n.h==="auto"?c:parseFloat(n.h)||c,u=n.w==="auto"?r:parseFloat(n.w)||r;(e===void 0||i<e)&&(e=i),(o===void 0||i+u>o)&&(o=i+u),(a===void 0||d<a)&&(a=d),(l===void 0||d+f>l)&&(l=d+f)}),{left:e,right:o,top:a,bottom:l}},ut=(t,e)=>{for(let o of Object.keys(t))t[o]=(e==null?void 0:e[o])??t[o]};function Ya(t,e){let o,a,l;const n=L(!0),c=()=>{n.value=!0,l()};Z(t,c,{flush:"sync"});const r=typeof e=="function"?e:e.get,i=typeof e=="function"?void 0:e.set,d=Bt((f,u)=>(a=f,l=u,{get(){return n.value&&(o=r(),n.value=!1),a(),o},set(s){i==null||i(s)}}));return Object.isExtensible(d)&&(d.trigger=c),d}function qe(t){return ea()?(ta(t),!0):!1}function oe(t){return typeof t=="function"?t():g(t)}const Ae=typeof window<"u"&&typeof document<"u",Ja=Object.prototype.toString,jt=t=>Ja.call(t)==="[object Object]",Re=()=>{},nt=Ga();function Ga(){var t;return Ae&&((t=window==null?void 0:window.navigator)==null?void 0:t.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent)}const wt={mounted:"mounted",updated:"updated",unmounted:"unmounted"};function Ka(...t){if(t.length!==1)return Zt(...t);const e=t[0];return typeof e=="function"?Dt(Bt(()=>({get:e,set:Re}))):L(e)}function qa(t,e,o={}){const{immediate:a=!0}=o,l=L(!1);let n=null;function c(){n&&(clearTimeout(n),n=null)}function r(){l.value=!1,c()}function i(...d){c(),l.value=!0,n=setTimeout(()=>{l.value=!1,n=null,t(...d)},oe(e))}return a&&(l.value=!0,Ae&&i()),qe(r),{isPending:Dt(l),start:i,stop:r}}function et(t,e,o){return Z(t,(a,l,n)=>{a&&e(a,l,n)},o)}function Qa(t){var e;const o=oe(t);return(e=o==null?void 0:o.$el)!=null?e:o}const Qe=Ae?window:void 0,Za=Ae?window.navigator:void 0;function ie(...t){let e,o,a,l;if(typeof t[0]=="string"||Array.isArray(t[0])?([o,a,l]=t,e=Qe):[e,o,a,l]=t,!e)return Re;Array.isArray(o)||(o=[o]),Array.isArray(a)||(a=[a]);const n=[],c=()=>{n.forEach(f=>f()),n.length=0},r=(f,u,s,h)=>(f.addEventListener(u,s,h),()=>f.removeEventListener(u,s,h)),i=Z(()=>[Qa(e),oe(l)],([f,u])=>{if(c(),!f)return;const s=jt(u)?{...u}:u;n.push(...o.flatMap(h=>a.map(p=>r(f,h,p,s))))},{immediate:!0,flush:"post"}),d=()=>{i(),c()};return qe(d),d}function eo(t){return typeof t=="function"?t:typeof t=="string"?e=>e.key===t:Array.isArray(t)?e=>t.includes(e.key):()=>!0}function We(...t){let e,o,a={};t.length===3?(e=t[0],o=t[1],a=t[2]):t.length===2?typeof t[1]=="object"?(e=!0,o=t[0],a=t[1]):(e=t[0],o=t[1]):(e=!0,o=t[0]);const{target:l=Qe,eventName:n="keydown",passive:c=!1,dedupe:r=!1}=a,i=eo(e);return ie(l,n,f=>{f.repeat&&oe(r)||i(f)&&o(f)},c)}function to(t={}){var e;const{window:o=Qe,deep:a=!0}=t,l=(e=t.document)!=null?e:o==null?void 0:o.document,n=()=>{var r;let i=l==null?void 0:l.activeElement;if(a)for(;i!=null&&i.shadowRoot;)i=(r=i==null?void 0:i.shadowRoot)==null?void 0:r.activeElement;return i},c=Ya(()=>null,()=>n());return o&&(ie(o,"blur",r=>{r.relatedTarget===null&&c.trigger()},!0),ie(o,"focus",c.trigger,!0)),c}function ao(){const t=L(!1);return aa()&&ge(()=>{t.value=!0}),t}function oo(t){const e=ao();return X(()=>(e.value,!!t()))}function lo(t={}){const{navigator:e=Za,read:o=!1,source:a,copiedDuring:l=1500,legacy:n=!1}=t,c=oo(()=>e&&"clipboard"in e),r=X(()=>c.value||n),i=L(""),d=L(!1),f=qa(()=>d.value=!1,l);function u(){c.value?e.clipboard.readText().then(y=>{i.value=y}):i.value=p()}r.value&&o&&ie(["copy","cut"],u);async function s(y=oe(a)){r.value&&y!=null&&(c.value?await e.clipboard.writeText(y):h(y),i.value=y,d.value=!0,f.start())}function h(y){const _=document.createElement("textarea");_.value=y??"",_.style.position="absolute",_.style.opacity="0",document.body.appendChild(_),_.select(),document.execCommand("copy"),_.remove()}function p(){var y,_,C;return(C=(_=(y=document==null?void 0:document.getSelection)==null?void 0:y.call(document))==null?void 0:_.toString())!=null?C:""}return{isSupported:r,text:i,copied:d,copy:s}}function no(t,e={}){const o=L(!1),a=Pt(null);let l=0;if(Ae){const n=typeof e=="function"?{onDrop:e}:e,c=r=>{var i,d;const f=Array.from((d=(i=r.dataTransfer)==null?void 0:i.files)!=null?d:[]);return a.value=f.length===0?null:f};ie(t,"dragenter",r=>{var i;r.preventDefault(),l+=1,o.value=!0,(i=n.onEnter)==null||i.call(n,c(r),r)}),ie(t,"dragover",r=>{var i;r.preventDefault(),(i=n.onOver)==null||i.call(n,c(r),r)}),ie(t,"dragleave",r=>{var i;r.preventDefault(),l-=1,l===0&&(o.value=!1),(i=n.onLeave)==null||i.call(n,c(r),r)}),ie(t,"drop",r=>{var i;r.preventDefault(),l=0,o.value=!1,(i=n.onDrop)==null||i.call(n,c(r),r)})}return{files:a,isOverDropZone:o}}const io={ctrl:"control",command:"meta",cmd:"meta",option:"alt",up:"arrowup",down:"arrowdown",left:"arrowleft",right:"arrowright"};function so(t={}){const{reactive:e=!1,target:o=Qe,aliasMap:a=io,passive:l=!0,onEventFired:n=Re}=t,c=ue(new Set),r={toJSON(){return{}},current:c},i=e?ue(r):r,d=new Set,f=new Set;function u(y,_){y in i&&(e?i[y]=_:i[y].value=_)}function s(){c.clear();for(const y of f)u(y,!1)}function h(y,_){var C,H;const S=(C=y.key)==null?void 0:C.toLowerCase(),x=[(H=y.code)==null?void 0:H.toLowerCase(),S].filter(Boolean);S&&(_?c.add(S):c.delete(S));for(const k of x)f.add(k),u(k,_);S==="meta"&&!_?(d.forEach(k=>{c.delete(k),u(k,!1)}),d.clear()):typeof y.getModifierState=="function"&&y.getModifierState("Meta")&&_&&[...c,...x].forEach(k=>d.add(k))}ie(o,"keydown",y=>(h(y,!0),n(y)),{passive:l}),ie(o,"keyup",y=>(h(y,!1),n(y)),{passive:l}),ie("blur",s,{passive:!0}),ie("focus",s,{passive:!0});const p=new Proxy(i,{get(y,_,C){if(typeof _!="string")return Reflect.get(y,_,C);if(_=_.toLowerCase(),_ in a&&(_=a[_]),!(_ in i))if(/[+_-]/.test(_)){const S=_.split(/[+_-]/g).map(b=>b.trim());i[_]=X(()=>S.every(b=>oe(p[b])))}else i[_]=L(!1);const H=Reflect.get(y,_,C);return e?oe(H):H}});return p}/*!
 * Compressor.js v1.2.1
 * https://fengyuanchen.github.io/compressorjs
 *
 * Copyright 2018-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2023-02-28T14:09:41.732Z
 */function xt(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),o.push.apply(o,a)}return o}function Ne(t){for(var e=1;e<arguments.length;e++){var o=arguments[e]!=null?arguments[e]:{};e%2?xt(Object(o),!0).forEach(function(a){co(t,a,o[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):xt(Object(o)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(o,a))})}return t}function ro(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Vt(t,e){for(var o=0;o<e.length;o++){var a=e[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,Ft(a.key),a)}}function uo(t,e,o){return e&&Vt(t.prototype,e),o&&Vt(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function co(t,e,o){return e=Ft(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Je(){return Je=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(t[a]=o[a])}return t},Je.apply(this,arguments)}function fo(t,e){if(typeof t!="object"||t===null)return t;var o=t[Symbol.toPrimitive];if(o!==void 0){var a=o.call(t,e||"default");if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ft(t){var e=fo(t,"string");return typeof e=="symbol"?e:String(e)}var Xt={exports:{}};(function(t){typeof window>"u"||function(e){var o=e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype,a=e.Blob&&function(){try{return!!new Blob}catch{return!1}}(),l=a&&e.Uint8Array&&function(){try{return new Blob([new Uint8Array(100)]).size===100}catch{return!1}}(),n=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,c=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,r=(a||n)&&e.atob&&e.ArrayBuffer&&e.Uint8Array&&function(i){var d,f,u,s,h,p,y,_,C;if(d=i.match(c),!d)throw new Error("invalid data URI");for(f=d[2]?d[1]:"text/plain"+(d[3]||";charset=US-ASCII"),u=!!d[4],s=i.slice(d[0].length),u?h=atob(s):h=decodeURIComponent(s),p=new ArrayBuffer(h.length),y=new Uint8Array(p),_=0;_<h.length;_+=1)y[_]=h.charCodeAt(_);return a?new Blob([l?y:p],{type:f}):(C=new n,C.append(p),C.getBlob(f))};e.HTMLCanvasElement&&!o.toBlob&&(o.mozGetAsFile?o.toBlob=function(i,d,f){var u=this;setTimeout(function(){f&&o.toDataURL&&r?i(r(u.toDataURL(d,f))):i(u.mozGetAsFile("blob",d))})}:o.toDataURL&&r&&(o.msToBlob?o.toBlob=function(i,d,f){var u=this;setTimeout(function(){(d&&d!=="image/png"||f)&&o.toDataURL&&r?i(r(u.toDataURL(d,f))):i(u.msToBlob(d))})}:o.toBlob=function(i,d,f){var u=this;setTimeout(function(){i(r(u.toDataURL(d,f)))})})),t.exports?t.exports=r:e.dataURLtoBlob=r}(window)})(Xt);var Mt=Xt.exports,ho=function(e){return typeof Blob>"u"?!1:e instanceof Blob||Object.prototype.toString.call(e)==="[object Blob]"},St={strict:!0,checkOrientation:!0,retainExif:!1,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},po=typeof window<"u"&&typeof window.document<"u",ye=po?window:{},Ge=function(e){return e>0&&e<1/0},mo=Array.prototype.slice;function ct(t){return Array.from?Array.from(t):mo.call(t)}var go=/^image\/.+$/;function it(t){return go.test(t)}function vo(t){var e=it(t)?t.substr(6):"";return e==="jpeg"&&(e="jpg"),".".concat(e)}var Yt=String.fromCharCode;function bo(t,e,o){var a="",l;for(o+=e,l=e;l<o;l+=1)a+=Yt(t.getUint8(l));return a}var yo=ye.btoa;function Ct(t,e){for(var o=[],a=8192,l=new Uint8Array(t);l.length>0;)o.push(Yt.apply(null,ct(l.subarray(0,a)))),l=l.subarray(a);return"data:".concat(e,";base64,").concat(yo(o.join("")))}function _o(t){var e=new DataView(t),o;try{var a,l,n;if(e.getUint8(0)===255&&e.getUint8(1)===216)for(var c=e.byteLength,r=2;r+1<c;){if(e.getUint8(r)===255&&e.getUint8(r+1)===225){l=r;break}r+=1}if(l){var i=l+4,d=l+10;if(bo(e,i,4)==="Exif"){var f=e.getUint16(d);if(a=f===18761,(a||f===19789)&&e.getUint16(d+2,a)===42){var u=e.getUint32(d+4,a);u>=8&&(n=d+u)}}}if(n){var s=e.getUint16(n,a),h,p;for(p=0;p<s;p+=1)if(h=n+p*12+2,e.getUint16(h,a)===274){h+=8,o=e.getUint16(h,a),e.setUint16(h,1,a);break}}}catch{o=1}return o}function wo(t){var e=0,o=1,a=1;switch(t){case 2:o=-1;break;case 3:e=-180;break;case 4:a=-1;break;case 5:e=90,a=-1;break;case 6:e=90;break;case 7:e=90,o=-1;break;case 8:e=-90;break}return{rotate:e,scaleX:o,scaleY:a}}var xo=/\.\d*(?:0|9){12}\d*$/;function kt(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return xo.test(t)?Math.round(t*e)/e:t}function Ee(t){var e=t.aspectRatio,o=t.height,a=t.width,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"none",n=Ge(a),c=Ge(o);if(n&&c){var r=o*e;(l==="contain"||l==="none")&&r>a||l==="cover"&&r<a?o=a/e:a=o*e}else n?o=a/e:c&&(a=o*e);return{width:a,height:o}}function Vo(t){for(var e=ct(new Uint8Array(t)),o=e.length,a=[],l=0;l+3<o;){var n=e[l],c=e[l+1];if(n===255&&c===218)break;if(n===255&&c===216)l+=2;else{var r=e[l+2]*256+e[l+3],i=l+r+2,d=e.slice(l,i);a.push(d),l=i}}return a.reduce(function(f,u){return u[0]===255&&u[1]===225?f.concat(u):f},[])}function Mo(t,e){var o=ct(new Uint8Array(t));if(o[2]!==255||o[3]!==224)return t;var a=o[4]*256+o[5],l=[255,216].concat(e,o.slice(4+a));return new Uint8Array(l)}var So=ye.ArrayBuffer,tt=ye.FileReader,Ve=ye.URL||ye.webkitURL,Co=/\.\w+$/,ko=ye.Compressor,Ro=function(){function t(e,o){ro(this,t),this.file=e,this.exif=[],this.image=new Image,this.options=Ne(Ne({},St),o),this.aborted=!1,this.result=null,this.init()}return uo(t,[{key:"init",value:function(){var o=this,a=this.file,l=this.options;if(!ho(a)){this.fail(new Error("The first argument must be a File or Blob object."));return}var n=a.type;if(!it(n)){this.fail(new Error("The first argument must be an image File or Blob object."));return}if(!Ve||!tt){this.fail(new Error("The current browser does not support image compression."));return}So||(l.checkOrientation=!1,l.retainExif=!1);var c=n==="image/jpeg",r=c&&l.checkOrientation,i=c&&l.retainExif;if(Ve&&!r&&!i)this.load({url:Ve.createObjectURL(a)});else{var d=new tt;this.reader=d,d.onload=function(f){var u=f.target,s=u.result,h={},p=1;r&&(p=_o(s),p>1&&Je(h,wo(p))),i&&(o.exif=Vo(s)),r||i?!Ve||p>1?h.url=Ct(s,n):h.url=Ve.createObjectURL(a):h.url=s,o.load(h)},d.onabort=function(){o.fail(new Error("Aborted to read the image with FileReader."))},d.onerror=function(){o.fail(new Error("Failed to read the image with FileReader."))},d.onloadend=function(){o.reader=null},r||i?d.readAsArrayBuffer(a):d.readAsDataURL(a)}}},{key:"load",value:function(o){var a=this,l=this.file,n=this.image;n.onload=function(){a.draw(Ne(Ne({},o),{},{naturalWidth:n.naturalWidth,naturalHeight:n.naturalHeight}))},n.onabort=function(){a.fail(new Error("Aborted to load the image."))},n.onerror=function(){a.fail(new Error("Failed to load the image."))},ye.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(ye.navigator.userAgent)&&(n.crossOrigin="anonymous"),n.alt=l.name,n.src=o.url}},{key:"draw",value:function(o){var a=this,l=o.naturalWidth,n=o.naturalHeight,c=o.rotate,r=c===void 0?0:c,i=o.scaleX,d=i===void 0?1:i,f=o.scaleY,u=f===void 0?1:f,s=this.file,h=this.image,p=this.options,y=document.createElement("canvas"),_=y.getContext("2d"),C=Math.abs(r)%180===90,H=(p.resize==="contain"||p.resize==="cover")&&Ge(p.width)&&Ge(p.height),S=Math.max(p.maxWidth,0)||1/0,b=Math.max(p.maxHeight,0)||1/0,x=Math.max(p.minWidth,0)||0,k=Math.max(p.minHeight,0)||0,m=l/n,R=p.width,E=p.height;if(C){var P=[b,S];S=P[0],b=P[1];var O=[k,x];x=O[0],k=O[1];var F=[E,R];R=F[0],E=F[1]}H&&(m=R/E);var fe=Ee({aspectRatio:m,width:S,height:b},"contain");S=fe.width,b=fe.height;var _e=Ee({aspectRatio:m,width:x,height:k},"cover");if(x=_e.width,k=_e.height,H){var we=Ee({aspectRatio:m,width:R,height:E},p.resize);R=we.width,E=we.height}else{var xe=Ee({aspectRatio:m,width:R,height:E}),K=xe.width;R=K===void 0?l:K;var ne=xe.height;E=ne===void 0?n:ne}R=Math.floor(kt(Math.min(Math.max(R,x),S))),E=Math.floor(kt(Math.min(Math.max(E,k),b)));var q=-R/2,M=-E/2,T=R,Y=E,A=[];if(H){var D=0,I=0,ae=l,W=n,pt=Ee({aspectRatio:m,width:l,height:n},{contain:"cover",cover:"contain"}[p.resize]);ae=pt.width,W=pt.height,D=(l-ae)/2,I=(n-W)/2,A.push(D,I,ae,W)}if(A.push(q,M,T,Y),C){var mt=[E,R];R=mt[0],E=mt[1]}y.width=R,y.height=E,it(p.mimeType)||(p.mimeType=s.type);var gt="transparent";s.size>p.convertSize&&p.convertTypes.indexOf(p.mimeType)>=0&&(p.mimeType="image/jpeg");var vt=p.mimeType==="image/jpeg";if(vt&&(gt="#fff"),_.fillStyle=gt,_.fillRect(0,0,R,E),p.beforeDraw&&p.beforeDraw.call(this,_,y),!this.aborted&&(_.save(),_.translate(R/2,E/2),_.rotate(r*Math.PI/180),_.scale(d,u),_.drawImage.apply(_,[h].concat(A)),_.restore(),p.drew&&p.drew.call(this,_,y),!this.aborted)){var bt=function(Te){if(!a.aborted){var yt=function(Le){return a.done({naturalWidth:l,naturalHeight:n,result:Le})};if(Te&&vt&&p.retainExif&&a.exif&&a.exif.length>0){var _t=function(Le){return yt(Mt(Ct(Mo(Le,a.exif),p.mimeType)))};if(Te.arrayBuffer)Te.arrayBuffer().then(_t).catch(function(){a.fail(new Error("Failed to read the compressed image with Blob.arrayBuffer()."))});else{var ke=new tt;a.reader=ke,ke.onload=function(Ze){var Le=Ze.target;_t(Le.result)},ke.onabort=function(){a.fail(new Error("Aborted to read the compressed image with FileReader."))},ke.onerror=function(){a.fail(new Error("Failed to read the compressed image with FileReader."))},ke.onloadend=function(){a.reader=null},ke.readAsArrayBuffer(Te)}}else yt(Te)}};y.toBlob?y.toBlob(bt,p.mimeType,p.quality):bt(Mt(y.toDataURL(p.mimeType,p.quality)))}}},{key:"done",value:function(o){var a=o.naturalWidth,l=o.naturalHeight,n=o.result,c=this.file,r=this.image,i=this.options;if(Ve&&r.src.indexOf("blob:")===0&&Ve.revokeObjectURL(r.src),n)if(i.strict&&!i.retainExif&&n.size>c.size&&i.mimeType===c.type&&!(i.width>a||i.height>l||i.minWidth>a||i.minHeight>l||i.maxWidth<a||i.maxHeight<l))n=c;else{var d=new Date;n.lastModified=d.getTime(),n.lastModifiedDate=d,n.name=c.name,n.name&&n.type!==c.type&&(n.name=n.name.replace(Co,vo(n.type)))}else n=c;this.result=n,i.success&&i.success.call(this,n)}},{key:"fail",value:function(o){var a=this.options;if(a.error)a.error.call(this,o);else throw o}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=ko,t}},{key:"setDefaults",value:function(o){Je(St,o)}}]),t}();const Ao={class:"img-wrap"},zo=["src"],To=B({__name:"upload-img",props:{accept:{default:"*"}},emits:["change"],setup(t,{emit:e}){const o=t;let a=L(!1),l=L(),n="",c=Pt(""),r=ue({quality:.8,width:void 0,height:void 0,url:""});const i=async()=>{a.value=!0,await $e()},d=L();no(d,_=>{let C=(_==null?void 0:_[0])??"";C&&s(C)});const u=()=>{n&&s(n)},s=_=>{let C=o.accept,H=_.name,S=H.substring(H.lastIndexOf(".")).toLowerCase();if(C!="*"&&!(o.accept.split(",").indexOf(S)>-1)){Pe.error("文件格式有误");return}n=_,new Ro(_,{quality:r.quality,width:r.width||void 0,height:r.height||void 0,success(b){c.value=b;let x=new FileReader;x.onload=()=>{r.url=x.result,x=null},x.readAsDataURL(b)},error(){Pe.error("压缩图片失败")}})},h=()=>{a.value=!1},p=()=>{c.value&&(e("change",{url:r.url,file:c.value}),h())},y=()=>{l.value.resetFields(),r.url="",n=null,c.value=null};return(_,C)=>{const H=U("el-input-number"),S=U("el-form-item"),b=U("el-button"),x=U("el-form"),k=U("el-dialog");return V(),j(b,be({onClick:i},_.$attrs),{default:w(()=>[Ye(_.$slots,"default",{},()=>[N("上传图片")],!0),v(k,{"append-to-body":"","destroy-on-close":"",width:"1200px",modelValue:g(a),"onUpdate:modelValue":C[3]||(C[3]=m=>ve(a)?a.value=m:a=m),onClose:y},{footer:w(()=>[v(b,{onClick:h},{default:w(()=>[N("关闭")]),_:1}),v(b,{type:"primary",onClick:p},{default:w(()=>[N("确认")]),_:1})]),default:w(()=>[$("div",{class:"drap-wrap",ref_key:"dropZoneRef",ref:d},[v(lt,{accept:_.accept,onChange:s},{default:w(()=>[N("拖拽或点击选择图片")]),_:1},8,["accept"])],512),v(x,{ref_key:"formRef",ref:l,style:{"margin-top":"20px"},model:g(r),inline:""},{default:w(()=>[v(S,{label:"质量"},{default:w(()=>[v(H,{modelValue:g(r).quality,"onUpdate:modelValue":C[0]||(C[0]=m=>g(r).quality=m),step:.1,max:1,min:.1},null,8,["modelValue"])]),_:1}),v(S,{label:"宽度",prop:"width"},{default:w(()=>[v(H,{modelValue:g(r).width,"onUpdate:modelValue":C[1]||(C[1]=m=>g(r).width=m)},null,8,["modelValue"])]),_:1}),v(S,{label:"高度",prop:"height"},{default:w(()=>[v(H,{modelValue:g(r).height,"onUpdate:modelValue":C[2]||(C[2]=m=>g(r).height=m)},null,8,["modelValue"])]),_:1}),v(S,null,{default:w(()=>{var m;return[v(b,{type:"primary",onClick:u},{default:w(()=>[N("重新处理")]),_:1}),N(" "+se(((m=g(c))==null?void 0:m.size)/1e3||0)+"KB ",1)]}),_:1})]),_:1},8,["model"]),$("div",Ao,[$("img",{class:"img",src:g(r).url,alt:""},null,8,zo)])]),_:1},8,["modelValue"])]),_:3},16)}}});const G=(t,e)=>{const o=t.__vccOpts||t;for(const[a,l]of e)o[a]=l;return o},Lo=G(To,[["__scopeId","data-v-84c5a84a"]]);let Jt="pannel-json";const Ho=t=>{try{sessionStorage[Jt]=JSON.stringify(t)}catch{}},Eo=()=>{let t={};try{t=JSON.parse(sessionStorage[Jt]||"{}")}catch{}return t},Oo=B({__name:"history",setup(t){let e=Ke("pannel",ue({components:[]})),o=L([]);ge(()=>{l()}),$t(()=>{o.value=null,a.value=null});let a=L("");const l=()=>{a.value=Z(()=>e,i=>{n(i)},{deep:!0,flush:"post",immediate:!0})},n=sa(i=>{try{o.value.unshift(JSON.parse(JSON.stringify(i)))}catch{}},1e3),c=i=>{var d;(d=a.value)==null||d.call(a),a.value=null,ut(e,i)},r=()=>{var i;a.value?((i=a.value)==null||i.call(a),a.value=null):l()};return(i,d)=>{const f=U("el-icon"),u=U("el-button"),s=U("el-dropdown-item"),h=U("el-dropdown-menu"),p=U("el-dropdown");return V(),z(J,null,[v(p,{style:{margin:"0 10px"},"hide-on-click":!1,"max-height":"300"},{dropdown:w(()=>[v(h,null,{default:w(()=>[(V(!0),z(J,null,le(g(o),(y,_)=>(V(),j(s,{onClick:Se(C=>c(y),["self"])},{default:w(()=>[N("序号 "+se(g(o).length-_),1)]),_:2},1032,["onClick"]))),256))]),_:1})]),default:w(()=>[v(u,{type:"primary",plain:""},{default:w(()=>[N(" 历史"),v(f,{class:"el-icon--right"},{default:w(()=>[v(g(ra))]),_:1})]),_:1})]),_:1}),v(u,{onClick:d[0]||(d[0]=y=>r()),plain:"",type:g(a)?"primary":"danger"},{default:w(()=>[N(se(g(a)?"自动保存中":"已暂停保存"),1)]),_:1},8,["type"])],64)}}}),Uo={class:"toolbar-wrap"},Bo={class:"label"},Do={class:"preview-wrap"},Po={class:"preview-wrap-json"},$o=B({__name:"index",emits:["refresh"],setup(t,{emit:e}){let o=Ke("pannel",ue({components:[]})),a=ue({name1:"哈哈",state:1});setInterval(()=>{a.state=a.state==1?2:1,a.rate=a.rate=="40%"?"100%":"40%"},1e3);let l=X(()=>o.components.filter(S=>S.active)),n=L(!1);const c=()=>{n.value=!0,Ho(o),setTimeout(()=>{n.value=!1},500)},r=({url:S})=>{let b=new Image;b.src=S,b.onload=()=>{o.components.push({w:b.width,h:b.height,self:{id:re(),name:"img-scale",desc:"图片",url:S}})}},i=S=>{let b=new FileReader,x=new FileReader;b.onload=()=>{const k=b.result;let m=new Image;m.src=k,m.onload=()=>{let R=m.width,E=m.height;x.onload=()=>{o.components.push({w:R,h:E,self:{id:re(),name:"icon-svg",desc:"svg",url:x.result}}),x.abort(),b.abort(),b=null,x=null},x.readAsText(S)}},b.readAsDataURL(S)};let d=L(!1);const f=()=>{d.value=!0};let u=L(!1);const s=()=>{u.value=!0},h=S=>{const b=new FileReader;b.onload=()=>{const x=b.result;let k=new Image;k.src=x,k.onload=()=>{o.components.push({w:k.width,h:k.height,self:{id:re(),name:"img-scale",desc:"图片",url:x}})}},b.readAsDataURL(S)},p=async()=>{let S=l.value||[],b=[];S.forEach(F=>{F.self.name=="Group"?b.push(..._(F)):b.push(F)});let{left:x,right:k,top:m,bottom:R}=Xa(b),E=b.map(F=>({...F,active:!1,preventDeactivation:!1,x:F.x-x,y:F.y-m})),P=o.components.filter(F=>l.value.every(fe=>F!==fe)),O={x,y:m,w:k-x,h:R-m,lockAspectRatio:!1,self:{id:re(),desc:"组合",name:"Group"},group:E};P.push(O),o.components=P,e("refresh")},y=()=>{var k;let S=((k=l.value)==null?void 0:k[0])??{},b=_(S),x=o.components.filter(m=>S!==m);x.push(...b),o.components=x,e("refresh")},_=S=>{let b=(S==null?void 0:S.group)??[],x=S.x,k=S.y;return b.map(m=>({...m,x:x+m.x,y:k+m.y}))};let C=L();const H=()=>{let S=C.value.innerText;try{let b=JSON.parse(S);ut(o,b),u.value=!1}catch{Pe.error("解析数据失败")}};return(S,b)=>{var R,E,P;const x=U("el-button"),k=U("el-input-number"),m=U("el-dialog");return V(),z(J,null,[$("div",Uo,[v(Lo,{accept:".png,.gif,.jpg,.jpeg",type:"primary",plain:"",onChange:r},{default:w(()=>[N("选择图片并压缩")]),_:1}),v(lt,{accept:".png,.gif,.jpg,.jpeg",onChange:h},{default:w(()=>[N("选择图片")]),_:1}),v(lt,{accept:".svg",onChange:i},{default:w(()=>[N("选择svg")]),_:1}),v(x,{type:"primary",plain:"",onClick:f},{default:w(()=>[N("预览")]),_:1}),v(x,{type:"primary",plain:"",onClick:s},{default:w(()=>[N("json")]),_:1}),v(x,{type:"primary",disabled:g(l).length<=1,plain:"",onClick:p},{default:w(()=>[N(" 组合")]),_:1},8,["disabled"]),v(x,{type:"primary",disabled:g(l).length!=1||((P=(E=(R=g(l))==null?void 0:R[0])==null?void 0:E.self)==null?void 0:P.name)!="Group",plain:"",onClick:b[0]||(b[0]=O=>y())},{default:w(()=>[N(" 拆分")]),_:1},8,["disabled"]),v(x,{style:{width:"100px"},loading:g(n),type:"primary",plain:"",onClick:b[1]||(b[1]=O=>c())},{default:w(()=>[N("临时缓存 ")]),_:1},8,["loading"]),v(Oo),$("div",Bo,[N(" 缩放 "),v(k,{size:"small",step:.1,modelValue:g(De),"onUpdate:modelValue":b[2]||(b[2]=O=>ve(De)?De.value=O:null)},null,8,["modelValue"])])]),v(m,{"align-center":"","append-to-body":"",width:"1040px",title:"预览","destroy-on-close":"",modelValue:g(d),"onUpdate:modelValue":b[4]||(b[4]=O=>ve(d)?d.value=O:d=O)},{default:w(()=>[$("div",Do,[g(d)?(V(),j(g(Be),{key:0,pannel:g(o),modelValue:g(a),"onUpdate:modelValue":b[3]||(b[3]=O=>ve(a)?a.value=O:a=O)},null,8,["pannel","modelValue"])):me("",!0)])]),_:1},8,["modelValue"]),v(m,{"align-center":"","append-to-body":"",width:"1200px",title:"预览JSON",modelValue:g(u),"onUpdate:modelValue":b[5]||(b[5]=O=>ve(u)?u.value=O:u=O)},{footer:w(()=>[v(x,{type:"primary",onClick:H},{default:w(()=>[N("确认")]),_:1})]),default:w(()=>[$("div",Po,[$("pre",{ref_key:"currentPannel",ref:C,style:{"min-height":"200px"},contenteditable:""},se(g(o)),513)])]),_:1},8,["modelValue"])],64)}}});const Io=G($o,[["__scopeId","data-v-581ab191"]]),Wo=B({__name:"index",setup(t,{expose:e}){let o=L([]),a=L([]);return e({init:n=>{o.value=n.vLine,a.value=n.hLine}}),(n,c)=>(V(),z(J,null,[(V(!0),z(J,null,le(g(o),(r,i)=>rt((V(),z("span",{class:"ref-line v-line",key:"v_"+i,style:te({left:r.position,top:r.origin,height:r.lineLength})},null,4)),[[Ut,r.display]])),128)),(V(!0),z(J,null,le(g(a),(r,i)=>(V(),z("span",{class:"ref-line h-line",key:"h_"+i,style:te({top:r.position,left:r.origin,width:r.lineLength})},null,4))),128))],64))}});const No=G(Wo,[["__scopeId","data-v-3b7aeeb1"]]),jo={class:"group-wrap"},Fo=["a"],Xo=B({__name:"index",props:{data:{},modelValue:{default:()=>({})},groupModel:{default:()=>({})},disabled:{type:Boolean}},setup(t){const e=t,o=n=>ft(n).default,a=n=>({width:n.w=="auto"?n.w:n.w+"px",height:n.h=="auto"?n.h:n.h+"px",transform:`translate(${n.x}px, ${n.y}px) rotate(${n.r||0}deg)`}),l=n=>dt(n,e.groupModel);return(n,c)=>(V(),z("div",jo,[(V(!0),z(J,null,le(n.data.group,r=>(V(),z("div",{a:r.active,class:"group-item",style:te(a(r))},[(V(),j(Ie(o(r.self.name)),be({data:r,h:r.h,w:r.w},l(r),{modelValue:n.groupModel[r.self.modelValue],"onUpdate:modelValue":i=>n.groupModel[r.self.modelValue]=i,defaultModelValue:r.self.defaultModelValue,"onUpdate:defaultModelValue":i=>r.self.defaultModelValue=i,disabled:!0}),null,16,["data","h","w","modelValue","onUpdate:modelValue","defaultModelValue","onUpdate:defaultModelValue"]))],12,Fo))),256))]))}});const Yo=G(Xo,[["__scopeId","data-v-a7d365c4"]]),Jo=Object.freeze(Object.defineProperty({__proto__:null,default:Yo},Symbol.toStringTag,{value:"Module"})),Go=["width","height","src"],Ko=B({__name:"index",props:{url:{},w:{},h:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""}},setup(t){const e=t;ce(a=>({"35be3580":a.color,"7a3808fb":a.bgColor,"565e2eee":a.padding,ca4fabd6:a.radius})),Z(()=>[e.w,e.h],()=>o()),ge(()=>{o()});const o=()=>{};return(a,l)=>(V(),z("img",{class:"custom-image",width:a.w,height:a.h,src:a.url,alt:""},null,8,Go))}});const qo=G(Ko,[["__scopeId","data-v-51bcdfe3"]]),Qo=Object.freeze(Object.defineProperty({__proto__:null,default:qo},Symbol.toStringTag,{value:"Module"})),Zo=B({__name:"index",props:{url:{},w:{},h:{},flip:{}},setup(t){const e=t;let o=L(),a="",l=!0,n="";Z(()=>[e.w,e.h],()=>c()),Z(()=>{var i,d;return[(i=e.flip)==null?void 0:i.horizontal,(d=e.flip)==null?void 0:d.vertical]},()=>r()),ge(()=>{a=o.value.getContext("2d"),c()});const c=()=>{let i=e.w,d=e.h;o.value.width=i,o.value.height=d,l?(l=!1,n=document.createElement("img"),n.src=e.url,n.onload=()=>{a.drawImage(n,0,0,i,d),r()}):r()},r=()=>{const{vertical:i,horizontal:d}=e.flip??{};let f=e.w,u=e.h;const s=d?-1:1,h=i?-1:1;a.clearRect(0,0,f,u),a.translate(f/2-f*s/2,u/2-u*h/2),a.scale(s,h),a.drawImage(n,0,0,f,u),a.setTransform(1,0,0,1,0,0)};return(i,d)=>(V(),z("canvas",{ref_key:"canvas",ref:o},null,512))}}),el=Object.freeze(Object.defineProperty({__proto__:null,default:Zo},Symbol.toStringTag,{value:"Module"})),tl={class:"shap-wrap"},al=B({__name:"index",props:{modelValue:{default:""},defaultModelValue:{default:""},data:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""},fontSize:{default:""},borderColor:{default:""},w:{},h:{}},setup(t){return ce(e=>({"34b705a8":e.color,c38521ba:e.bgColor,"7a639516":e.padding,"7af95eed":e.radius,"8c7b2eea":e.fontSize,"4a7ad51c":e.borderColor})),(e,o)=>(V(),z("div",tl,se(e.modelValue||e.defaultModelValue),1))}});const ol=G(al,[["__scopeId","data-v-400016bf"]]),ll=Object.freeze(Object.defineProperty({__proto__:null,default:ol},Symbol.toStringTag,{value:"Module"})),nl=["contenteditable"],il=B({__name:"index",props:{modelValue:{default:""},defaultModelValue:{},data:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""},fontSize:{default:""},borderColor:{default:""},w:{},h:{},noWordWrap:{type:Boolean,default:!1},overEllipsis:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},hasModelValue:{type:Boolean}},emits:["update:modelValue","update:defaultModelValue","click"],setup(t,{emit:e}){const o=t;ce(d=>({"00cd0a69":d.color,"863570b8":d.bgColor,cde924d2:d.padding,"31a3f24c":d.radius,"7015a02a":d.fontSize,aedef5c6:d.borderColor,ba981f16:d.noWordWrap?"nowrap":"","58ddca96":d.overEllipsis?"hidden":"auto","6b9be9da":d.overEllipsis?"ellipsis":"unset"}));let a=L(!1),l=L();const n=async()=>{o.disabled||(a.value=!0,c(l.value),await $e(),l.value.focus())},c=d=>{const f=window.getSelection(),u=document.createRange();u.selectNodeContents(d),f.removeAllRanges(),f.addRange(u)},r=()=>{a.value=!1},i=d=>{o.hasModelValue&&e("update:modelValue",d.target.innerText),e("update:defaultModelValue",d.target.innerText)};return(d,f)=>(V(),z("div",{contenteditable:g(a),onBlur:r,onInput:i,ref_key:"text",ref:l,class:de({"text-wrap":!0,"can-edit":g(a)}),onDblclick:n},se(d.modelValue||d.defaultModelValue),43,nl))}});const sl=G(il,[["__scopeId","data-v-b9e7c0b0"]]),rl=Object.freeze(Object.defineProperty({__proto__:null,default:sl},Symbol.toStringTag,{value:"Module"})),dl=["innerHTML"],ul=B({__name:"index",props:{url:{},color:{default:""},bgColor:{default:""},fillColor:{default:""},padding:{default:""},radius:{default:""},fontSize:{default:""},iconUseSelfColor:{type:Boolean}},setup(t){return ce(e=>({"46bf371c":e.color,"5a1a592f":e.fillColor,"1d6b7926":e.bgColor,"651f2d40":e.padding,"5f884d3a":e.radius,"6f5fc4fe":e.fontSize})),(e,o)=>(V(),z("div",{class:de({"icon-wrap":!0,"color-self":e.iconUseSelfColor}),innerHTML:e.url},null,10,dl))}});const cl=G(ul,[["__scopeId","data-v-6b52c610"]]),fl=Object.freeze(Object.defineProperty({__proto__:null,default:cl},Symbol.toStringTag,{value:"Module"})),hl={class:"img-scale-wrap"},pl=["src"],ml=B({__name:"index",props:{url:{},w:{},h:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""},lockAspectRatio:{type:Boolean,default:!1},position:{default:"left"},imgWidth:{},imgHeight:{}},setup(t){const e=t;ce(l=>({ef6c025e:l.color,"58f6c20c":l.bgColor,"351ce7ff":l.padding,cc74ea38:l.radius}));let o=X(()=>({[e.position]:0,width:e.imgWidth,height:e.imgHeight})),a=X(()=>({[e.position]:0,width:e.lockAspectRatio?e.w+"px":void 0,height:e.lockAspectRatio?e.h+"px":void 0}));return(l,n)=>(V(),z("div",hl,[$("div",{class:"img-scale-reduce",style:te(g(o))},[$("img",{class:"img-scale",src:l.url,alt:"",style:te(g(a))},null,12,pl)],4)]))}});const gl=G(ml,[["__scopeId","data-v-321d426b"]]),vl=Object.freeze(Object.defineProperty({__proto__:null,default:gl},Symbol.toStringTag,{value:"Module"})),bl=B({name:"dragPannelPreview"}),yl=B({...bl,props:{pannel:{},modelValue:{default:()=>({})},disabled:{type:Boolean,default:!1},parentWidth:{default:0}},emits:["click"],setup(t,{emit:e}){const o=t;let a=L(),l=L({});ge(()=>{c()});const n=u=>({width:u.w==="auto"?u.w:u.w+"px",height:u.h==="auto"?u.h:u.h+"px",fontSize:o.pannel.fontSize||u.fontSize,zIndex:u.z||"auto",transform:`translate(${u.x||0}px, ${u.y||0}px) rotate(${u.r||0}deg)`}),c=async()=>{await $e();let u={transformOrigin:"0% 0%",width:o.pannel.width+"px",height:o.pannel.height+"px",color:o.pannel.color,fontSize:o.pannel.fontSize,backgroundColor:o.pannel.bgColor},s=a.value.getBoundingClientRect(),{endRate:h,translateX:p,translateY:y}=r(s.width,s.height);l.value={...u,transform:`translate(${p}px, ${y}px) scale(${h})`}},r=(u,s)=>{let h=u/o.pannel.width,p=s/o.pannel.height,y=h>p?p:h,_=h<=p?0:u*y,C=p<=h?0:s*y;return{endRate:y,translateX:_>0?u/2-o.pannel.width/2*y:_,translateY:C>0?s/2-o.pannel.height/2*y:C}},i=u=>ft(u).default,d=u=>{u.self.click&&(console.log("click"),e("click",u))},f=u=>dt(u,o.modelValue);return(u,s)=>(V(),z("div",{ref_key:"wrapRef",ref:a,class:"drag-editor-preivew-wrap"},[$("div",{class:de({"drag-editor-preivew":!0}),style:te(g(l))},[(V(!0),z(J,null,le(u.pannel.components,h=>(V(),z("div",{class:"preview-item-wrap",style:te(n(h))},[(V(),j(Ie(i(h.self.name)),be({data:h,h:h.h,w:h.w},f(h),{onClickCapture:Se(p=>d(h),["self"]),modelValue:u.modelValue[h.self.modelValue],"onUpdate:modelValue":p=>u.modelValue[h.self.modelValue]=p,defaultModelValue:h.self.defaultModelValue,"onUpdate:defaultModelValue":p=>h.self.defaultModelValue=p,groupModel:u.modelValue,disabled:!0}),null,16,["data","h","w","onClickCapture","modelValue","onUpdate:modelValue","defaultModelValue","onUpdate:defaultModelValue","groupModel"]))],4))),256))],4)],512))}});const _l=G(yl,[["__scopeId","data-v-b2568ace"]]),wl=Object.freeze(Object.defineProperty({__proto__:null,default:_l},Symbol.toStringTag,{value:"Module"}));let xl=Object.assign({"./Group/index.vue":Jo,"./Image/index.vue":Qo,"./Picture/index.vue":el,"./Shape/index.vue":ll,"./Text/index.vue":rl,"./icon-svg/index.vue":fl,"./img-scale/index.vue":vl,"./preview/index.vue":wl});const ft=t=>xl[`./${t}/index.vue`];function Ue(t){var e;const o=oe(t);return(e=o==null?void 0:o.$el)!=null?e:o}const Gt=Ae?window:void 0;function Fe(...t){let e,o,a,l;if(typeof t[0]=="string"||Array.isArray(t[0])?([o,a,l]=t,e=Gt):[e,o,a,l]=t,!e)return Re;Array.isArray(o)||(o=[o]),Array.isArray(a)||(a=[a]);const n=[],c=()=>{n.forEach(f=>f()),n.length=0},r=(f,u,s,h)=>(f.addEventListener(u,s,h),()=>f.removeEventListener(u,s,h)),i=Z(()=>[Ue(e),oe(l)],([f,u])=>{if(c(),!f)return;const s=jt(u)?{...u}:u;n.push(...o.flatMap(h=>a.map(p=>r(f,h,p,s))))},{immediate:!0,flush:"post"}),d=()=>{i(),c()};return qe(d),d}let Rt=!1;function At(t,e,o={}){const{window:a=Gt,ignore:l=[],capture:n=!0,detectIframe:c=!1}=o;if(!a)return;nt&&!Rt&&(Rt=!0,Array.from(a.document.body.children).forEach(s=>s.addEventListener("click",Re)),a.document.documentElement.addEventListener("click",Re));let r=!0;const i=s=>l.some(h=>{if(typeof h=="string")return Array.from(a.document.querySelectorAll(h)).some(p=>p===s.target||s.composedPath().includes(p));{const p=Ue(h);return p&&(s.target===p||s.composedPath().includes(p))}}),f=[Fe(a,"click",s=>{const h=Ue(t);if(!(!h||h===s.target||s.composedPath().includes(h))){if(s.detail===0&&(r=!i(s)),!r){r=!0;return}e(s)}},{passive:!0,capture:n}),Fe(a,"pointerdown",s=>{const h=Ue(t);h&&(r=!s.composedPath().includes(h)&&!i(s))},{passive:!0}),c&&Fe(a,"blur",s=>{setTimeout(()=>{var h;const p=Ue(t);((h=a.document.activeElement)==null?void 0:h.tagName)==="IFRAME"&&!(p!=null&&p.contains(a.document.activeElement))&&e(s)},0)})].filter(Boolean);return()=>f.forEach(s=>s())}const Vl={[wt.mounted](t,e){const o=!e.modifiers.bubble;if(typeof e.value=="function")t.__onClickOutside_stop=At(t,e.value,{capture:o});else{const[a,l]=e.value;t.__onClickOutside_stop=At(t,a,Object.assign({capture:o},l))}},[wt.unmounted](t){t.__onClickOutside_stop()}};function at(t){return typeof Window<"u"&&t instanceof Window?t.document.documentElement:typeof Document<"u"&&t instanceof Document?t.documentElement:t}function Kt(t){const e=window.getComputedStyle(t);if(e.overflowX==="scroll"||e.overflowY==="scroll"||e.overflowX==="auto"&&t.clientWidth<t.scrollWidth||e.overflowY==="auto"&&t.clientHeight<t.scrollHeight)return!0;{const o=t.parentNode;return!o||o.tagName==="BODY"?!1:Kt(o)}}function Ml(t){const e=t||window.event,o=e.target;return Kt(o)?!1:e.touches.length>1?!0:(e.preventDefault&&e.preventDefault(),!1)}function Sl(t,e=!1){const o=L(e);let a=null,l;Z(Ka(t),r=>{const i=at(oe(r));if(i){const d=i;l=d.style.overflow,o.value&&(d.style.overflow="hidden")}},{immediate:!0});const n=()=>{const r=at(oe(t));!r||o.value||(nt&&(a=Fe(r,"touchmove",i=>{Ml(i)},{passive:!1})),r.style.overflow="hidden",o.value=!0)},c=()=>{const r=at(oe(t));!r||!o.value||(nt&&(a==null||a()),r.style.overflow=l,o.value=!1)};return qe(c),X({get(){return o.value},set(r){r?n():c()}})}function Cl(){let t=!1;const e=L(!1);return(o,a)=>{if(e.value=a.value,t)return;t=!0;const l=Sl(o,a.value);Z(e,n=>l.value=n)}}Cl();function ot(...t){return X(()=>t.every(e=>oe(e)))}const kl=["onClick"],Rl=B({__name:"index",props:{pannel:{},modelValue:{default:()=>({})},disabled:{type:Boolean,default:!1},active:{default:()=>[]}},emits:["refLineParams","refresh"],setup(t,{expose:e,emit:o}){const a=t;let l=L(!1),n=X(()=>({transform:`scale(${De.value})`,transformOrigin:"50% 0%",width:a.pannel.width+"px",height:a.pannel.height+"px",color:a.pannel.color,fontSize:a.pannel.fontSize,backgroundColor:a.pannel.bgColor}));const{text:c,copy:r}=lo({legacy:!0});let i=L(),d=ue({isAllAsync:!1,controlKey:!1,draggingId:null,prevOffsetX:0,prevOffsetY:0});ge(()=>{s()}),$t(()=>{C()});const f=M=>({fontSize:a.pannel.fontSize||M.fontSize}),u=M=>{var T;return((T=ft(M))==null?void 0:T.default)??""},s=()=>{const M=to(),T=X(()=>{var I,ae,W;return((I=M.value)==null?void 0:I.tagName)!=="INPUT"&&((ae=M.value)==null?void 0:ae.tagName)!=="TEXTAREA"&&((W=M.value)==null?void 0:W.getAttribute("contenteditable"))!=="true"&&l.value}),{Ctrl_C:Y,Ctrl_V:A,Delete:D}=so();et(ot(Y,T),()=>{h()}),et(ot(A,T),()=>{p()}),et(ot(D,T),()=>{y()}),We(["ArrowDown"],I=>{T.value&&(I.preventDefault(),K("down"))}),We(["ArrowLeft"],I=>{T.value&&(I.preventDefault(),K("left"))}),We(["ArrowRight"],I=>{T.value&&(I.preventDefault(),K("right"))}),We(["ArrowUp"],I=>{T.value&&(I.preventDefault(),K("up"))})},h=()=>{if(a.active.length)try{let M=JSON.stringify(a.active);r(M)}catch{}};let p=()=>{try{a.pannel.components.forEach(T=>{T.active=!1});let M=JSON.parse(c.value);M.forEach(T=>{T.active=!0,T.self.id=re()}),a.pannel.components.push(...M)}catch{}};const y=()=>{a.pannel.components=a.pannel.components.filter(M=>!M.active),o("refresh")},_=()=>{l.value=!0,window.addEventListener("keydown",S),window.addEventListener("keyup",b),window.addEventListener("keydown",x),window.addEventListener("keyup",k)},C=()=>{window.removeEventListener("keydown",S),window.removeEventListener("keyup",b),window.removeEventListener("keydown",x),window.removeEventListener("keyup",k)},H=()=>{C(),l.value=!1},S=M=>{M.keyCode===32&&(M.preventDefault(),d.isAllAsync=!0)},b=M=>{M.keyCode===32&&(M.preventDefault(),d.isAllAsync=!1)},x=M=>{M.keyCode===17&&(d.controlKey=!0)},k=M=>{M.keyCode===17&&(d.controlKey=!1)};let m=L();const R=M=>{var T;(T=m.value)==null||T.init(M)},E=M=>{d.controlKey?M.preventDeactivation=!0:a.pannel.components.forEach(T=>{T.active=!1,T.preventDeactivation=!1}),M.preventDeactivation=!0,M.active=!0},P=M=>{M.active=!1,M.preventDeactivation=!1},O=()=>{a.disabled||(_(),!(d.controlKey&&l)&&a.pannel.components.forEach(M=>{M.active=!1,M.preventDeactivation=!1}))},F=(M,T,Y,A,D)=>{Object.assign(D,{x:M,y:T,w:Y||D.width,h:A||D.width})},fe=(M,T,Y)=>{d.draggingId=M;const A=T-(M.x??0),D=Y-(M.y??0),I=we(A),ae=xe(D);if(!d.isAllAsync){a.pannel.components.forEach(W=>{W.active&&W!==M&&(W.x=(W.x??0)+I,W.y=(W.y??0)+ae)});return}a.pannel.components.forEach(W=>{W!==M&&(W.x=(W.x??0)+I,W.y=(W.y??0)+ae)})},_e=(M,T,Y)=>{a.pannel.components.forEach(A=>{A===M&&(A.x=T,A.y=Y)}),d.draggingId=null,d.prevOffsetX=0,d.prevOffsetY=0},we=M=>{const T=M-d.prevOffsetX;return d.prevOffsetX=M,T},xe=M=>{const T=M-d.prevOffsetY;return d.prevOffsetY=M,T},K=M=>{let T=0,Y=0;switch(M){case"up":Y=-1;break;case"down":Y=1;break;case"left":T=-1;break;case"right":T=1;break}a.pannel.components.forEach(A=>{A.active&&(A.x=(A.x??0)+T,A.y=(A.y??0)+Y)})},ne=(M,T)=>{T.r=M},q=M=>dt(M,a.modelValue);return e({ref:i}),(M,T)=>{const Y=U("VueDragResizeRotate");return rt((V(),z("div",{ref_key:"dragRef",ref:i,class:de({"drag-editor-wrap":!0,disabled:M.disabled}),onClick:Se(O,["self","stop"]),onMousedown:T[0]||(T[0]=A=>_()),style:te(g(n))},[(V(!0),z(J,null,le(M.pannel.components,A=>(V(),j(Y,be({...g(Nt),...A,self:"",dySelf:""},{h:A.h=="auto"?A.h:parseFloat(A.h)||0,w:A.w=="auto"?A.w:parseFloat(A.w)||0,onActivated:D=>E(A),onDeactivated:D=>P(A),onRefLineParams:R,onResizing:(D,I,ae,W)=>F(D,I,ae,W,A),onResizestop:(D,I,ae,W)=>F(D,I,ae,W,A),onDragging:(D,I)=>fe(A,D,I),onDragstop:(D,I)=>_e(A,D,I),onRotating:D=>ne(D,A),onRotatestop:D=>ne(D,A),scaleRatio:g(De)}),{default:w(()=>[(V(),j(Ie(u(A.self.name)),be({key:A.self.id,data:A,h:A.h,w:A.w},q(A),{style:f(A),hasModelValue:!!A.self.modelValue,modelValue:M.modelValue[A.self.modelValue],"onUpdate:modelValue":D=>M.modelValue[A.self.modelValue]=D,defaultModelValue:A.self.defaultModelValue,"onUpdate:defaultModelValue":D=>A.self.defaultModelValue=D,groupModel:M.modelValue}),null,16,["data","h","w","style","hasModelValue","modelValue","onUpdate:modelValue","defaultModelValue","onUpdate:defaultModelValue","groupModel"]))]),_:2},1040,["h","w","onActivated","onDeactivated","onResizing","onResizestop","onDragging","onDragstop","onRotating","onRotatestop","scaleRatio"]))),256)),v(No,{ref_key:"subLineRef",ref:m},null,512)],46,kl)),[[g(Vl),H]])}}});const Al=G(Rl,[["__scopeId","data-v-9c40332e"]]),zl=""+new URL("../gif/gif.5a563899.gif",import.meta.url).href,zt=[{w:"auto",h:"auto",self:{id:re(),name:"Text",desc:"文本",modelValue:"",defaultModelValue:"文本"},dySelf:{}},{w:200,h:200,self:{id:re(),name:"img-scale",desc:"图片",url:zl},dySelf:{}},{w:100,h:100,self:{id:re(),name:"icon-svg",desc:"svg",url:'<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" data-v-ea893728=""><path fill="currentColor" d="M600.704 64a32 32 0 0 1 30.464 22.208l35.2 109.376c14.784 7.232 28.928 15.36 42.432 24.512l112.384-24.192a32 32 0 0 1 34.432 15.36L944.32 364.8a32 32 0 0 1-4.032 37.504l-77.12 85.12a357.12 357.12 0 0 1 0 49.024l77.12 85.248a32 32 0 0 1 4.032 37.504l-88.704 153.6a32 32 0 0 1-34.432 15.296L708.8 803.904c-13.44 9.088-27.648 17.28-42.368 24.512l-35.264 109.376A32 32 0 0 1 600.704 960H423.296a32 32 0 0 1-30.464-22.208L357.696 828.48a351.616 351.616 0 0 1-42.56-24.64l-112.32 24.256a32 32 0 0 1-34.432-15.36L79.68 659.2a32 32 0 0 1 4.032-37.504l77.12-85.248a357.12 357.12 0 0 1 0-48.896l-77.12-85.248A32 32 0 0 1 79.68 364.8l88.704-153.6a32 32 0 0 1 34.432-15.296l112.32 24.256c13.568-9.152 27.776-17.408 42.56-24.64l35.2-109.312A32 32 0 0 1 423.232 64H600.64zm-23.424 64H446.72l-36.352 113.088-24.512 11.968a294.113 294.113 0 0 0-34.816 20.096l-22.656 15.36-116.224-25.088-65.28 113.152 79.68 88.192-1.92 27.136a293.12 293.12 0 0 0 0 40.192l1.92 27.136-79.808 88.192 65.344 113.152 116.224-25.024 22.656 15.296a294.113 294.113 0 0 0 34.816 20.096l24.512 11.968L446.72 896h130.688l36.48-113.152 24.448-11.904a288.282 288.282 0 0 0 34.752-20.096l22.592-15.296 116.288 25.024 65.28-113.152-79.744-88.192 1.92-27.136a293.12 293.12 0 0 0 0-40.256l-1.92-27.136 79.808-88.128-65.344-113.152-116.288 24.96-22.592-15.232a287.616 287.616 0 0 0-34.752-20.096l-24.448-11.904L577.344 128zM512 320a192 192 0 1 1 0 384 192 192 0 0 1 0-384zm0 64a128 128 0 1 0 0 256 128 128 0 0 0 0-256z"></path></svg>'},dySelf:{}},{w:100,h:100,self:{id:re(),name:"Shape",desc:"图形",borderColor:"solid 1px #333",prop:"state",activeValue:"1",activeMap:'{"bgColor":"red"}'},dySelf:{}}],Tl=["data-index"],Ll=B({__name:"components-list",setup(t){const e=o=>{let a=JSON.stringify(zt[o.target.dataset.index]);o.dataTransfer.setData("component",a)};return(o,a)=>(V(),z("div",{class:"component-list",onDragstart:e},[(V(!0),z(J,null,le(g(zt),(l,n)=>(V(),z("div",{key:n,class:"list",draggable:!0,"data-index":n},[$("span",null,se(l.self.desc),1)],8,Tl))),128))],32))}});const Hl=G(Ll,[["__scopeId","data-v-6e5ae7f5"]]),El={class:"com-list-wrap"},Ol={class:"com-wrap"},Ul={class:"real-scroll-wrap"},Bl=["onClick"],Dl=["onClick"],Pl=B({__name:"index",props:{active:{}},emits:["delete"],setup(t,{emit:e}){const o=t;let a=Ke("pannel",L({}));const l=i=>{i.active=!0},n=i=>{a.components=a.components.filter(d=>d!==i),e("delete")};Z(()=>o.active,()=>{r()},{flush:"post"});let c=L();const r=()=>{if(!o.active)return;let i=c.value.querySelector(".active");i==null||i.scrollIntoView({block:"nearest",behavior:"smooth"})};return(i,d)=>{const f=U("el-icon"),u=U("el-scrollbar");return V(),z("div",El,[$("div",Ol,[v(Hl)]),$("div",Ul,[v(u,{height:"100%",always:""},{default:w(()=>[$("div",{ref_key:"nodeWrap",ref:c,class:"real-com-wrap"},[(V(!0),z(J,null,le(g(a).components,s=>(V(),z("div",{class:de({"com-item":!0,active:s.active}),onClick:h=>l(s)},[$("div",{class:"close-wrap",onClick:Se(h=>n(s),["stop"])},[v(f,null,{default:w(()=>[v(g(da))]),_:1})],8,Dl),N(" "+se(s.self.desc||s.self.name)+" "+se(s.self.name=="Group"?s.group.length:""),1)],10,Bl))),256))],512)]),_:1})])])}}});const $l=G(Pl,[["__scopeId","data-v-35099684"]]),Il=B({__name:"platform",props:{pannel:{}},setup(t){return(e,o)=>{const a=U("el-input"),l=U("el-form-item"),n=U("el-input-number"),c=U("el-color-picker"),r=U("el-form");return V(),j(r,{size:"small"},{default:w(()=>[v(l,{label:"版本"},{default:w(()=>[v(a,{modelValue:e.pannel.version,"onUpdate:modelValue":o[0]||(o[0]=i=>e.pannel.version=i)},null,8,["modelValue"])]),_:1}),v(l,{label:"描述"},{default:w(()=>[v(a,{modelValue:e.pannel.desc,"onUpdate:modelValue":o[1]||(o[1]=i=>e.pannel.desc=i)},null,8,["modelValue"])]),_:1}),v(l,{label:"宽度"},{default:w(()=>[v(n,{modelValue:e.pannel.width,"onUpdate:modelValue":o[2]||(o[2]=i=>e.pannel.width=i)},null,8,["modelValue"])]),_:1}),v(l,{label:"高度"},{default:w(()=>[v(n,{modelValue:e.pannel.height,"onUpdate:modelValue":o[3]||(o[3]=i=>e.pannel.height=i)},null,8,["modelValue"])]),_:1}),v(l,{label:"文字颜色"},{default:w(()=>[v(c,{modelValue:e.pannel.color,"onUpdate:modelValue":o[4]||(o[4]=i=>e.pannel.color=i)},null,8,["modelValue"])]),_:1}),v(l,{label:"背景色"},{default:w(()=>[v(c,{modelValue:e.pannel.bgColor,"onUpdate:modelValue":o[5]||(o[5]=i=>e.pannel.bgColor=i)},null,8,["modelValue"])]),_:1}),v(l,{label:"文字大小"},{default:w(()=>[v(a,{placeholder:"0px",modelValue:e.pannel.fontSize,"onUpdate:modelValue":o[6]||(o[6]=i=>e.pannel.fontSize=i)},null,8,["modelValue"])]),_:1})]),_:1})}}});const Wl=G(Il,[["__scopeId","data-v-6ad875fe"]]),qt=t=>(oa("data-v-06777527"),t=t(),la(),t),Nl={key:2},jl={key:3},Fl={key:4},Xl=qt(()=>$("br",null,null,-1)),Yl=qt(()=>$("br",null,null,-1)),Jl=B({__name:"componentsAttr",props:{active:{}},setup(t){const e=t;let o=L(["1","3","2"]),a=X(()=>{if(e.active){let u={...Nt,...e.active};return Object.assign(e.active,u)}return e.active}),l=[{label:"靠上",value:"top"},{label:"靠下",value:"bottom"},{label:"靠左",value:"left"},{label:"靠右",value:"right"}],n=[{label:"大于",value:"大于"},{label:"小于",value:"小于"},{label:"等于",value:"等于"},{label:"不等于",value:"不等于"},{label:"大于等于",value:"大于等于"},{label:"小于等于",value:"小于等于"},{label:"存在(!null && !undefind)",value:"存在"},{label:"不存在(null || undefind)",value:"不存在"}],c=["Text","Shape"],r=X(()=>c.indexOf(e.active.self.name)>-1),i=X(()=>e.active.self.name=="Image"),d=X(()=>e.active.self.name=="img-scale"),f=X(()=>e.active.self.name=="icon-svg");return(u,s)=>{const h=U("el-input"),p=U("el-form-item"),y=U("el-switch"),_=U("el-color-picker"),C=U("el-form"),H=U("el-collapse-item"),S=U("el-option"),b=U("el-select"),x=U("el-input-number"),k=U("el-collapse");return V(),j(k,{modelValue:g(o),"onUpdate:modelValue":s[36]||(s[36]=m=>ve(o)?o.value=m:o=m)},{default:w(()=>[v(H,{title:"特有属性",name:"1"},{default:w(()=>[v(C,{size:"small"},{default:w(()=>[v(p,{label:"组件名称",title:"self.name"},{default:w(()=>[v(h,{disabled:"",modelValue:g(a).self.name,"onUpdate:modelValue":s[0]||(s[0]=m=>g(a).self.name=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"组件id",title:"self.id"},{default:w(()=>[v(h,{modelValue:g(a).self.id,"onUpdate:modelValue":s[1]||(s[1]=m=>g(a).self.id=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"点击事件",title:"self.click"},{default:w(()=>[v(y,{modelValue:g(a).self.click,"onUpdate:modelValue":s[2]||(s[2]=m=>g(a).self.click=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"width",title:"w"},{default:w(()=>[v(h,{modelValue:g(a).w,"onUpdate:modelValue":s[3]||(s[3]=m=>g(a).w=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"height",title:"h"},{default:w(()=>[v(h,{modelValue:g(a).h,"onUpdate:modelValue":s[4]||(s[4]=m=>g(a).h=m)},null,8,["modelValue"])]),_:1}),g(d)?(V(),j(p,{key:0,label:"图片内部宽度",title:"self.imgWidth"},{default:w(()=>[v(h,{modelValue:g(a).self.imgWidth,"onUpdate:modelValue":s[5]||(s[5]=m=>g(a).self.imgWidth=m),placeholder:"动态控制%"},null,8,["modelValue"])]),_:1})):me("",!0),g(d)?(V(),j(p,{key:1,label:"图片内部高度",title:"self.imgHeight"},{default:w(()=>[v(h,{modelValue:g(a).self.imgHeight,"onUpdate:modelValue":s[6]||(s[6]=m=>g(a).self.imgHeight=m),placeholder:"动态控制%"},null,8,["modelValue"])]),_:1})):me("",!0),g(f)?(V(),z("div",Nl,[v(p,{label:"icon自定义颜色",title:"self.iconUseSelfColor"},{default:w(()=>[v(y,{modelValue:g(a).self.iconUseSelfColor,"onUpdate:modelValue":s[7]||(s[7]=m=>g(a).self.iconUseSelfColor=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"icon背景色",title:"self.fillColor"},{default:w(()=>[v(_,{modelValue:g(a).self.fillColor,"onUpdate:modelValue":s[8]||(s[8]=m=>g(a).self.fillColor=m)},null,8,["modelValue"])]),_:1})])):me("",!0),v(p,{label:"颜色",title:"self.color"},{default:w(()=>[v(_,{modelValue:g(a).self.color,"onUpdate:modelValue":s[9]||(s[9]=m=>g(a).self.color=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"背景色",title:"self.bgColor"},{default:w(()=>[v(_,{modelValue:g(a).self.bgColor,"onUpdate:modelValue":s[10]||(s[10]=m=>g(a).self.bgColor=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"边框",title:"self.borderColor"},{default:w(()=>[v(h,{placeholder:"solid 1px #000000",modelValue:g(a).self.borderColor,"onUpdate:modelValue":s[11]||(s[11]=m=>g(a).self.borderColor=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"padding",title:"self.padding"},{default:w(()=>[v(h,{modelValue:g(a).self.padding,"onUpdate:modelValue":s[12]||(s[12]=m=>g(a).self.padding=m),placeholder:"0px 0px 0px 0px"},null,8,["modelValue"])]),_:1}),v(p,{label:"radius",title:"self.radius"},{default:w(()=>[v(h,{modelValue:g(a).self.radius,"onUpdate:modelValue":s[13]||(s[13]=m=>g(a).self.radius=m),placeholder:"0px 0px 0px 0px"},null,8,["modelValue"])]),_:1}),v(p,{label:"文字大小",title:"self.fontSize"},{default:w(()=>[v(h,{modelValue:g(a).self.fontSize,"onUpdate:modelValue":s[14]||(s[14]=m=>g(a).self.fontSize=m),placeholder:"0px"},null,8,["modelValue"])]),_:1}),v(p,{label:"modelValue",title:"self.modelValue"},{default:w(()=>[v(h,{placeholder:"绑定属性",modelValue:g(a).self.modelValue,"onUpdate:modelValue":s[15]||(s[15]=m=>g(a).self.modelValue=m)},null,8,["modelValue"])]),_:1}),g(r)?(V(),z("div",jl,[v(p,{label:"默认值",title:"self.defaultModelValue"},{default:w(()=>[v(h,{modelValue:g(a).self.defaultModelValue,"onUpdate:modelValue":s[16]||(s[16]=m=>g(a).self.defaultModelValue=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"禁止换行",title:"self.noWordWrap"},{default:w(()=>[v(y,{modelValue:g(a).self.noWordWrap,"onUpdate:modelValue":s[17]||(s[17]=m=>g(a).self.noWordWrap=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"超出省略",title:"self.overEllipsis"},{default:w(()=>[v(y,{modelValue:g(a).self.overEllipsis,"onUpdate:modelValue":s[18]||(s[18]=m=>g(a).self.overEllipsis=m)},null,8,["modelValue"])]),_:1})])):me("",!0),g(i)||g(d)||g(f)?(V(),z("div",Fl,[v(p,{label:"url",title:"self.url"},{default:w(()=>[v(h,{modelValue:g(a).self.url,"onUpdate:modelValue":s[19]||(s[19]=m=>g(a).self.url=m)},null,8,["modelValue"])]),_:1})])):me("",!0)]),_:1})]),_:1}),v(H,{title:"逻辑处理",name:"3"},{default:w(()=>[v(C,{size:"small","label-position":"top"},{default:w(()=>[v(p,{label:"prop",title:"self.prop"},{default:w(()=>[v(h,{placeholder:"绑定属性",modelValue:g(a).self.prop,"onUpdate:modelValue":s[20]||(s[20]=m=>g(a).self.prop=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"值匹配"},{default:w(()=>[v(b,{title:"self.activeMode",modelValue:g(a).self.activeMode,"onUpdate:modelValue":s[21]||(s[21]=m=>g(a).self.activeMode=m)},{default:w(()=>[(V(!0),z(J,null,le(g(n),m=>(V(),j(S,{label:m.label,value:m.value},null,8,["label","value"]))),256))]),_:1},8,["modelValue"]),Xl,Yl,v(h,{title:"self.activeValue",placeholder:`1 (${g(a).self.prop||"prop"}${g(a).self.activeMode||""}1)`,modelValue:g(a).self.activeValue,"onUpdate:modelValue":s[22]||(s[22]=m=>g(a).self.activeValue=m)},null,8,["placeholder","modelValue"])]),_:1}),v(p,{label:"匹配后重置属性",title:"self.activeMap"},{default:w(()=>[v(h,{type:"textarea",placeholder:'{"bgColor":"red || ${red}"}',modelValue:g(a).self.activeMap,"onUpdate:modelValue":s[23]||(s[23]=m=>g(a).self.activeMap=m)},null,8,["modelValue"])]),_:1}),g(d)?(V(),j(p,{key:0,label:"图片比例固定",title:"self.lockAspectRatio"},{default:w(()=>[v(y,{modelValue:g(a).self.lockAspectRatio,"onUpdate:modelValue":s[24]||(s[24]=m=>g(a).self.lockAspectRatio=m)},null,8,["modelValue"])]),_:1})):me("",!0),g(d)?(V(),j(p,{key:1,label:"图片比例起始位置",title:"self.position"},{default:w(()=>[v(b,{modelValue:g(a).self.position,"onUpdate:modelValue":s[25]||(s[25]=m=>g(a).self.position=m)},{default:w(()=>[(V(!0),z(J,null,le(g(l),m=>(V(),j(S,{label:m.label,value:m.value},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})):me("",!0)]),_:1})]),_:1}),v(H,{title:"通用属性",name:"2"},{default:w(()=>[v(C,{size:"small"},{default:w(()=>[v(p,{label:"left"},{default:w(()=>[v(x,{modelValue:g(a).x,"onUpdate:modelValue":s[26]||(s[26]=m=>g(a).x=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"top"},{default:w(()=>[v(x,{modelValue:g(a).y,"onUpdate:modelValue":s[27]||(s[27]=m=>g(a).y=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"zIndex"},{default:w(()=>[v(x,{modelValue:g(a).z,"onUpdate:modelValue":s[28]||(s[28]=m=>g(a).z=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"旋转"},{default:w(()=>[v(x,{min:0,modelValue:g(a).r,"onUpdate:modelValue":s[29]||(s[29]=m=>g(a).r=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"锁定比例"},{default:w(()=>[v(y,{modelValue:g(a).lockAspectRatio,"onUpdate:modelValue":s[30]||(s[30]=m=>g(a).lockAspectRatio=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"缩放"},{default:w(()=>[v(y,{modelValue:g(a).resizable,"onUpdate:modelValue":s[31]||(s[31]=m=>g(a).resizable=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"旋转"},{default:w(()=>[v(y,{modelValue:g(a).rotatable,"onUpdate:modelValue":s[32]||(s[32]=m=>g(a).rotatable=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"父级约束"},{default:w(()=>[v(y,{modelValue:g(a).parent,"onUpdate:modelValue":s[33]||(s[33]=m=>g(a).parent=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"吸附"},{default:w(()=>[v(y,{modelValue:g(a).snap,"onUpdate:modelValue":s[34]||(s[34]=m=>g(a).snap=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"吸附距离"},{default:w(()=>[v(x,{modelValue:g(a).snapTolerance,"onUpdate:modelValue":s[35]||(s[35]=m=>g(a).snapTolerance=m)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}});const Gl=G(Jl,[["__scopeId","data-v-06777527"]]),Kl={class:"wrap"},ql=B({__name:"index",props:{active:{default:()=>({})},activeLength:{}},setup(t){const e=t;let o=L(""),a=Ke("pannel",ue({}));return Z(()=>e.activeLength,l=>{l==1?o.value="com":o.value="plat"},{immediate:!0}),(l,n)=>{const c=U("el-tab-pane"),r=U("el-tabs");return V(),z("div",Kl,[v(r,{modelValue:g(o),"onUpdate:modelValue":n[0]||(n[0]=i=>ve(o)?o.value=i:o=i),class:"demo-tabs"},{default:w(()=>[v(c,{label:"平台",name:"plat"},{default:w(()=>[v(Wl,{pannel:g(a)},null,8,["pannel"])]),_:1}),v(c,{label:"组件",name:"com"},{default:w(()=>[l.activeLength==1?(V(),j(Gl,{key:0,active:l.active},null,8,["active"])):me("",!0)]),_:1})]),_:1},8,["modelValue"])])}}});const Ql=G(ql,[["__scopeId","data-v-fba398cd"]]),Zl={class:"container"},en={class:"left"},tn={class:"mid",ref:"midRef"},an={class:"right"},on=B({__name:"App",setup(t){let e=ue({version:"0.1",desc:"描述",width:1e3,height:700,bgColor:void 0,color:void 0,fontSize:void 0,components:[]});try{let f=Eo();ut(e,f)}catch{}let o=L(),a=L();na("pannel",e);let l=X(()=>{var f,u;return(u=(f=e.components)==null?void 0:f.filter)==null?void 0:u.call(f,s=>s.active)});Z(()=>e.width,()=>{var f,u;(u=(f=a.value)==null?void 0:f.update)==null||u.call(f)},{flush:"post"});let n=ue({name1:"哈哈",state:1});setInterval(()=>{n.state=n.state==1?2:1,n.red=n.red=="red"?"green":"red",n.rate=n.rate=="40%"?"100%":"40%"},1e3);const c=f=>{f.preventDefault(),f.stopPropagation();const u=f.dataTransfer.getData("component");let s=JSON.parse(u);const h=o.value.ref.getBoundingClientRect();s&&(s.y=f.clientY-h.y,s.x=f.clientX-h.x,s.self.id=re(),e.components.push(s))},r=f=>{f.preventDefault(),f.dataTransfer.dropEffect="copy"};let i=L(1);const d=()=>{i.value+=1};return(f,u)=>{const s=U("el-scrollbar");return V(),z(J,null,[v(Io,{onRefresh:d}),$("div",Zl,[$("div",en,[v($l,{active:g(l)[0],onDelete:u[0]||(u[0]=h=>d())},null,8,["active"])]),$("div",tn,[v(s,{ref_key:"editScrollRef",ref:a,always:""},{default:w(()=>[(V(),j(Al,{key:g(i),ref_key:"editorRef",ref:o,onDrop:c,onDragover:r,onRefresh:u[1]||(u[1]=h=>d()),pannel:g(e),modelValue:g(n),"onUpdate:modelValue":u[2]||(u[2]=h=>ve(n)?n.value=h:n=h),active:g(l)},null,8,["pannel","modelValue","active"]))]),_:1},512)],512),$("div",an,[v(s,null,{default:w(()=>[v(Ql,{activeLength:g(l).length,active:g(l)[0]},null,8,["activeLength","active"])]),_:1})])])],64)}}});const ln=G(on,[["__scopeId","data-v-3d111329"]]);const Tt=new WeakMap;function nn(t){let e=Tt.get(t);return e||Tt.set(t,e=Object.create(null)),e}function ee(t,e,...o){t&&t.$emit&&t.$emit(e,...o);const a=nn(t)[e];return a&&a.map(l=>l.apply(t,o)),t}function Lt(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Function]"}function Oe(t,e,o,a=1){const l=Math.round(e/a/t[0])*t[0],n=Math.round(o/a/t[1])*t[1];return[l,n]}function Ht(t,e,o){return t-e-o}function Et(t,e,o){return t-e-o}function Q(t,e,o){return e!==null&&t<e?e:o!==null&&o<t?o:t}function je(t,e,o,a,l){const n=Math.PI/180*l,c=Math.cos(n),r=Math.sin(n);let i=o-t,d=a-e;return{x:i*c-d*r+t,y:i*r+d*c+e}}function sn(t,e){let o=Math.atan2(e,t);return o=Math.round(180/Math.PI*o),o<0&&(o=360+o),o}function Ot(t,e,o){let a=t;const l=["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"].find(n=>Lt(a[n]));if(!Lt(a[l]))return!1;do{if(a[l](e))return!0;if(a===o)return!1;a=a.parentNode}while(a);return!1}function rn(t){const e=window.getComputedStyle(t);return[parseFloat(e.getPropertyValue("width"),10),parseFloat(e.getPropertyValue("height"),10)]}function Me(t,e,o){t&&(t.attachEvent?t.attachEvent("on"+e,o):t.addEventListener?t.addEventListener(e,o,!0):t["on"+e]=o)}function he(t,e,o){t&&(t.detachEvent?t.detachEvent("on"+e,o):t.removeEventListener?t.removeEventListener(e,o,!0):t["on"+e]=null)}const Xe={mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"},touch:{start:"touchstart",move:"touchmove",stop:"touchend"}},dn={userSelect:"none",MozUserSelect:"none",WebkitUserSelect:"none",MsUserSelect:"none"},un={userSelect:"auto",MozUserSelect:"auto",WebkitUserSelect:"auto",MsUserSelect:"auto"};let pe=Xe.mouse;var ze={name:"VueDragResizeRotate",props:{className:{type:String,default:"vue-drag-resize-rotate"},classNameDraggable:{type:String,default:"draggable"},classNameResizable:{type:String,default:"resizable"},classNameRotatable:{type:String,default:"rotatable"},classNameDragging:{type:String,default:"dragging"},classNameResizing:{type:String,default:"resizing"},classNameRotating:{type:String,default:"rotating"},classNameActive:{type:String,default:"active"},classNameHandle:{type:String,default:"handle"},disableUserSelect:{type:Boolean,default:!0},enableNativeDrag:{type:Boolean,default:!1},preventDeactivation:{type:Boolean,default:!1},active:{type:Boolean,default:!1},draggable:{type:Boolean,default:!0},resizable:{type:Boolean,default:!0},rotatable:{type:Boolean,default:!1},lockAspectRatio:{type:Boolean,default:!1},outsideAspectRatio:{type:[Number,String],default:0},w:{type:[Number,String],default:200,validator:t=>typeof t=="number"?t>0:t==="auto"},h:{type:[Number,String],default:200,validator:t=>typeof t=="number"?t>0:t==="auto"},minWidth:{type:Number,default:0,validator:t=>t>=0},minHeight:{type:Number,default:0,validator:t=>t>=0},maxWidth:{type:Number,default:1/0,validator:t=>t>=0},maxHeight:{type:Number,default:1/0,validator:t=>t>=0},x:{type:[String,Number],default:0},y:{type:[String,Number],default:0},z:{type:[String,Number],default:"auto",validator:t=>typeof t=="string"?t==="auto":t>=0},r:{type:[String,Number],default:0},handles:{type:Array,default:()=>["tl","tm","tr","mr","br","bm","bl","ml","rot"],validator:t=>{const e=new Set(["tl","tm","tr","mr","br","bm","bl","ml","rot"]);return new Set(t.filter(o=>e.has(o))).size===t.length}},dragHandle:{type:String,default:null},dragCancel:{type:String,default:null},axis:{type:String,default:"both",validator:t=>["x","y","both"].includes(t)},grid:{type:Array,default:()=>[1,1]},parent:{type:[Boolean,String],default:!1},onDragStart:{type:Function,default:()=>!0},onDrag:{type:Function,default:()=>!0},onResizeStart:{type:Function,default:()=>!0},onResize:{type:Function,default:()=>!0},onRotateStart:{type:Function,default:()=>!0},onRotate:{type:Function,default:()=>!0},isConflictCheck:{type:Boolean,default:!1},snap:{type:Boolean,default:!1},snapBorder:{type:Boolean,default:!1},snapTolerance:{type:Number,default:5,validator:function(t){return typeof t=="number"}},scaleRatio:{type:Number,default:1,validator:t=>typeof t=="number"},handleInfo:{type:Object,default:()=>({size:8,offset:-4,switch:!0})}},data:function(){return{left:this.x,top:this.y,right:null,bottom:null,rotate:this.r,width:null,height:null,widthTouched:!1,heightTouched:!1,aspectFactor:null,parentWidth:null,parentHeight:null,minW:this.minWidth,minH:this.minHeight,maxW:this.maxWidth,maxH:this.maxHeight,handle:null,enabled:this.active,resizing:!1,dragging:!1,rotating:!1,zIndex:this.z,lastCenterX:0,lastCenterY:0,parentX:0,parentY:0}},computed:{handleStyle(){return t=>{if(!this.handleInfo.switch)return{display:this.enabled?"block":"none"};if(t==="rot"&&!this.rotatable)return{display:"none"};if(t!=="rot"&&!this.resizable)return{display:"none"};const e=(this.handleInfo.size/this.scaleRatio).toFixed(2),o=(this.handleInfo.offset/this.scaleRatio).toFixed(2),a=(e/2).toFixed(2),l={tl:{top:`${o}px`,left:`${o}px`},tm:{top:`${o}px`,left:`calc(50% - ${a}px)`},tr:{top:`${o}px`,right:`${o}px`},mr:{top:`calc(50% - ${a}px)`,right:`${o}px`},br:{bottom:`${o}px`,right:`${o}px`},bm:{bottom:`${o}px`,right:`calc(50% - ${a}px)`},bl:{bottom:`${o}px`,left:`${o}px`},ml:{top:`calc(50% - ${a}px)`,left:`${o}px`},rot:{top:`-${e*3}px`,left:"50%"}},n={width:l[t].width||`${e}px`,height:l[t].height||`${e}px`,top:l[t].top,left:l[t].left,right:l[t].right,bottom:l[t].bottom},c={tl:0,tm:1,tr:2,mr:3,br:4,bm:5,bl:6,ml:7,rot:8};if(t!=="rot"){const r=["nw-resize","n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize","w-resize"],d=this.rotate+22.5,f=Math.floor(d/45);let u=(c[t]+f)%8;n.cursor=r[u]}return n.display=this.enabled?"block":"none",n}},style(){return{transform:`translate(${this.left}px, ${this.top}px) rotate(${this.rotate}deg)`,width:this.computedWidth,height:this.computedHeight,zIndex:this.zIndex,fontSize:this.handleInfo.size*2+"px",...this.dragging&&this.disableUserSelect?dn:un}},actualHandles(){return!this.resizable&&!this.rotatable?[]:this.handles},computedWidth(){return this.w==="auto"&&!this.widthTouched?"auto":this.width+"px"},computedHeight(){return this.h==="auto"&&!this.heightTouched?"auto":this.height+"px"}},watch:{active(t){this.enabled=t,t?(this.updateParentSize(),ee(this,"activated")):ee(this,"deactivated")},x(t){this.resizing||this.dragging||(this.parent&&(this.bounds=this.calcDragLimits()),this.moveHorizontally(t))},y(t){this.resizing||this.dragging||(this.parent&&(this.bounds=this.calcDragLimits()),this.moveVertically(t))},z(t){(t>=0||t==="auto")&&(this.zIndex=t)},r(t){t>=0&&(this.rotate=t%360)},lockAspectRatio(t){t?this.outsideAspectRatio?this.aspectFactor=this.outsideAspectRatio:this.aspectFactor=this.width/this.height:this.aspectFactor=void 0},outsideAspectRatio(t){t&&(this.aspectFactor=t)},minWidth(t){t>0&&t<=this.width&&(this.minW=t)},minHeight(t){t>0&&t<=this.height&&(this.minH=t)},maxWidth(t){this.maxW=t},maxHeight(t){this.maxH=t},w(t){this.resizing||this.dragging||(this.parent&&(this.bounds=this.calcResizeLimits()),this.changeWidth(t))},h(t){this.resizing||this.dragging||(this.parent&&(this.bounds=this.calcResizeLimits()),this.changeHeight(t))}},created:function(){this.maxWidth&&this.minWidth>this.maxWidth&&console.warn("[Vdr warn]: Invalid prop: minWidth cannot be greater than maxWidth"),this.maxWidth&&this.minHeight>this.maxHeight&&console.warn("[Vdr warn]: Invalid prop: minHeight cannot be greater than maxHeight"),this.elmX=0,this.elmY=0,this.elmW=0,this.elmH=0,this.lastCenterX=0,this.lastCenterY=0,this.fixedXName="",this.fixedYName="",this.fixedX=0,this.fixedY=0,this.TL={},this.TR={},this.BL={},this.BR={},this.resetBoundsAndMouseState()},mounted:function(){this.enableNativeDrag||(this.$el.ondragstart=()=>!1);const[t,e]=this.getParentSize();this.parentWidth=t,this.parentHeight=e;const[o,a]=rn(this.$el);this.aspectFactor=(this.w!=="auto"?this.w:o)/(this.h!=="auto"?this.h:a),this.outsideAspectRatio&&(this.aspectFactor=this.outsideAspectRatio),this.width=this.w!=="auto"?this.w:o,this.height=this.h!=="auto"?this.h:a,this.right=this.parentWidth-this.width-this.left,this.bottom=this.parentHeight-this.height-this.top,this.settingAttribute(),Me(document.documentElement,"mousedown",this.deselect),Me(document.documentElement,"touchend touchcancel",this.deselect),Me(window,"resize",this.checkParentSize)},beforeUnmount:function(){he(document.documentElement,"mousedown",this.deselect),he(document.documentElement,"touchstart",this.handleUp),he(document.documentElement,"mousemove",this.move),he(document.documentElement,"touchmove",this.move),he(document.documentElement,"mouseup",this.handleUp),he(document.documentElement,"touchend touchcancel",this.deselect),he(window,"resize",this.checkParentSize)},methods:{resetBoundsAndMouseState(){this.mouseClickPosition={mouseX:0,mouseY:0,x:0,y:0,w:0,h:0},this.bounds={minLeft:null,maxLeft:null,minRight:null,maxRight:null,minTop:null,maxTop:null,minBottom:null,maxBottom:null}},checkParentSize(){if(this.parent){const[t,e]=this.getParentSize();this.right=t-this.width-this.left,this.bottom=e-this.height-this.top,this.parentWidth=t,this.parentHeight=e}},updateParentSize(){const[t,e]=this.getParentSize();this.parentWidth=t,this.parentHeight=e},getParentSize(){if(this.parent===!0){const t=window.getComputedStyle(this.$el.parentNode,null),e=this.$el.parentNode.getBoundingClientRect();return this.parentX=e.x,this.parentY=e.y,[Math.round(parseFloat(t.getPropertyValue("width"),10)),Math.round(parseFloat(t.getPropertyValue("height"),10))]}if(typeof this.parent=="string"){const t=document.querySelector(this.parent);if(!(t instanceof HTMLElement))throw new Error(`The selector ${this.parent} does not match any element`);return[t.offsetWidth,t.offsetHeight]}return[null,null]},elementTouchDown(t){pe=Xe.touch,this.elementDown(t)},elementMouseDown(t){pe=Xe.mouse,this.elementDown(t)},elementDown(t){if(t instanceof MouseEvent&&t.which!==1)return;const e=t.target||t.srcElement;if(this.$el.contains(e)){if(this.onDragStart(t)===!1)return;if(this.dragHandle&&!Ot(e,this.dragHandle,this.$el)||this.dragCancel&&Ot(e,this.dragCancel,this.$el)){this.dragging=!1;return}this.enabled||(this.enabled=!0,ee(this,"activated"),ee(this,"update:active",!0)),this.draggable&&(this.dragging=!0),this.mouseClickPosition.mouseX=t.touches?t.touches[0].pageX:t.pageX,this.mouseClickPosition.mouseY=t.touches?t.touches[0].pageY:t.pageY,this.mouseClickPosition.left=this.left,this.mouseClickPosition.right=this.right,this.mouseClickPosition.top=this.top,this.mouseClickPosition.bottom=this.bottom,this.mouseClickPosition.width=this.width,this.mouseClickPosition.height=this.height,this.parent&&(this.bounds=this.calcDragLimits()),Me(document.documentElement,pe.move,this.move),Me(document.documentElement,pe.stop,this.handleUp)}},calcDragLimits(){return this.rotatable?{minLeft:-this.width/2,maxLeft:this.parentWidth-this.width/2,minRight:this.width/2,maxRight:this.parentWidth+this.width/2,minTop:-this.height/2,maxTop:this.parentHeight-this.height/2,minBottom:this.height/2,maxBottom:this.parentHeight+this.height/2}:{minLeft:this.left%this.grid[0],maxLeft:Math.floor((this.parentWidth-this.width-this.left)/this.grid[0])*this.grid[0]+this.left,minRight:this.right%this.grid[0],maxRight:Math.floor((this.parentWidth-this.width-this.right)/this.grid[0])*this.grid[0]+this.right,minTop:this.top%this.grid[1],maxTop:Math.floor((this.parentHeight-this.height-this.top)/this.grid[1])*this.grid[1]+this.top,minBottom:this.bottom%this.grid[1],maxBottom:Math.floor((this.parentHeight-this.height-this.bottom)/this.grid[1])*this.grid[1]+this.bottom}},deselect(t){const e=t.target||t.srcElement,o=new RegExp(this.className+"-([trmbl]{2})","");!this.$el.contains(e)&&!o.test(e.className)&&(this.enabled&&!this.preventDeactivation&&(this.enabled=!1,ee(this,"deactivated"),ee(this,"update:active",!1)),he(document.documentElement,pe.move,this.move)),this.resetBoundsAndMouseState()},handleTouchDown(t,e){pe=Xe.touch,this.handleDown(t,e)},handleDown(t,e){if(e instanceof MouseEvent&&e.which!==1||this.onResizeStart(t,e)===!1)return!1;e.stopPropagation&&e.stopPropagation(),this.handle=t,this.handle==="rot"?this.rotating=!0:this.resizing=!0;let{top:o,left:a,width:l,height:n}=this.$el.getBoundingClientRect();this.lastCenterX=window.pageXOffset+a+l/2,this.lastCenterY=window.pageYOffset+o+n/2;let c=this.left,r=this.top,i=this.width,d=this.height,f=c+i/2,u=r+d/2,s=this.rotate;this.TL=je(f,u,c,r,s),this.TR=je(f,u,c+i,r,s),this.BL=je(f,u,c,r+d,s),this.BR=je(f,u,c+i,r+d,s),this.mouseClickPosition.mouseX=e.touches?e.touches[0].pageX:e.pageX,this.mouseClickPosition.mouseY=e.touches?e.touches[0].pageY:e.pageY,this.mouseClickPosition.left=this.left,this.mouseClickPosition.right=this.right,this.mouseClickPosition.top=this.top,this.mouseClickPosition.bottom=this.bottom,this.mouseClickPosition.width=this.width,this.mouseClickPosition.height=this.height,this.bounds=this.calcResizeLimits(),Me(document.documentElement,pe.move,this.move),Me(document.documentElement,pe.stop,this.handleUp)},calcResizeLimits(){let t=this.minW,e=this.minH,o=this.maxW,a=this.maxH;const[l,n]=this.grid,c=this.width,r=this.height,i=this.left,d=this.top,f=this.right,u=this.bottom;o=o-o%l,a=a-a%n;const s={minLeft:null,maxLeft:null,minTop:null,maxTop:null,minRight:null,maxRight:null,minBottom:null,maxBottom:null};return this.parent?(s.minLeft=i,s.maxLeft=i+Math.floor((c-t)/l),s.minTop=d,s.maxTop=d+Math.floor((r-e)/n),s.minRight=f,s.maxRight=f+Math.floor((c-t)/l),s.minBottom=u,s.maxBottom=u+Math.floor((r-e)/n),o&&(s.minLeft=Math.max(s.minLeft,this.parentWidth-f-o),s.minRight=Math.max(s.minRight,this.parentWidth-i-o)),a&&(s.minTop=Math.max(s.minTop,this.parentHeight-u-a),s.minBottom=Math.max(s.minBottom,this.parentHeight-d-a))):(s.minLeft=null,s.maxLeft=i+Math.floor(c-t),s.minTop=null,s.maxTop=d+Math.floor(r-e),s.minRight=null,s.maxRight=f+Math.floor(c-t),s.minBottom=null,s.maxBottom=u+Math.floor(r-e),o&&(s.minLeft=-(f+o),s.minRight=-(i+o)),a&&(s.minTop=-(u+a),s.minBottom=-(d+a)),this.lockAspectRatio&&o&&a&&(s.minLeft=Math.min(s.minLeft,-(f+o)),s.minTop=Math.min(s.minTop,-(a+u)),s.minRight=Math.min(s.minRight,-i-o),s.minBottom=Math.min(s.minBottom,-d-a))),s},move(t){this.resizing?this.handleResize(t):this.dragging?this.handleDrag(t):this.rotating&&this.handleRotate(t)},getMouseCoordinate(t){return t.type.indexOf("touch")!==-1?{x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY}:{x:t.pageX||t.clientX+document.documentElement.scrollLeft,y:t.pageY||t.clientY+document.documentElement.scrollTop}},handleRotate(t){const{x:e,y:o}=this.getMouseCoordinate(t),a=e-this.lastCenterX,l=o-this.lastCenterY;this.rotate=(sn(a,l)+90)%360,ee(this,"rotating",this.rotate)},async handleDrag(t){const e=this.axis,o=this.grid,a=this.bounds,l=this.mouseClickPosition,n=e&&e!=="y"?l.mouseX-(t.touches?t.touches[0].pageX:t.pageX):0,c=e&&e!=="x"?l.mouseY-(t.touches?t.touches[0].pageY:t.pageY):0,[r,i]=Oe(o,n,c,this.scaleRatio),d=Q(l.left-r,a.minLeft,a.maxLeft),f=Q(l.top-i,a.minTop,a.maxTop);if(this.onDrag(d,f)===!1)return;const u=Q(l.right+r,a.minRight,a.maxRight),s=Q(l.bottom+i,a.minBottom,a.maxBottom);this.left=d,this.top=f,this.right=u,this.bottom=s,await this.snapCheck(),ee(this,"dragging",this.left,this.top)},moveHorizontally(t){const[e]=Oe(this.grid,t,this.top,this.scale),o=Q(e,this.bounds.minLeft,this.bounds.maxLeft);this.left=o,this.right=this.parentWidth-this.width-o},moveVertically(t){const[,e]=Oe(this.grid,this.left,t,this.scale),o=Q(e,this.bounds.minTop,this.bounds.maxTop);this.top=o,this.bottom=this.parentHeight-this.height-o},handleResize(t){const e=this.handle,o=this.scaleRatio,{TL:a,TR:l,BL:n,BR:c}=this;let{x:r,y:i}=this.getMouseCoordinate(t);!this.rotatable&&this.parent&&(r=Q(r,this.parentX,this.parentX+this.parentWidth*o),i=Q(i,this.parentY,this.parentY+this.parentHeight*o));let d=r-this.mouseClickPosition.mouseX,f=i-this.mouseClickPosition.mouseY;d=d/o,f=f/o;let u,s,h,p,y,_,C,H,S,b={},x={},k={},m={},R={},E={},P={},O={};if(e.includes("m")){switch(e){case"tm":u=d+(a.x+l.x)/2,s=f+(a.y+l.y)/2,b=n,x=a,k=c,m={x:u-b.x,y:s-b.y},R={x:x.x-b.x,y:x.y-b.y},h=(m.x*R.x+m.y*R.y)/(Math.pow(R.x,2)+Math.pow(R.y,2)),P={x:k.x-b.x,y:k.y-b.y},O={x:R.x*h,y:R.y*h};break;case"bm":u=d+(n.x+c.x)/2,s=f+(n.y+c.y)/2,b=a,x=n,k=l,m={x:u-b.x,y:s-b.y},R={x:x.x-b.x,y:x.y-b.y},h=(m.x*R.x+m.y*R.y)/(Math.pow(R.x,2)+Math.pow(R.y,2)),P={x:k.x-b.x,y:k.y-b.y},O={x:R.x*h,y:R.y*h};break;case"ml":u=d+(a.x+n.x)/2,s=f+(a.y+n.y)/2,b=c,x=n,k=l,m={x:u-b.x,y:s-b.y},R={x:x.x-b.x,y:x.y-b.y},h=(m.x*R.x+m.y*R.y)/(Math.pow(R.x,2)+Math.pow(R.y,2)),O={x:k.x-b.x,y:k.y-b.y},P={x:R.x*h,y:R.y*h};break;case"mr":u=d+(l.x+l.x)/2,s=f+(l.y+l.y)/2,b=n,x=c,k=a,m={x:u-b.x,y:s-b.y},R={x:x.x-b.x,y:x.y-b.y},h=(m.x*R.x+m.y*R.y)/(Math.pow(R.x,2)+Math.pow(R.y,2)),O={x:k.x-b.x,y:k.y-b.y},P={x:R.x*h,y:R.y*h};break}_=b.x+(P.x+O.x)/2,C=b.y+(P.y+O.y)/2,H=Math.sqrt(Math.pow(P.x,2)+Math.pow(P.y,2)),S=Math.sqrt(Math.pow(O.x,2)+Math.pow(O.y,2))}else{switch(e){case"tl":u=d+a.x,s=f+a.y,b=c,x=n,k=l;break;case"tr":u=d+l.x,s=f+l.y,b=n,x=c,k=a;break;case"bl":u=d+n.x,s=f+n.y,b=l,x=a,k=c;break;case"br":u=d+c.x,s=f+c.y,b=a,x=l,k=n;break}m={x:u-b.x,y:s-b.y},R={x:x.x-b.x,y:x.y-b.y},E={x:k.x-b.x,y:k.y-b.y},p=(m.x*R.x+m.y*R.y)/(Math.pow(R.x,2)+Math.pow(R.y,2)),y=(m.x*E.x+m.y*E.y)/(Math.pow(E.x,2)+Math.pow(E.y,2)),P={x:R.x*p,y:R.y*p},O={x:E.x*y,y:E.y*y},_=b.x+(P.x+O.x)/2,C=b.y+(P.y+O.y)/2,H=Math.sqrt(Math.pow(P.x,2)+Math.pow(P.y,2)),S=Math.sqrt(Math.pow(O.x,2)+Math.pow(O.y,2))}this.left=_-H/2,this.top=C-S/2,H=Q(H,this.minW||0,this.maxW),S=Q(S,this.minH||0,this.maxH),this.parent&&(H=Q(H,0,this.parentWidth),S=Q(S,0,this.parentHeight)),this.lockAspectRatio&&(console.log(this.lockAspectRatio,this.aspectFactor),H/S>this.aspectFactor?H=S*this.aspectFactor:S=H/this.aspectFactor),this.width=H,this.height=S,ee(this,"resizing",this.left,this.top,this.width,this.height)},changeWidth(t){const[e]=Oe(this.grid,t,0,this.scale),o=this.parentWidth-e-this.left;let a=this.bottom;this.lockAspectRatio&&(a=this.bottom-(this.right-o)/this.aspectFactor);const l=Ht(this.parentWidth,this.left,o),n=Et(this.parentHeight,this.top,a);this.right=o,this.bottom=a,this.width=l,this.height=n},changeHeight(t){const[,e]=Oe(this.grid,0,t,this.scale),o=this.parentHeight-e-this.top;let a=this.right;this.lockAspectRatio&&(a=this.right-(this.bottom-o)*this.aspectFactor);const l=Ht(this.parentWidth,this.left,a),n=Et(this.parentHeight,this.top,o);this.right=a,this.bottom=o,this.width=l,this.height=n},async handleUp(t){this.handle=null;const e=new Array(3).fill({display:!1,position:"",origin:"",lineLength:""}),o={vLine:[],hLine:[]};for(const n in o)o[n]=JSON.parse(JSON.stringify(e));const{x:a,y:l}=this.getMouseCoordinate(t);this.lastMouseX=a,this.lastMouseY=l,this.resizing&&(this.resizing=!1,await this.conflictCheck(),ee(this,"refLineParams",o),ee(this,"resizestop",this.left,this.top,this.width,this.height)),this.dragging&&(this.dragging=!1,await this.conflictCheck(),ee(this,"refLineParams",o),ee(this,"dragstop",this.left,this.top)),this.rotating&&(this.rotating=!1,ee(this,"rotatestop",this.rotate)),this.resetBoundsAndMouseState(),he(document.documentElement,pe.move,this.move)},settingAttribute(){this.$el.setAttribute("data-is-check",`${this.isConflictCheck}`),this.$el.setAttribute("data-is-snap",`${this.snap}`)},conflictCheck(){const t=this.top,e=this.left,o=this.width,a=this.height;if(this.isConflictCheck){const l=this.$el.parentNode.childNodes;for(const n of l)if(n.className!==void 0&&!n.className.split(" ").includes(this.classNameActive)&&n.getAttribute("data-is-check")!==null&&n.getAttribute("data-is-check")!=="false"){const c=n.offsetWidth,r=n.offsetHeight,[i,d]=this.formatTransformVal(n.style.transform),f=t>=d&&e>=i&&d+r>t&&i+c>e||t<=d&&e<i&&t+a>d&&e+o>i,u=e<=i&&t>=d&&e+o>i&&t<d+r||t<d&&e>i&&t+a>d&&e<i+c,s=t<=d&&e>=i&&t+a>d&&e<i+c||t>=d&&e<=i&&t<d+r&&e>i+c,h=t<=d&&e>=i&&t+a>d&&e<i+c||t>=d&&e<=i&&t<d+r&&e>i+c,p=e>=i&&t>=d&&e<i+c&&t<d+r||t>d&&e<=i&&e+o>i&&t<d+r,y=t<=d&&e>=i&&t+a>d&&e<i+c||t>=d&&e<=i&&t<d+r&&e+o>i;(f||u||s||h||p||y)&&(this.top=this.mouseClickPosition.top,this.left=this.mouseClickPosition.left,this.width=this.mouseClickPosition.width,this.height=this.mouseClickPosition.height)}}},async snapCheck(){if(this.snap){let t=this.width,e=this.height,o=this.left,a=this.left+t,l=this.top,n=this.top+e;const c=new Array(3).fill({display:!1,position:"",origin:"",lineLength:""}),r={vLine:[],hLine:[]};for(const y in r)r[y]=JSON.parse(JSON.stringify(c));const i={value:{x:[[],[],[]],y:[[],[],[]]},display:[],position:[]},d=this.$el.parentNode.childNodes,{groupWidth:f,groupHeight:u,groupLeft:s,groupTop:h,bln:p}=await this.getActiveAll(d);p||(t=f,e=u,o=s,a=s+f,l=h,n=h+u);for(const y of d)if(y.className!==void 0&&!y.className.split(" ").includes(this.classNameActive)&&y.getAttribute("data-is-snap")!==null&&y.getAttribute("data-is-snap")!=="false"){const[_,C,H]=this.formatTransformVal(y.style.transform);if((H-this.rotate)%90===0){const S=y.offsetWidth,b=y.offsetHeight,x=_+S,k=C+b,m=Math.abs(l+e/2-(C+b/2))<=this.snapTolerance,R=Math.abs(o+t/2-(_+S/2))<=this.snapTolerance,E=Math.abs(C-n)<=this.snapTolerance,P=Math.abs(k-n)<=this.snapTolerance,O=Math.abs(C-l)<=this.snapTolerance,F=Math.abs(k-l)<=this.snapTolerance,fe=Math.abs(_-a)<=this.snapTolerance,_e=Math.abs(x-a)<=this.snapTolerance,we=Math.abs(_-o)<=this.snapTolerance,xe=Math.abs(x-o)<=this.snapTolerance;i.display=[E,P,O,F,m,m,fe,_e,we,xe,R,R],i.position=[C,k,C,k,C+b/2,C+b/2,_,x,_,x,_+S/2,_+S/2],p&&(E&&(this.top=C-e,this.bottom=this.parentHeight-this.top-e,i.value.y[0].push(_,x,o,a)),O&&(this.top=C,this.bottom=this.parentHeight-this.top-e,i.value.y[0].push(_,x,o,a)),P&&(this.top=k-e,this.bottom=this.parentHeight-this.top-e,i.value.y[1].push(_,x,o,a)),F&&(this.top=k,this.bottom=this.parentHeight-this.top-e,i.value.y[1].push(_,x,o,a)),fe&&(this.left=_-t,this.right=this.parentWidth-this.left-t,i.value.x[0].push(C,k,l,n)),we&&(this.left=_,this.right=this.parentWidth-this.left-t,i.value.x[0].push(C,k,l,n)),_e&&(this.left=x-t,this.right=this.parentWidth-this.left-t,i.value.x[1].push(C,k,l,n)),xe&&(this.left=x,this.right=this.parentWidth-this.left-t,i.value.x[1].push(C,k,l,n)),m&&(this.top=C+b/2-e/2,this.bottom=this.parentHeight-this.top-e,i.value.y[2].push(_,x,o,a)),R&&(this.left=_+S/2-t/2,this.right=this.parentWidth-this.left-t,i.value.x[2].push(C,k,l,n)),this.snapBorder&&(Math.abs(this.left-0)<=this.snapTolerance&&(this.left=0,this.right=this.parentWidth-this.left-t),Math.abs(this.right-0)<=this.snapTolerance&&(this.right=0,this.left=this.parentWidth-this.width-this.right),Math.abs(this.top-0)<=this.snapTolerance&&(this.top=0,this.bottom=this.parentHeight-this.top-e),Math.abs(this.bottom-0)<=this.snapTolerance&&(this.bottom=0,this.top=this.parentHeight-this.bottom-e)));let K=this.bounds;this.left=Q(this.left,K.minLeft,K.maxLeft),this.top=Q(this.top,K.minTop,K.maxTop),this.right=Q(this.right,K.minRight,K.maxRight),this.bottom=Q(this.bottom,K.minBottom,K.maxBottom);const ne=[0,1,0,1,2,2,0,1,0,1,2,2];for(let q=0;q<=ne.length;q++){const M=q<6?"y":"x",T=q<6?"hLine":"vLine";if(i.display[q]){const{origin:Y,length:A}=this.calcLineValues(i.value[M][ne[q]]);r[T][ne[q]].display=i.display[q],r[T][ne[q]].position=i.position[q]+"px",r[T][ne[q]].origin=Y,r[T][ne[q]].lineLength=A}}}}ee(this,"refLineParams",r)}},calcLineValues(t){const e=Math.max(...t)-Math.min(...t)+"px",o=Math.min(...t)+"px";return{length:e,origin:o}},async getActiveAll(t){const e=[],o=[],a=[];let l=0,n=0,c=0,r=0;for(const f of t)f.className!==void 0&&f.className.split(" ").includes(this.classNameActive)&&e.push(f);const i=e.length;if(i>1){for(const f of e){const u=f.offsetLeft,s=u+f.offsetWidth,h=f.offsetTop,p=h+f.offsetHeight;o.push(u,s),a.push(h,p)}l=Math.max(...o)-Math.min(...o),n=Math.max(...a)-Math.min(...a),c=Math.min(...o),r=Math.min(...a)}return{groupWidth:l,groupHeight:n,groupLeft:c,groupTop:r,bln:i===1}},formatTransformVal(t){let[e,o,a=0]=t.match(/[\d|.]+/g);return o===void 0&&(o=0),[Number(e),Number(o),a]}},emits:["update:active","rotating","dragging","resizing","refLineParams","resizestop","dragstop","rotatestop","activated","deactivated"]};const cn=["onMousedown","onTouchstart"];function fn(t,e,o,a,l,n){return V(),z("div",{style:te(n.style),class:de([{[o.classNameActive]:t.enabled,[o.classNameDragging]:t.dragging,[o.classNameResizing]:t.resizing,[o.classNameDraggable]:o.draggable,[o.classNameResizable]:o.resizable,[o.classNameRotating]:t.rotating,[o.classNameRotatable]:o.rotatable},o.className]),onMousedown:e[0]||(e[0]=(...c)=>n.elementMouseDown&&n.elementMouseDown(...c)),onTouchstart:e[1]||(e[1]=(...c)=>n.elementTouchDown&&n.elementTouchDown(...c))},[(V(!0),z(J,null,le(n.actualHandles,(c,r)=>(V(),z("div",{key:r,class:de([o.classNameHandle,o.classNameHandle+"-"+c]),style:te(n.handleStyle(c,r)),onMousedown:Se(i=>n.handleDown(c,i),["stop","prevent"]),onTouchstart:Se(i=>n.handleTouchDown(c,i),["stop","prevent"])},[Ye(t.$slots,c)],46,cn))),128)),Ye(t.$slots,"default")],38)}ze.render=fn;ze.__scopeId="data-v-3c286975";ze.__file="src/components/vue-drag-resize-rotate/index.vue";function st(t){st.installed||(st.installed=!0,t.component("VueDragResizeRotate",ze))}ze.install=st;const ht=ia(ln);ht.use(ua);ht.use(ze);ht.mount("#app");
