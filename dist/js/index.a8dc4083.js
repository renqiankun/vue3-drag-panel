import{G as B,a as T,ag as O,l as C,M as N,O as x,H as Ye,a5 as Zt,P as it,p as I,K as ye,S as W,T as se,V as Bt,d as ve,n as Pe,m as R,F as J,a7 as oe,I as ue,J as Z,u as g,a2 as Me,Q as Ie,b as ee,aw as fe,e as X,ax as Dt,r as Pt,X as ea,g as ta,o as aa,s as It,Z as ce,c as oa,U as v,A as be,z as Ke,Y as $t,R as ge,ay as la,az as na,E as ia,as as sa}from"./base-module.a8b61ce6.js";import{E as De,d as ra,a as da,c as ua,i as ca}from"./element-plus.fccf1f22.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function o(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(n){if(n.ep)return;n.ep=!0;const l=o(n);fetch(n.href,l)}})();const fa=["accept"],je=B({__name:"index",props:{accept:{default:""},maxSize:{default:1/0},text:{default:"上传文件"},preCheck:{}},emits:["change"],setup(t,{emit:e}){const o=t;let a=T("");const n=async c=>{var p,b;var r=((b=(p=c.target)==null?void 0:p.files)==null?void 0:b[0])??{};try{c.target.value=""}catch{}let i=r.name,d=r.size,f=o.maxSize,u=i.lastIndexOf("."),s=i.slice(u),h=o.accept.split(",");if(h.length>0&&h.indexOf(s)<=-1)return De.error("文件格式错误，请重新上传!"),!1;if(d>f)return De.error("文件不可大于10M");e("change",r)},l=async()=>{var r,i,d;if(o.preCheck){var c=await((r=o.preCheck)==null?void 0:r.call(o));if(!c)return}(d=(i=a.value).click)==null||d.call(i)};return(c,r)=>{const i=O("el-button");return C(),N(i,ye({type:"primary",plain:"",onClick:l},c.$attrs),{default:x(()=>[Ye(c.$slots,"default",{},()=>[W(se(c.text),1)]),(C(),N(Zt,{to:"body"},[it(I("input",{type:"file",ref_key:"uploadRef",ref:a,onChange:n,accept:c.accept},null,40,fa),[[Bt,!1]])]))]),_:3},16)}}});(function(){try{if(typeof document<"u"){var t=document.createElement("style");t.appendChild(document.createTextNode(".group-wrap[data-v-a7d365c4]{position:absolute;left:0;top:0;width:100%;height:100}.group-wrap .group-item[data-v-a7d365c4]{position:absolute}.custom-image[data-v-51bcdfe3]{color:var(--35be3580);background-color:var(--7a3808fb);padding:var(--565e2eee);border-radius:var(--ca4fabd6)}.text-wrap[data-v-8233b39d]{height:100%;color:var(--46dd5ff7);background-color:var(--7f931c9c);padding:var(--c746d0b6);border-radius:var(--a4c36304);font-size:var(--522c9048);border:var(--27fc0faa);word-break:break-all}.text-wrap[data-v-b9e7c0b0]{color:var(--00cd0a69);background-color:var(--863570b8);padding:var(--cde924d2);border-radius:var(--31a3f24c);font-size:var(--7015a02a);border:var(--aedef5c6);word-break:break-all;white-space:var(--ba981f16);overflow:var(--58ddca96);text-overflow:var(--6b9be9da)}.icon-wrap[data-v-6b52c610]{color:var(--46bf371c);stroke:var(--46bf371c);fill:var(--5a1a592f);background-color:var(--1d6b7926);padding:var(--651f2d40);border-radius:var(--5f884d3a);font-size:var(--6f5fc4fe)}.icon-wrap.color-self[data-v-6b52c610] *{color:var(--46bf371c);stroke:var(--46bf371c);fill:var(--5a1a592f)}.img-scale-wrap[data-v-321d426b]{position:relative;width:100%;height:100%;color:var(--ef6c025e);background-color:var(--58f6c20c);padding:var(--351ce7ff);border-radius:var(--cc74ea38)}.img-scale-wrap .img-scale-reduce[data-v-321d426b]{position:absolute;overflow:hidden;width:100%;height:100%;transition:.1s}.img-scale-wrap .img-scale[data-v-321d426b]{display:block;position:absolute;width:100%;height:100%}.drag-editor-preivew-wrap[data-v-b2568ace]{width:100%;height:100%;min-width:200px;min-height:200px}.drag-editor-preivew[data-v-b2568ace]{width:100%;height:100%}.drag-editor-preivew[data-v-b2568ace] .handle{display:none!important}.preview-item-wrap[data-v-b2568ace]{touch-action:none;position:absolute;box-sizing:border-box;-webkit-user-select:none;user-select:none}")),document.head.appendChild(t)}}catch(e){console.error("vite-plugin-css-injected-by-js",e)}})();const ha=Object.freeze(Object.defineProperty({__proto__:null,get default(){return Oe}},Symbol.toStringTag,{value:"Module"}));function Le(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>(t==="x"?Math.random()*16|0:"r&0x3"|"0x8").toString(16))}const Wt=(t,e)=>{let o=t.self,a=o.activeValue,n=o.prop,l=o.activeMode,c=o.activeMap;if(!n||!l||!c)return o;let r=!1;switch(l){case"大于":e[n]>a&&(r=!0);break;case"小于":e[n]<a&&(r=!0);break;case"等于":e[n]==a&&(r=!0);break;case"不等于":e[n]!=a&&(r=!0);break;case"大于等于":e[n]>=a&&(r=!0);break;case"小于等于":e[n]<a&&(r=!0);break;case"存在":e[n]!==void 0&&e[n]!==null&&(r=!0);break;case"不存在":e[n]===void 0&&e[n]===null&&(r=!0);break}let i={};return r&&(i=pa(c,e)),{...o,...i}},pa=(t,e)=>{let o={},a=/\$\{(.*?)\}/g;try{o=JSON.parse(t);for(var n in o){let l=o[n];if(a.test(l)){let c=l.replace(/[\$|{|}]/g,"");o[n]=(e==null?void 0:e[c])??void 0}}}catch(l){console.error("解析 activeMap 失败",l)}return o},ma={class:"group-wrap"},ga=["a"],va=B({__name:"index",props:{data:{},modelValue:{default:()=>({})},groupModel:{default:()=>({})},disabled:{type:Boolean}},setup(t){const e=t,o=l=>Nt(l).default,a=l=>({width:l.w=="auto"?l.w:l.w+"px",height:l.h=="auto"?l.h:l.h+"px",transform:`translate(${l.x}px, ${l.y}px) rotate(${l.r||0}deg)`}),n=l=>Wt(l,e.groupModel);return(l,c)=>(C(),R("div",ma,[(C(!0),R(J,null,oe(l.data.group,r=>(C(),R("div",{a:r.active,class:"group-item",style:Z(a(r))},[(C(),N(Ie(o(r.self.name)),ye({data:r,h:r.h,w:r.w},n(r),{modelValue:l.groupModel[r.self.modelValue],"onUpdate:modelValue":i=>l.groupModel[r.self.modelValue]=i,defaultModelValue:r.self.defaultModelValue,"onUpdate:defaultModelValue":i=>r.self.defaultModelValue=i,disabled:!0}),null,16,["data","h","w","modelValue","onUpdate:modelValue","defaultModelValue","onUpdate:defaultModelValue"]))],12,ga))),256))]))}}),Se=(t,e)=>{const o=t.__vccOpts||t;for(const[a,n]of e)o[a]=n;return o},ba=Se(va,[["__scopeId","data-v-a7d365c4"]]),ya=Object.freeze(Object.defineProperty({__proto__:null,default:ba},Symbol.toStringTag,{value:"Module"})),_a=["width","height","src"],wa=B({__name:"index",props:{url:{},w:{},h:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""}},setup(t){const e=t;fe(a=>({"35be3580":a.color,"7a3808fb":a.bgColor,"565e2eee":a.padding,ca4fabd6:a.radius})),ee(()=>[e.w,e.h],()=>o()),ve(()=>{o()});const o=()=>{};return(a,n)=>(C(),R("img",{class:"custom-image",width:a.w,height:a.h,src:a.url,alt:""},null,8,_a))}}),xa=Se(wa,[["__scopeId","data-v-51bcdfe3"]]),Va=Object.freeze(Object.defineProperty({__proto__:null,default:xa},Symbol.toStringTag,{value:"Module"})),Ma=B({__name:"index",props:{url:{},w:{},h:{},flip:{}},setup(t){const e=t;let o=T(),a="",n=!0,l="";ee(()=>[e.w,e.h],()=>c()),ee(()=>{var i,d;return[(i=e.flip)==null?void 0:i.horizontal,(d=e.flip)==null?void 0:d.vertical]},()=>r()),ve(()=>{a=o.value.getContext("2d"),c()});const c=()=>{let i=e.w,d=e.h;o.value.width=i,o.value.height=d,n?(n=!1,l=document.createElement("img"),l.src=e.url,l.onload=()=>{a.drawImage(l,0,0,i,d),r()}):r()},r=()=>{const{vertical:i,horizontal:d}=e.flip??{};let f=e.w,u=e.h;const s=d?-1:1,h=i?-1:1;a.clearRect(0,0,f,u),a.translate(f/2-f*s/2,u/2-u*h/2),a.scale(s,h),a.drawImage(l,0,0,f,u),a.setTransform(1,0,0,1,0,0)};return(i,d)=>(C(),R("canvas",{ref_key:"canvas",ref:o},null,512))}}),Sa=Object.freeze(Object.defineProperty({__proto__:null,default:Ma},Symbol.toStringTag,{value:"Module"})),Ca={class:"text-wrap"},ka=B({__name:"index",props:{modelValue:{default:""},defaultModelValue:{default:""},data:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""},fontSize:{default:""},borderColor:{default:""},w:{},h:{}},setup(t){return fe(e=>({"46dd5ff7":e.color,"7f931c9c":e.bgColor,c746d0b6:e.padding,a4c36304:e.radius,"522c9048":e.fontSize,"27fc0faa":e.borderColor})),(e,o)=>(C(),R("div",Ca,se(e.modelValue||e.defaultModelValue),1))}}),Ra=Se(ka,[["__scopeId","data-v-8233b39d"]]),Aa=Object.freeze(Object.defineProperty({__proto__:null,default:Ra},Symbol.toStringTag,{value:"Module"})),za=["contenteditable"],Ta=B({__name:"index",props:{modelValue:{default:""},defaultModelValue:{},data:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""},fontSize:{default:""},borderColor:{default:""},w:{},h:{},noWordWrap:{type:Boolean,default:!1},overEllipsis:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},hasModelValue:{type:Boolean}},emits:["update:modelValue","update:defaultModelValue","click"],setup(t,{emit:e}){const o=t;fe(d=>({"00cd0a69":d.color,"863570b8":d.bgColor,cde924d2:d.padding,"31a3f24c":d.radius,"7015a02a":d.fontSize,aedef5c6:d.borderColor,ba981f16:d.noWordWrap?"nowrap":"","58ddca96":d.overEllipsis?"hidden":"auto","6b9be9da":d.overEllipsis?"ellipsis":"unset"}));let a=T(!1),n=T();const l=async()=>{o.disabled||(a.value=!0,c(n.value),await Pe(),n.value.focus())},c=d=>{const f=window.getSelection(),u=document.createRange();u.selectNodeContents(d),f.removeAllRanges(),f.addRange(u)},r=()=>{a.value=!1},i=d=>{o.hasModelValue&&e("update:modelValue",d.target.innerText),e("update:defaultModelValue",d.target.innerText)};return(d,f)=>(C(),R("div",{contenteditable:g(a),onBlur:r,onInput:i,ref_key:"text",ref:n,class:ue({"text-wrap":!0,"can-edit":g(a)}),onDblclick:l},se(d.modelValue||d.defaultModelValue),43,za))}}),La=Se(Ta,[["__scopeId","data-v-b9e7c0b0"]]),Ha=Object.freeze(Object.defineProperty({__proto__:null,default:La},Symbol.toStringTag,{value:"Module"})),Ea=["innerHTML"],Ua=B({__name:"index",props:{url:{},color:{default:""},bgColor:{default:""},fillColor:{default:""},padding:{default:""},radius:{default:""},fontSize:{default:""},iconUseSelfColor:{type:Boolean}},setup(t){return fe(e=>({"46bf371c":e.color,"5a1a592f":e.fillColor,"1d6b7926":e.bgColor,"651f2d40":e.padding,"5f884d3a":e.radius,"6f5fc4fe":e.fontSize})),(e,o)=>(C(),R("div",{class:ue({"icon-wrap":!0,"color-self":e.iconUseSelfColor}),innerHTML:e.url},null,10,Ea))}}),Oa=Se(Ua,[["__scopeId","data-v-6b52c610"]]),Ba=Object.freeze(Object.defineProperty({__proto__:null,default:Oa},Symbol.toStringTag,{value:"Module"})),Da={class:"img-scale-wrap"},Pa=["src"],Ia=B({__name:"index",props:{url:{},w:{},h:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""},lockAspectRatio:{type:Boolean,default:!1},position:{default:"left"},imgWidth:{},imgHeight:{}},setup(t){const e=t;fe(n=>({ef6c025e:n.color,"58f6c20c":n.bgColor,"351ce7ff":n.padding,cc74ea38:n.radius}));let o=X(()=>({[e.position]:0,width:e.imgWidth,height:e.imgHeight})),a=X(()=>({[e.position]:0,width:e.lockAspectRatio?e.w+"px":void 0,height:e.lockAspectRatio?e.h+"px":void 0}));return(n,l)=>(C(),R("div",Da,[I("div",{class:"img-scale-reduce",style:Z(g(o))},[I("img",{class:"img-scale",src:n.url,alt:"",style:Z(g(a))},null,12,Pa)],4)]))}}),$a=Se(Ia,[["__scopeId","data-v-321d426b"]]),Wa=Object.freeze(Object.defineProperty({__proto__:null,default:$a},Symbol.toStringTag,{value:"Module"}));let Na=Object.assign({"./Group/index.vue":ya,"./Image/index.vue":Va,"./Picture/index.vue":Sa,"./Shape/index.vue":Aa,"./Text/index.vue":Ha,"./icon-svg/index.vue":Ba,"./img-scale/index.vue":Wa,"./preview/index.vue":ha});const Nt=t=>Na[`./${t}/index.vue`];Le(),Le(),Le(),Le(),Le();const ja=B({name:"dragPannelPreview"}),Fa=B({...ja,props:{pannel:{},modelValue:{default:()=>({})},disabled:{type:Boolean,default:!1},parentWidth:{default:0}},emits:["click"],setup(t,{emit:e}){const o=t;let a=T(),n=T({});ve(()=>{c()});const l=u=>({width:u.w==="auto"?u.w:u.w+"px",height:u.h==="auto"?u.h:u.h+"px",fontSize:o.pannel.fontSize||u.fontSize,zIndex:u.z||"auto",transform:`translate(${u.x||0}px, ${u.y||0}px) rotate(${u.r||0}deg)`}),c=async()=>{await Pe();let u={transformOrigin:"0% 0%",width:o.pannel.width+"px",height:o.pannel.height+"px",color:o.pannel.color,fontSize:o.pannel.fontSize,backgroundColor:o.pannel.bgColor},s=a.value.getBoundingClientRect(),{endRate:h,translateX:p,translateY:b}=r(s.width,s.height);n.value={...u,transform:`translate(${p}px, ${b}px) scale(${h})`}},r=(u,s)=>{let h=u/o.pannel.width,p=s/o.pannel.height,b=h>p?p:h,y=h<=p?0:u*b,k=p<=h?0:s*b;return{endRate:b,translateX:y>0?u/2-o.pannel.width/2*b:y,translateY:k>0?s/2-o.pannel.height/2*b:k}},i=u=>Nt(u).default,d=u=>{u.self.click&&(console.log("click"),e("click",u))},f=u=>Wt(u,o.modelValue);return(u,s)=>(C(),R("div",{ref_key:"wrapRef",ref:a,class:"drag-editor-preivew-wrap"},[I("div",{class:ue({"drag-editor-preivew":!0}),style:Z(g(n))},[(C(!0),R(J,null,oe(u.pannel.components,h=>(C(),R("div",{class:"preview-item-wrap",style:Z(l(h))},[(C(),N(Ie(i(h.self.name)),ye({data:h,h:h.h,w:h.w},f(h),{onClickCapture:Me(p=>d(h),["self"]),modelValue:u.modelValue[h.self.modelValue],"onUpdate:modelValue":p=>u.modelValue[h.self.modelValue]=p,defaultModelValue:h.self.defaultModelValue,"onUpdate:defaultModelValue":p=>h.self.defaultModelValue=p,groupModel:u.modelValue,disabled:!0}),null,16,["data","h","w","onClickCapture","modelValue","onUpdate:modelValue","defaultModelValue","onUpdate:defaultModelValue","groupModel"]))],4))),256))],4)],512))}}),Oe=Se(Fa,[["__scopeId","data-v-b2568ace"]]);Oe.install=t=>{t.component(Oe.name,Oe)};let jt={snap:!0,snapTolerance:5,parent:!0,debug:!1,rotatable:!0,r:0,active:!1,preventDeactivation:!1,resizable:!0,lockAspectRatio:!0},Be=T(1);T(500);T(1200);function ne(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>(t==="x"?Math.random()*16|0:"r&0x3"|"0x8").toString(16))}const st=(t,e)=>{let o=t.self,a=o.activeValue,n=o.prop,l=o.activeMode,c=o.activeMap;if(!n||!l||!c)return o;let r=!1;switch(l){case"大于":e[n]>a&&(r=!0);break;case"小于":e[n]<a&&(r=!0);break;case"等于":e[n]==a&&(r=!0);break;case"不等于":e[n]!=a&&(r=!0);break;case"大于等于":e[n]>=a&&(r=!0);break;case"小于等于":e[n]<a&&(r=!0);break;case"存在":e[n]!==void 0&&e[n]!==null&&(r=!0);break;case"不存在":e[n]===void 0&&e[n]===null&&(r=!0);break}let i={};return r&&(i=Xa(c,e)),{...o,...i}},Xa=(t,e)=>{let o={},a=/\$\{(.*?)\}/g;try{o=JSON.parse(t);for(var n in o){let l=o[n];if(a.test(l)){let c=l.replace(/[\$|{|}]/g,"");o[n]=(e==null?void 0:e[c])??void 0}}}catch(l){console.error("解析 activeMap 失败",l)}return o},Ya=t=>{let e,o,a,n;return t.forEach(l=>{l.x=parseFloat(l.x),l.y=parseFloat(l.y),l.h=parseFloat(l.h),l.w=parseFloat(l.w),(e===void 0||l.x<e)&&(e=l.x),(o===void 0||l.x+l.w>o)&&(o=l.x+l.w),(a===void 0||l.y<a)&&(a=l.y),(n===void 0||l.y+l.h>n)&&(n=l.y+l.h)}),{left:e,right:o,top:a,bottom:n}},rt=(t,e)=>{for(let o of Object.keys(t))t[o]=(e==null?void 0:e[o])??t[o]};function Ja(t,e){let o,a,n;const l=T(!0),c=()=>{l.value=!0,n()};ee(t,c,{flush:"sync"});const r=typeof e=="function"?e:e.get,i=typeof e=="function"?void 0:e.set,d=Dt((f,u)=>(a=f,n=u,{get(){return l.value&&(o=r(),l.value=!1),a(),o},set(s){i==null||i(s)}}));return Object.isExtensible(d)&&(d.trigger=c),d}function qe(t){return ta()?(aa(t),!0):!1}function ae(t){return typeof t=="function"?t():g(t)}const Re=typeof window<"u"&&typeof document<"u",Ga=Object.prototype.toString,Ft=t=>Ga.call(t)==="[object Object]",ke=()=>{},ot=Ka();function Ka(){var t;return Re&&((t=window==null?void 0:window.navigator)==null?void 0:t.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent)}const yt={mounted:"mounted",updated:"updated",unmounted:"unmounted"};function qa(...t){if(t.length!==1)return ea(...t);const e=t[0];return typeof e=="function"?Pt(Dt(()=>({get:e,set:ke}))):T(e)}function Qa(t,e,o={}){const{immediate:a=!0}=o,n=T(!1);let l=null;function c(){l&&(clearTimeout(l),l=null)}function r(){n.value=!1,c()}function i(...d){c(),n.value=!0,l=setTimeout(()=>{n.value=!1,l=null,t(...d)},ae(e))}return a&&(n.value=!0,Re&&i()),qe(r),{isPending:Pt(n),start:i,stop:r}}function _t(t,e,o){return ee(t,(a,n,l)=>{a&&e(a,n,l)},o)}function Za(t){var e;const o=ae(t);return(e=o==null?void 0:o.$el)!=null?e:o}const Qe=Re?window:void 0,eo=Re?window.navigator:void 0;function ie(...t){let e,o,a,n;if(typeof t[0]=="string"||Array.isArray(t[0])?([o,a,n]=t,e=Qe):[e,o,a,n]=t,!e)return ke;Array.isArray(o)||(o=[o]),Array.isArray(a)||(a=[a]);const l=[],c=()=>{l.forEach(f=>f()),l.length=0},r=(f,u,s,h)=>(f.addEventListener(u,s,h),()=>f.removeEventListener(u,s,h)),i=ee(()=>[Za(e),ae(n)],([f,u])=>{if(c(),!f)return;const s=Ft(u)?{...u}:u;l.push(...o.flatMap(h=>a.map(p=>r(f,h,p,s))))},{immediate:!0,flush:"post"}),d=()=>{i(),c()};return qe(d),d}function to(t){return typeof t=="function"?t:typeof t=="string"?e=>e.key===t:Array.isArray(t)?e=>t.includes(e.key):()=>!0}function $e(...t){let e,o,a={};t.length===3?(e=t[0],o=t[1],a=t[2]):t.length===2?typeof t[1]=="object"?(e=!0,o=t[0],a=t[1]):(e=t[0],o=t[1]):(e=!0,o=t[0]);const{target:n=Qe,eventName:l="keydown",passive:c=!1,dedupe:r=!1}=a,i=to(e);return ie(n,l,f=>{f.repeat&&ae(r)||i(f)&&o(f)},c)}function ao(t={}){var e;const{window:o=Qe,deep:a=!0}=t,n=(e=t.document)!=null?e:o==null?void 0:o.document,l=()=>{var r;let i=n==null?void 0:n.activeElement;if(a)for(;i!=null&&i.shadowRoot;)i=(r=i==null?void 0:i.shadowRoot)==null?void 0:r.activeElement;return i},c=Ja(()=>null,()=>l());return o&&(ie(o,"blur",r=>{r.relatedTarget===null&&c.trigger()},!0),ie(o,"focus",c.trigger,!0)),c}function oo(){const t=T(!1);return oa()&&ve(()=>{t.value=!0}),t}function lo(t){const e=oo();return X(()=>(e.value,!!t()))}function no(t={}){const{navigator:e=eo,read:o=!1,source:a,copiedDuring:n=1500,legacy:l=!1}=t,c=lo(()=>e&&"clipboard"in e),r=X(()=>c.value||l),i=T(""),d=T(!1),f=Qa(()=>d.value=!1,n);function u(){c.value?e.clipboard.readText().then(b=>{i.value=b}):i.value=p()}r.value&&o&&ie(["copy","cut"],u);async function s(b=ae(a)){r.value&&b!=null&&(c.value?await e.clipboard.writeText(b):h(b),i.value=b,d.value=!0,f.start())}function h(b){const y=document.createElement("textarea");y.value=b??"",y.style.position="absolute",y.style.opacity="0",document.body.appendChild(y),y.select(),document.execCommand("copy"),y.remove()}function p(){var b,y,k;return(k=(y=(b=document==null?void 0:document.getSelection)==null?void 0:b.call(document))==null?void 0:y.toString())!=null?k:""}return{isSupported:r,text:i,copied:d,copy:s}}function io(t,e={}){const o=T(!1),a=It(null);let n=0;if(Re){const l=typeof e=="function"?{onDrop:e}:e,c=r=>{var i,d;const f=Array.from((d=(i=r.dataTransfer)==null?void 0:i.files)!=null?d:[]);return a.value=f.length===0?null:f};ie(t,"dragenter",r=>{var i;r.preventDefault(),n+=1,o.value=!0,(i=l.onEnter)==null||i.call(l,c(r),r)}),ie(t,"dragover",r=>{var i;r.preventDefault(),(i=l.onOver)==null||i.call(l,c(r),r)}),ie(t,"dragleave",r=>{var i;r.preventDefault(),n-=1,n===0&&(o.value=!1),(i=l.onLeave)==null||i.call(l,c(r),r)}),ie(t,"drop",r=>{var i;r.preventDefault(),n=0,o.value=!1,(i=l.onDrop)==null||i.call(l,c(r),r)})}return{files:a,isOverDropZone:o}}const so={ctrl:"control",command:"meta",cmd:"meta",option:"alt",up:"arrowup",down:"arrowdown",left:"arrowleft",right:"arrowright"};function ro(t={}){const{reactive:e=!1,target:o=Qe,aliasMap:a=so,passive:n=!0,onEventFired:l=ke}=t,c=ce(new Set),r={toJSON(){return{}},current:c},i=e?ce(r):r,d=new Set,f=new Set;function u(b,y){b in i&&(e?i[b]=y:i[b].value=y)}function s(){c.clear();for(const b of f)u(b,!1)}function h(b,y){var k,H;const z=(k=b.key)==null?void 0:k.toLowerCase(),w=[(H=b.code)==null?void 0:H.toLowerCase(),z].filter(Boolean);z&&(y?c.add(z):c.delete(z));for(const V of w)f.add(V),u(V,y);z==="meta"&&!y?(d.forEach(V=>{c.delete(V),u(V,!1)}),d.clear()):typeof b.getModifierState=="function"&&b.getModifierState("Meta")&&y&&[...c,...w].forEach(V=>d.add(V))}ie(o,"keydown",b=>(h(b,!0),l(b)),{passive:n}),ie(o,"keyup",b=>(h(b,!1),l(b)),{passive:n}),ie("blur",s,{passive:!0}),ie("focus",s,{passive:!0});const p=new Proxy(i,{get(b,y,k){if(typeof y!="string")return Reflect.get(b,y,k);if(y=y.toLowerCase(),y in a&&(y=a[y]),!(y in i))if(/[+_-]/.test(y)){const z=y.split(/[+_-]/g).map(_=>_.trim());i[y]=X(()=>z.every(_=>ae(p[_])))}else i[y]=T(!1);const H=Reflect.get(b,y,k);return e?ae(H):H}});return p}/*!
 * Compressor.js v1.2.1
 * https://fengyuanchen.github.io/compressorjs
 *
 * Copyright 2018-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2023-02-28T14:09:41.732Z
 */function wt(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),o.push.apply(o,a)}return o}function We(t){for(var e=1;e<arguments.length;e++){var o=arguments[e]!=null?arguments[e]:{};e%2?wt(Object(o),!0).forEach(function(a){fo(t,a,o[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):wt(Object(o)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(o,a))})}return t}function uo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xt(t,e){for(var o=0;o<e.length;o++){var a=e[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,Xt(a.key),a)}}function co(t,e,o){return e&&xt(t.prototype,e),o&&xt(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function fo(t,e,o){return e=Xt(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Je(){return Je=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(t[a]=o[a])}return t},Je.apply(this,arguments)}function ho(t,e){if(typeof t!="object"||t===null)return t;var o=t[Symbol.toPrimitive];if(o!==void 0){var a=o.call(t,e||"default");if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xt(t){var e=ho(t,"string");return typeof e=="symbol"?e:String(e)}var Yt={exports:{}};(function(t){typeof window>"u"||function(e){var o=e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype,a=e.Blob&&function(){try{return!!new Blob}catch{return!1}}(),n=a&&e.Uint8Array&&function(){try{return new Blob([new Uint8Array(100)]).size===100}catch{return!1}}(),l=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,c=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,r=(a||l)&&e.atob&&e.ArrayBuffer&&e.Uint8Array&&function(i){var d,f,u,s,h,p,b,y,k;if(d=i.match(c),!d)throw new Error("invalid data URI");for(f=d[2]?d[1]:"text/plain"+(d[3]||";charset=US-ASCII"),u=!!d[4],s=i.slice(d[0].length),u?h=atob(s):h=decodeURIComponent(s),p=new ArrayBuffer(h.length),b=new Uint8Array(p),y=0;y<h.length;y+=1)b[y]=h.charCodeAt(y);return a?new Blob([n?b:p],{type:f}):(k=new l,k.append(p),k.getBlob(f))};e.HTMLCanvasElement&&!o.toBlob&&(o.mozGetAsFile?o.toBlob=function(i,d,f){var u=this;setTimeout(function(){f&&o.toDataURL&&r?i(r(u.toDataURL(d,f))):i(u.mozGetAsFile("blob",d))})}:o.toDataURL&&r&&(o.msToBlob?o.toBlob=function(i,d,f){var u=this;setTimeout(function(){(d&&d!=="image/png"||f)&&o.toDataURL&&r?i(r(u.toDataURL(d,f))):i(u.msToBlob(d))})}:o.toBlob=function(i,d,f){var u=this;setTimeout(function(){i(r(u.toDataURL(d,f)))})})),t.exports?t.exports=r:e.dataURLtoBlob=r}(window)})(Yt);var Vt=Yt.exports,po=function(e){return typeof Blob>"u"?!1:e instanceof Blob||Object.prototype.toString.call(e)==="[object Blob]"},Mt={strict:!0,checkOrientation:!0,retainExif:!1,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},mo=typeof window<"u"&&typeof window.document<"u",_e=mo?window:{},Ge=function(e){return e>0&&e<1/0},go=Array.prototype.slice;function dt(t){return Array.from?Array.from(t):go.call(t)}var vo=/^image\/.+$/;function lt(t){return vo.test(t)}function bo(t){var e=lt(t)?t.substr(6):"";return e==="jpeg"&&(e="jpg"),".".concat(e)}var Jt=String.fromCharCode;function yo(t,e,o){var a="",n;for(o+=e,n=e;n<o;n+=1)a+=Jt(t.getUint8(n));return a}var _o=_e.btoa;function St(t,e){for(var o=[],a=8192,n=new Uint8Array(t);n.length>0;)o.push(Jt.apply(null,dt(n.subarray(0,a)))),n=n.subarray(a);return"data:".concat(e,";base64,").concat(_o(o.join("")))}function wo(t){var e=new DataView(t),o;try{var a,n,l;if(e.getUint8(0)===255&&e.getUint8(1)===216)for(var c=e.byteLength,r=2;r+1<c;){if(e.getUint8(r)===255&&e.getUint8(r+1)===225){n=r;break}r+=1}if(n){var i=n+4,d=n+10;if(yo(e,i,4)==="Exif"){var f=e.getUint16(d);if(a=f===18761,(a||f===19789)&&e.getUint16(d+2,a)===42){var u=e.getUint32(d+4,a);u>=8&&(l=d+u)}}}if(l){var s=e.getUint16(l,a),h,p;for(p=0;p<s;p+=1)if(h=l+p*12+2,e.getUint16(h,a)===274){h+=8,o=e.getUint16(h,a),e.setUint16(h,1,a);break}}}catch{o=1}return o}function xo(t){var e=0,o=1,a=1;switch(t){case 2:o=-1;break;case 3:e=-180;break;case 4:a=-1;break;case 5:e=90,a=-1;break;case 6:e=90;break;case 7:e=90,o=-1;break;case 8:e=-90;break}return{rotate:e,scaleX:o,scaleY:a}}var Vo=/\.\d*(?:0|9){12}\d*$/;function Ct(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return Vo.test(t)?Math.round(t*e)/e:t}function He(t){var e=t.aspectRatio,o=t.height,a=t.width,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"none",l=Ge(a),c=Ge(o);if(l&&c){var r=o*e;(n==="contain"||n==="none")&&r>a||n==="cover"&&r<a?o=a/e:a=o*e}else l?o=a/e:c&&(a=o*e);return{width:a,height:o}}function Mo(t){for(var e=dt(new Uint8Array(t)),o=e.length,a=[],n=0;n+3<o;){var l=e[n],c=e[n+1];if(l===255&&c===218)break;if(l===255&&c===216)n+=2;else{var r=e[n+2]*256+e[n+3],i=n+r+2,d=e.slice(n,i);a.push(d),n=i}}return a.reduce(function(f,u){return u[0]===255&&u[1]===225?f.concat(u):f},[])}function So(t,e){var o=dt(new Uint8Array(t));if(o[2]!==255||o[3]!==224)return t;var a=o[4]*256+o[5],n=[255,216].concat(e,o.slice(4+a));return new Uint8Array(n)}var Co=_e.ArrayBuffer,tt=_e.FileReader,xe=_e.URL||_e.webkitURL,ko=/\.\w+$/,Ro=_e.Compressor,Ao=function(){function t(e,o){uo(this,t),this.file=e,this.exif=[],this.image=new Image,this.options=We(We({},Mt),o),this.aborted=!1,this.result=null,this.init()}return co(t,[{key:"init",value:function(){var o=this,a=this.file,n=this.options;if(!po(a)){this.fail(new Error("The first argument must be a File or Blob object."));return}var l=a.type;if(!lt(l)){this.fail(new Error("The first argument must be an image File or Blob object."));return}if(!xe||!tt){this.fail(new Error("The current browser does not support image compression."));return}Co||(n.checkOrientation=!1,n.retainExif=!1);var c=l==="image/jpeg",r=c&&n.checkOrientation,i=c&&n.retainExif;if(xe&&!r&&!i)this.load({url:xe.createObjectURL(a)});else{var d=new tt;this.reader=d,d.onload=function(f){var u=f.target,s=u.result,h={},p=1;r&&(p=wo(s),p>1&&Je(h,xo(p))),i&&(o.exif=Mo(s)),r||i?!xe||p>1?h.url=St(s,l):h.url=xe.createObjectURL(a):h.url=s,o.load(h)},d.onabort=function(){o.fail(new Error("Aborted to read the image with FileReader."))},d.onerror=function(){o.fail(new Error("Failed to read the image with FileReader."))},d.onloadend=function(){o.reader=null},r||i?d.readAsArrayBuffer(a):d.readAsDataURL(a)}}},{key:"load",value:function(o){var a=this,n=this.file,l=this.image;l.onload=function(){a.draw(We(We({},o),{},{naturalWidth:l.naturalWidth,naturalHeight:l.naturalHeight}))},l.onabort=function(){a.fail(new Error("Aborted to load the image."))},l.onerror=function(){a.fail(new Error("Failed to load the image."))},_e.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(_e.navigator.userAgent)&&(l.crossOrigin="anonymous"),l.alt=n.name,l.src=o.url}},{key:"draw",value:function(o){var a=this,n=o.naturalWidth,l=o.naturalHeight,c=o.rotate,r=c===void 0?0:c,i=o.scaleX,d=i===void 0?1:i,f=o.scaleY,u=f===void 0?1:f,s=this.file,h=this.image,p=this.options,b=document.createElement("canvas"),y=b.getContext("2d"),k=Math.abs(r)%180===90,H=(p.resize==="contain"||p.resize==="cover")&&Ge(p.width)&&Ge(p.height),z=Math.max(p.maxWidth,0)||1/0,_=Math.max(p.maxHeight,0)||1/0,w=Math.max(p.minWidth,0)||0,V=Math.max(p.minHeight,0)||0,m=n/l,S=p.width,U=p.height;if(k){var D=[_,z];z=D[0],_=D[1];var P=[V,w];w=P[0],V=P[1];var $=[U,S];S=$[0],U=$[1]}H&&(m=S/U);var Y=He({aspectRatio:m,width:z,height:_},"contain");z=Y.width,_=Y.height;var he=He({aspectRatio:m,width:w,height:V},"cover");if(w=he.width,V=he.height,H){var we=He({aspectRatio:m,width:S,height:U},p.resize);S=we.width,U=we.height}else{var de=He({aspectRatio:m,width:S,height:U}),te=de.width;S=te===void 0?n:te;var re=de.height;U=re===void 0?l:re}S=Math.floor(Ct(Math.min(Math.max(S,w),z))),U=Math.floor(Ct(Math.min(Math.max(U,V),_)));var M=-S/2,L=-U/2,j=S,A=U,E=[];if(H){var K=0,le=0,F=n,Ze=l,ft=He({aspectRatio:m,width:n,height:l},{contain:"cover",cover:"contain"}[p.resize]);F=ft.width,Ze=ft.height,K=(n-F)/2,le=(l-Ze)/2,E.push(K,le,F,Ze)}if(E.push(M,L,j,A),k){var ht=[U,S];S=ht[0],U=ht[1]}b.width=S,b.height=U,lt(p.mimeType)||(p.mimeType=s.type);var pt="transparent";s.size>p.convertSize&&p.convertTypes.indexOf(p.mimeType)>=0&&(p.mimeType="image/jpeg");var mt=p.mimeType==="image/jpeg";if(mt&&(pt="#fff"),y.fillStyle=pt,y.fillRect(0,0,S,U),p.beforeDraw&&p.beforeDraw.call(this,y,b),!this.aborted&&(y.save(),y.translate(S/2,U/2),y.rotate(r*Math.PI/180),y.scale(d,u),y.drawImage.apply(y,[h].concat(E)),y.restore(),p.drew&&p.drew.call(this,y,b),!this.aborted)){var gt=function(ze){if(!a.aborted){var vt=function(Te){return a.done({naturalWidth:n,naturalHeight:l,result:Te})};if(ze&&mt&&p.retainExif&&a.exif&&a.exif.length>0){var bt=function(Te){return vt(Vt(St(So(Te,a.exif),p.mimeType)))};if(ze.arrayBuffer)ze.arrayBuffer().then(bt).catch(function(){a.fail(new Error("Failed to read the compressed image with Blob.arrayBuffer()."))});else{var Ce=new tt;a.reader=Ce,Ce.onload=function(et){var Te=et.target;bt(Te.result)},Ce.onabort=function(){a.fail(new Error("Aborted to read the compressed image with FileReader."))},Ce.onerror=function(){a.fail(new Error("Failed to read the compressed image with FileReader."))},Ce.onloadend=function(){a.reader=null},Ce.readAsArrayBuffer(ze)}}else vt(ze)}};b.toBlob?b.toBlob(gt,p.mimeType,p.quality):gt(Vt(b.toDataURL(p.mimeType,p.quality)))}}},{key:"done",value:function(o){var a=o.naturalWidth,n=o.naturalHeight,l=o.result,c=this.file,r=this.image,i=this.options;if(xe&&r.src.indexOf("blob:")===0&&xe.revokeObjectURL(r.src),l)if(i.strict&&!i.retainExif&&l.size>c.size&&i.mimeType===c.type&&!(i.width>a||i.height>n||i.minWidth>a||i.minHeight>n||i.maxWidth<a||i.maxHeight<n))l=c;else{var d=new Date;l.lastModified=d.getTime(),l.lastModifiedDate=d,l.name=c.name,l.name&&l.type!==c.type&&(l.name=l.name.replace(ko,bo(l.type)))}else l=c;this.result=l,i.success&&i.success.call(this,l)}},{key:"fail",value:function(o){var a=this.options;if(a.error)a.error.call(this,o);else throw o}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=Ro,t}},{key:"setDefaults",value:function(o){Je(Mt,o)}}]),t}();const zo={class:"img-wrap"},To=["src"],Lo=B({__name:"upload-img",props:{accept:{default:"*"}},emits:["change"],setup(t,{emit:e}){const o=t;let a=T(!1),n=T(),l="",c=It(""),r=ce({quality:.8,width:void 0,height:void 0,url:""});const i=async()=>{a.value=!0,await Pe()},d=T();io(d,y=>{let k=(y==null?void 0:y[0])??"";k&&s(k)});const u=()=>{l&&s(l)},s=y=>{let k=o.accept,H=y.name,z=H.substring(H.lastIndexOf(".")).toLowerCase();if(k!="*"&&!(o.accept.split(",").indexOf(z)>-1)){De.error("文件格式有误");return}l=y,new Ao(y,{quality:r.quality,width:r.width||void 0,height:r.height||void 0,success(_){c.value=_;let w=new FileReader;w.onload=()=>{r.url=w.result,w=null},w.readAsDataURL(_)},error(){De.error("压缩图片失败")}})},h=()=>{a.value=!1},p=()=>{c.value&&(e("change",{url:r.url,file:c.value}),h())},b=()=>{n.value.resetFields(),r.url="",l=null,c.value=null};return(y,k)=>{const H=O("el-input-number"),z=O("el-form-item"),_=O("el-button"),w=O("el-form"),V=O("el-dialog");return C(),N(_,ye({onClick:i},y.$attrs),{default:x(()=>[Ye(y.$slots,"default",{},()=>[W("上传图片")],!0),v(V,{"append-to-body":"","destroy-on-close":"",width:"1200px",modelValue:g(a),"onUpdate:modelValue":k[3]||(k[3]=m=>be(a)?a.value=m:a=m),onClose:b},{footer:x(()=>[v(_,{onClick:h},{default:x(()=>[W("关闭")]),_:1}),v(_,{type:"primary",onClick:p},{default:x(()=>[W("确认")]),_:1})]),default:x(()=>[I("div",{class:"drap-wrap",ref_key:"dropZoneRef",ref:d},[v(je,{accept:y.accept,onChange:s},{default:x(()=>[W("拖拽或点击选择图片")]),_:1},8,["accept"])],512),v(w,{ref_key:"formRef",ref:n,style:{"margin-top":"20px"},model:g(r),inline:""},{default:x(()=>[v(z,{label:"质量"},{default:x(()=>[v(H,{modelValue:g(r).quality,"onUpdate:modelValue":k[0]||(k[0]=m=>g(r).quality=m),step:.1,max:1,min:.1},null,8,["modelValue"])]),_:1}),v(z,{label:"宽度",prop:"width"},{default:x(()=>[v(H,{modelValue:g(r).width,"onUpdate:modelValue":k[1]||(k[1]=m=>g(r).width=m)},null,8,["modelValue"])]),_:1}),v(z,{label:"高度",prop:"height"},{default:x(()=>[v(H,{modelValue:g(r).height,"onUpdate:modelValue":k[2]||(k[2]=m=>g(r).height=m)},null,8,["modelValue"])]),_:1}),v(z,null,{default:x(()=>{var m;return[v(_,{type:"primary",onClick:u},{default:x(()=>[W("重新处理")]),_:1}),W(" "+se(((m=g(c))==null?void 0:m.size)/1e3||0)+"KB ",1)]}),_:1})]),_:1},8,["model"]),I("div",zo,[I("img",{class:"img",src:g(r).url,alt:""},null,8,To)])]),_:1},8,["modelValue"])]),_:3},16)}}});const G=(t,e)=>{const o=t.__vccOpts||t;for(const[a,n]of e)o[a]=n;return o},Ho=G(Lo,[["__scopeId","data-v-84c5a84a"]]);let Gt="pannel-json";const Eo=t=>{try{sessionStorage[Gt]=JSON.stringify(t)}catch{}},Uo=()=>{let t={};try{t=JSON.parse(sessionStorage[Gt]||"{}")}catch{}return t},Oo=B({__name:"history",setup(t){let e=Ke("pannel",ce({components:[]})),o=T([]);ve(()=>{n()}),$t(()=>{o.value=null,a.value=null});let a=T("");const n=()=>{a.value=ee(()=>e,i=>{l(i)},{deep:!0,flush:"post",immediate:!0})},l=ra(i=>{try{o.value.unshift(JSON.parse(JSON.stringify(i)))}catch{}},1e3),c=i=>{var d;(d=a.value)==null||d.call(a),a.value=null,rt(e,i)},r=()=>{var i;a.value?((i=a.value)==null||i.call(a),a.value=null):n()};return(i,d)=>{const f=O("el-icon"),u=O("el-button"),s=O("el-dropdown-item"),h=O("el-dropdown-menu"),p=O("el-dropdown");return C(),R(J,null,[v(p,{style:{margin:"0 10px"},"hide-on-click":!1,"max-height":"300"},{dropdown:x(()=>[v(h,null,{default:x(()=>[(C(!0),R(J,null,oe(g(o),(b,y)=>(C(),N(s,{onClick:Me(k=>c(b),["self"])},{default:x(()=>[W("序号 "+se(g(o).length-y),1)]),_:2},1032,["onClick"]))),256))]),_:1})]),default:x(()=>[v(u,{type:"primary",plain:""},{default:x(()=>[W(" 历史"),v(f,{class:"el-icon--right"},{default:x(()=>[v(g(da))]),_:1})]),_:1})]),_:1}),v(u,{onClick:d[0]||(d[0]=b=>r()),plain:"",type:g(a)?"primary":"danger"},{default:x(()=>[W(se(g(a)?"自动保存中":"已暂停保存"),1)]),_:1},8,["type"])],64)}}}),Bo={class:"toolbar-wrap"},Do={class:"label"},Po={class:"preview-wrap"},Io={class:"preview-wrap-json"},$o=B({__name:"index",emits:["refresh"],setup(t,{emit:e}){let o=Ke("pannel",ce({components:[]})),a=ce({name1:"哈哈",state:1});setInterval(()=>{a.state=a.state==1?2:1,a.rate=a.rate=="40%"?"100%":"40%"},1e3);let n=X(()=>o.components.filter(_=>_.active)),l=T(!1);const c=()=>{l.value=!0,Eo(o),setTimeout(()=>{l.value=!1},500)},r=({url:_})=>{let w=new Image;w.src=_,w.onload=()=>{o.components.push({w:w.width,h:w.height,self:{id:ne(),name:"Image",desc:"图片",url:_}})}},i=_=>{const w=new FileReader;w.onload=()=>{const V=w.result;let m=new Image;m.src=V,m.onload=()=>{o.components.push({w:m.width,h:m.height,self:{id:ne(),name:"Image",desc:"图片",url:V}})}},w.readAsDataURL(_)},d=_=>{let w=new FileReader,V=new FileReader;w.onload=()=>{const m=w.result;let S=new Image;S.src=m,S.onload=()=>{let U=S.width,D=S.height;V.onload=()=>{o.components.push({w:U,h:D,self:{id:ne(),name:"icon-svg",desc:"缩放图片",url:V.result}}),V.abort(),w.abort(),w=null,V=null},V.readAsText(_)}},w.readAsDataURL(_)};let f=T(!1);const u=()=>{f.value=!0};let s=T(!1);const h=()=>{s.value=!0},p=_=>{const w=new FileReader;w.onload=()=>{const V=w.result;let m=new Image;m.src=V,m.onload=()=>{o.components.push({w:m.width,h:m.height,self:{id:ne(),name:"img-scale",url:V}})}},w.readAsDataURL(_)},b=async()=>{let _=n.value||[],w=[];_.forEach(Y=>{Y.self.name=="Group"?w.push(...k(Y)):w.push(Y)});let{left:V,right:m,top:S,bottom:U}=Ya(w),D=w.map(Y=>({...Y,active:!1,preventDeactivation:!1,x:Y.x-V,y:Y.y-S})),P=o.components.filter(Y=>n.value.every(he=>Y!==he)),$={x:V,y:S,w:m-V,h:U-S,lockAspectRatio:!1,self:{id:ne(),desc:"组合",name:"Group"},group:D};P.push($),o.components=P,e("refresh")},y=()=>{var m;let _=((m=n.value)==null?void 0:m[0])??{},w=k(_),V=o.components.filter(S=>_!==S);V.push(...w),o.components=V,e("refresh")},k=_=>{let w=(_==null?void 0:_.group)??[],V=_.x,m=_.y;return w.map(S=>({...S,x:V+S.x,y:m+S.y}))};let H=T();const z=()=>{let _=H.value.innerText;try{let w=JSON.parse(_);rt(o,w),s.value=!1}catch{De.error("解析数据失败")}};return(_,w)=>{var U,D,P;const V=O("el-button"),m=O("el-input-number"),S=O("el-dialog");return C(),R(J,null,[I("div",Bo,[v(Ho,{accept:".png,.gif,.jpg,.jpeg",type:"primary",plain:"",onChange:r},{default:x(()=>[W("上传图片并压缩")]),_:1}),v(je,{accept:".png,.gif,.jpg,.jpeg",onChange:i},{default:x(()=>[W("上传图片")]),_:1}),v(je,{accept:".svg",onChange:d},{default:x(()=>[W("上传svg")]),_:1}),v(je,{accept:".png,.gif,.jpg,.jpeg",onChange:p},{default:x(()=>[W("上传缩放图片")]),_:1}),v(V,{type:"primary",plain:"",onClick:u},{default:x(()=>[W("预览")]),_:1}),v(V,{type:"primary",plain:"",onClick:h},{default:x(()=>[W("json")]),_:1}),v(V,{type:"primary",disabled:g(n).length<=1,plain:"",onClick:b},{default:x(()=>[W(" 组合")]),_:1},8,["disabled"]),v(V,{type:"primary",disabled:g(n).length!=1||((P=(D=(U=g(n))==null?void 0:U[0])==null?void 0:D.self)==null?void 0:P.name)!="Group",plain:"",onClick:w[0]||(w[0]=$=>y())},{default:x(()=>[W(" 拆分")]),_:1},8,["disabled"]),v(V,{style:{width:"100px"},loading:g(l),type:"primary",plain:"",onClick:w[1]||(w[1]=$=>c())},{default:x(()=>[W("临时缓存 ")]),_:1},8,["loading"]),v(Oo),I("div",Do,[W(" 缩放 "),v(m,{size:"small",step:.1,modelValue:g(Be),"onUpdate:modelValue":w[2]||(w[2]=$=>be(Be)?Be.value=$:null)},null,8,["modelValue"])])]),v(S,{"align-center":"","append-to-body":"",width:"1040px",title:"预览","destroy-on-close":"",modelValue:g(f),"onUpdate:modelValue":w[4]||(w[4]=$=>be(f)?f.value=$:f=$)},{default:x(()=>[I("div",Po,[g(f)?(C(),N(g(Oe),{key:0,pannel:g(o),modelValue:g(a),"onUpdate:modelValue":w[3]||(w[3]=$=>be(a)?a.value=$:a=$)},null,8,["pannel","modelValue"])):ge("",!0)])]),_:1},8,["modelValue"]),v(S,{"align-center":"","append-to-body":"",width:"1200px",title:"预览JSON",modelValue:g(s),"onUpdate:modelValue":w[5]||(w[5]=$=>be(s)?s.value=$:s=$)},{footer:x(()=>[v(V,{type:"primary",onClick:z},{default:x(()=>[W("确认")]),_:1})]),default:x(()=>[I("div",Io,[I("pre",{ref_key:"currentPannel",ref:H,style:{"min-height":"200px"},contenteditable:""},se(g(o)),513)])]),_:1},8,["modelValue"])],64)}}});const Wo=G($o,[["__scopeId","data-v-9c16b932"]]),No=B({__name:"index",setup(t,{expose:e}){let o=T([]),a=T([]);return e({init:l=>{o.value=l.vLine,a.value=l.hLine}}),(l,c)=>(C(),R(J,null,[(C(!0),R(J,null,oe(g(o),(r,i)=>it((C(),R("span",{class:"ref-line v-line",key:"v_"+i,style:Z({left:r.position,top:r.origin,height:r.lineLength})},null,4)),[[Bt,r.display]])),128)),(C(!0),R(J,null,oe(g(a),(r,i)=>(C(),R("span",{class:"ref-line h-line",key:"h_"+i,style:Z({top:r.position,left:r.origin,width:r.lineLength})},null,4))),128))],64))}});const jo=G(No,[["__scopeId","data-v-3b7aeeb1"]]),Fo={class:"group-wrap"},Xo=["a"],Yo=B({__name:"index",props:{data:{},modelValue:{default:()=>({})},groupModel:{default:()=>({})},disabled:{type:Boolean}},setup(t){const e=t,o=l=>ut(l).default,a=l=>({width:l.w=="auto"?l.w:l.w+"px",height:l.h=="auto"?l.h:l.h+"px",transform:`translate(${l.x}px, ${l.y}px) rotate(${l.r||0}deg)`}),n=l=>st(l,e.groupModel);return(l,c)=>(C(),R("div",Fo,[(C(!0),R(J,null,oe(l.data.group,r=>(C(),R("div",{a:r.active,class:"group-item",style:Z(a(r))},[(C(),N(Ie(o(r.self.name)),ye({data:r,h:r.h,w:r.w},n(r),{modelValue:l.groupModel[r.self.modelValue],"onUpdate:modelValue":i=>l.groupModel[r.self.modelValue]=i,defaultModelValue:r.self.defaultModelValue,"onUpdate:defaultModelValue":i=>r.self.defaultModelValue=i,disabled:!0}),null,16,["data","h","w","modelValue","onUpdate:modelValue","defaultModelValue","onUpdate:defaultModelValue"]))],12,Xo))),256))]))}});const Jo=G(Yo,[["__scopeId","data-v-a7d365c4"]]),Go=Object.freeze(Object.defineProperty({__proto__:null,default:Jo},Symbol.toStringTag,{value:"Module"})),Ko=["width","height","src"],qo=B({__name:"index",props:{url:{},w:{},h:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""}},setup(t){const e=t;fe(a=>({"35be3580":a.color,"7a3808fb":a.bgColor,"565e2eee":a.padding,ca4fabd6:a.radius})),ee(()=>[e.w,e.h],()=>o()),ve(()=>{o()});const o=()=>{};return(a,n)=>(C(),R("img",{class:"custom-image",width:a.w,height:a.h,src:a.url,alt:""},null,8,Ko))}});const Qo=G(qo,[["__scopeId","data-v-51bcdfe3"]]),Zo=Object.freeze(Object.defineProperty({__proto__:null,default:Qo},Symbol.toStringTag,{value:"Module"})),el=B({__name:"index",props:{url:{},w:{},h:{},flip:{}},setup(t){const e=t;let o=T(),a="",n=!0,l="";ee(()=>[e.w,e.h],()=>c()),ee(()=>{var i,d;return[(i=e.flip)==null?void 0:i.horizontal,(d=e.flip)==null?void 0:d.vertical]},()=>r()),ve(()=>{a=o.value.getContext("2d"),c()});const c=()=>{let i=e.w,d=e.h;o.value.width=i,o.value.height=d,n?(n=!1,l=document.createElement("img"),l.src=e.url,l.onload=()=>{a.drawImage(l,0,0,i,d),r()}):r()},r=()=>{const{vertical:i,horizontal:d}=e.flip??{};let f=e.w,u=e.h;const s=d?-1:1,h=i?-1:1;a.clearRect(0,0,f,u),a.translate(f/2-f*s/2,u/2-u*h/2),a.scale(s,h),a.drawImage(l,0,0,f,u),a.setTransform(1,0,0,1,0,0)};return(i,d)=>(C(),R("canvas",{ref_key:"canvas",ref:o},null,512))}}),tl=Object.freeze(Object.defineProperty({__proto__:null,default:el},Symbol.toStringTag,{value:"Module"})),al={class:"text-wrap"},ol=B({__name:"index",props:{modelValue:{default:""},defaultModelValue:{default:""},data:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""},fontSize:{default:""},borderColor:{default:""},w:{},h:{}},setup(t){return fe(e=>({"46dd5ff7":e.color,"7f931c9c":e.bgColor,c746d0b6:e.padding,a4c36304:e.radius,"522c9048":e.fontSize,"27fc0faa":e.borderColor})),(e,o)=>(C(),R("div",al,se(e.modelValue||e.defaultModelValue),1))}});const ll=G(ol,[["__scopeId","data-v-8233b39d"]]),nl=Object.freeze(Object.defineProperty({__proto__:null,default:ll},Symbol.toStringTag,{value:"Module"})),il=["contenteditable"],sl=B({__name:"index",props:{modelValue:{default:""},defaultModelValue:{},data:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""},fontSize:{default:""},borderColor:{default:""},w:{},h:{},noWordWrap:{type:Boolean,default:!1},overEllipsis:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},hasModelValue:{type:Boolean}},emits:["update:modelValue","update:defaultModelValue","click"],setup(t,{emit:e}){const o=t;fe(d=>({"00cd0a69":d.color,"863570b8":d.bgColor,cde924d2:d.padding,"31a3f24c":d.radius,"7015a02a":d.fontSize,aedef5c6:d.borderColor,ba981f16:d.noWordWrap?"nowrap":"","58ddca96":d.overEllipsis?"hidden":"auto","6b9be9da":d.overEllipsis?"ellipsis":"unset"}));let a=T(!1),n=T();const l=async()=>{o.disabled||(a.value=!0,c(n.value),await Pe(),n.value.focus())},c=d=>{const f=window.getSelection(),u=document.createRange();u.selectNodeContents(d),f.removeAllRanges(),f.addRange(u)},r=()=>{a.value=!1},i=d=>{o.hasModelValue&&e("update:modelValue",d.target.innerText),e("update:defaultModelValue",d.target.innerText)};return(d,f)=>(C(),R("div",{contenteditable:g(a),onBlur:r,onInput:i,ref_key:"text",ref:n,class:ue({"text-wrap":!0,"can-edit":g(a)}),onDblclick:l},se(d.modelValue||d.defaultModelValue),43,il))}});const rl=G(sl,[["__scopeId","data-v-b9e7c0b0"]]),dl=Object.freeze(Object.defineProperty({__proto__:null,default:rl},Symbol.toStringTag,{value:"Module"})),ul=["innerHTML"],cl=B({__name:"index",props:{url:{},color:{default:""},bgColor:{default:""},fillColor:{default:""},padding:{default:""},radius:{default:""},fontSize:{default:""},iconUseSelfColor:{type:Boolean}},setup(t){return fe(e=>({"46bf371c":e.color,"5a1a592f":e.fillColor,"1d6b7926":e.bgColor,"651f2d40":e.padding,"5f884d3a":e.radius,"6f5fc4fe":e.fontSize})),(e,o)=>(C(),R("div",{class:ue({"icon-wrap":!0,"color-self":e.iconUseSelfColor}),innerHTML:e.url},null,10,ul))}});const fl=G(cl,[["__scopeId","data-v-6b52c610"]]),hl=Object.freeze(Object.defineProperty({__proto__:null,default:fl},Symbol.toStringTag,{value:"Module"})),pl={class:"img-scale-wrap"},ml=["src"],gl=B({__name:"index",props:{url:{},w:{},h:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""},lockAspectRatio:{type:Boolean,default:!1},position:{default:"left"},imgWidth:{},imgHeight:{}},setup(t){const e=t;fe(n=>({ef6c025e:n.color,"58f6c20c":n.bgColor,"351ce7ff":n.padding,cc74ea38:n.radius}));let o=X(()=>({[e.position]:0,width:e.imgWidth,height:e.imgHeight})),a=X(()=>({[e.position]:0,width:e.lockAspectRatio?e.w+"px":void 0,height:e.lockAspectRatio?e.h+"px":void 0}));return(n,l)=>(C(),R("div",pl,[I("div",{class:"img-scale-reduce",style:Z(g(o))},[I("img",{class:"img-scale",src:n.url,alt:"",style:Z(g(a))},null,12,ml)],4)]))}});const vl=G(gl,[["__scopeId","data-v-321d426b"]]),bl=Object.freeze(Object.defineProperty({__proto__:null,default:vl},Symbol.toStringTag,{value:"Module"})),yl=B({name:"dragPannelPreview"}),_l=B({...yl,props:{pannel:{},modelValue:{default:()=>({})},disabled:{type:Boolean,default:!1},parentWidth:{default:0}},emits:["click"],setup(t,{emit:e}){const o=t;let a=T(),n=T({});ve(()=>{c()});const l=u=>({width:u.w==="auto"?u.w:u.w+"px",height:u.h==="auto"?u.h:u.h+"px",fontSize:o.pannel.fontSize||u.fontSize,zIndex:u.z||"auto",transform:`translate(${u.x||0}px, ${u.y||0}px) rotate(${u.r||0}deg)`}),c=async()=>{await Pe();let u={transformOrigin:"0% 0%",width:o.pannel.width+"px",height:o.pannel.height+"px",color:o.pannel.color,fontSize:o.pannel.fontSize,backgroundColor:o.pannel.bgColor},s=a.value.getBoundingClientRect(),{endRate:h,translateX:p,translateY:b}=r(s.width,s.height);n.value={...u,transform:`translate(${p}px, ${b}px) scale(${h})`}},r=(u,s)=>{let h=u/o.pannel.width,p=s/o.pannel.height,b=h>p?p:h,y=h<=p?0:u*b,k=p<=h?0:s*b;return{endRate:b,translateX:y>0?u/2-o.pannel.width/2*b:y,translateY:k>0?s/2-o.pannel.height/2*b:k}},i=u=>ut(u).default,d=u=>{u.self.click&&(console.log("click"),e("click",u))},f=u=>st(u,o.modelValue);return(u,s)=>(C(),R("div",{ref_key:"wrapRef",ref:a,class:"drag-editor-preivew-wrap"},[I("div",{class:ue({"drag-editor-preivew":!0}),style:Z(g(n))},[(C(!0),R(J,null,oe(u.pannel.components,h=>(C(),R("div",{class:"preview-item-wrap",style:Z(l(h))},[(C(),N(Ie(i(h.self.name)),ye({data:h,h:h.h,w:h.w},f(h),{onClickCapture:Me(p=>d(h),["self"]),modelValue:u.modelValue[h.self.modelValue],"onUpdate:modelValue":p=>u.modelValue[h.self.modelValue]=p,defaultModelValue:h.self.defaultModelValue,"onUpdate:defaultModelValue":p=>h.self.defaultModelValue=p,groupModel:u.modelValue,disabled:!0}),null,16,["data","h","w","onClickCapture","modelValue","onUpdate:modelValue","defaultModelValue","onUpdate:defaultModelValue","groupModel"]))],4))),256))],4)],512))}});const wl=G(_l,[["__scopeId","data-v-b2568ace"]]),xl=Object.freeze(Object.defineProperty({__proto__:null,default:wl},Symbol.toStringTag,{value:"Module"}));let Vl=Object.assign({"./Group/index.vue":Go,"./Image/index.vue":Zo,"./Picture/index.vue":tl,"./Shape/index.vue":nl,"./Text/index.vue":dl,"./icon-svg/index.vue":hl,"./img-scale/index.vue":bl,"./preview/index.vue":xl});const ut=t=>Vl[`./${t}/index.vue`];function Ue(t){var e;const o=ae(t);return(e=o==null?void 0:o.$el)!=null?e:o}const Kt=Re?window:void 0;function Fe(...t){let e,o,a,n;if(typeof t[0]=="string"||Array.isArray(t[0])?([o,a,n]=t,e=Kt):[e,o,a,n]=t,!e)return ke;Array.isArray(o)||(o=[o]),Array.isArray(a)||(a=[a]);const l=[],c=()=>{l.forEach(f=>f()),l.length=0},r=(f,u,s,h)=>(f.addEventListener(u,s,h),()=>f.removeEventListener(u,s,h)),i=ee(()=>[Ue(e),ae(n)],([f,u])=>{if(c(),!f)return;const s=Ft(u)?{...u}:u;l.push(...o.flatMap(h=>a.map(p=>r(f,h,p,s))))},{immediate:!0,flush:"post"}),d=()=>{i(),c()};return qe(d),d}let kt=!1;function Rt(t,e,o={}){const{window:a=Kt,ignore:n=[],capture:l=!0,detectIframe:c=!1}=o;if(!a)return;ot&&!kt&&(kt=!0,Array.from(a.document.body.children).forEach(s=>s.addEventListener("click",ke)),a.document.documentElement.addEventListener("click",ke));let r=!0;const i=s=>n.some(h=>{if(typeof h=="string")return Array.from(a.document.querySelectorAll(h)).some(p=>p===s.target||s.composedPath().includes(p));{const p=Ue(h);return p&&(s.target===p||s.composedPath().includes(p))}}),f=[Fe(a,"click",s=>{const h=Ue(t);if(!(!h||h===s.target||s.composedPath().includes(h))){if(s.detail===0&&(r=!i(s)),!r){r=!0;return}e(s)}},{passive:!0,capture:l}),Fe(a,"pointerdown",s=>{const h=Ue(t);h&&(r=!s.composedPath().includes(h)&&!i(s))},{passive:!0}),c&&Fe(a,"blur",s=>{setTimeout(()=>{var h;const p=Ue(t);((h=a.document.activeElement)==null?void 0:h.tagName)==="IFRAME"&&!(p!=null&&p.contains(a.document.activeElement))&&e(s)},0)})].filter(Boolean);return()=>f.forEach(s=>s())}const Ml={[yt.mounted](t,e){const o=!e.modifiers.bubble;if(typeof e.value=="function")t.__onClickOutside_stop=Rt(t,e.value,{capture:o});else{const[a,n]=e.value;t.__onClickOutside_stop=Rt(t,a,Object.assign({capture:o},n))}},[yt.unmounted](t){t.__onClickOutside_stop()}};function at(t){return typeof Window<"u"&&t instanceof Window?t.document.documentElement:typeof Document<"u"&&t instanceof Document?t.documentElement:t}function qt(t){const e=window.getComputedStyle(t);if(e.overflowX==="scroll"||e.overflowY==="scroll"||e.overflowX==="auto"&&t.clientWidth<t.scrollWidth||e.overflowY==="auto"&&t.clientHeight<t.scrollHeight)return!0;{const o=t.parentNode;return!o||o.tagName==="BODY"?!1:qt(o)}}function Sl(t){const e=t||window.event,o=e.target;return qt(o)?!1:e.touches.length>1?!0:(e.preventDefault&&e.preventDefault(),!1)}function Cl(t,e=!1){const o=T(e);let a=null,n;ee(qa(t),r=>{const i=at(ae(r));if(i){const d=i;n=d.style.overflow,o.value&&(d.style.overflow="hidden")}},{immediate:!0});const l=()=>{const r=at(ae(t));!r||o.value||(ot&&(a=Fe(r,"touchmove",i=>{Sl(i)},{passive:!1})),r.style.overflow="hidden",o.value=!0)},c=()=>{const r=at(ae(t));!r||!o.value||(ot&&(a==null||a()),r.style.overflow=n,o.value=!1)};return qe(c),X({get(){return o.value},set(r){r?l():c()}})}function kl(){let t=!1;const e=T(!1);return(o,a)=>{if(e.value=a.value,t)return;t=!0;const n=Cl(o,a.value);ee(e,l=>n.value=l)}}kl();function At(...t){return X(()=>t.every(e=>ae(e)))}const Rl=["onClick"],Al=B({__name:"index",props:{pannel:{},modelValue:{default:()=>({})},disabled:{type:Boolean,default:!1},active:{default:()=>[]}},emits:["refLineParams"],setup(t,{expose:e,emit:o}){const a=t;let n=T(!1),l=X(()=>({transform:`scale(${Be.value})`,transformOrigin:"50% 0%",width:a.pannel.width+"px",height:a.pannel.height+"px",color:a.pannel.color,fontSize:a.pannel.fontSize,backgroundColor:a.pannel.bgColor}));const{text:c,copy:r}=no({legacy:!0});let i=T(),d=ce({isAllAsync:!1,controlKey:!1,draggingId:null,prevOffsetX:0,prevOffsetY:0});ve(()=>{s()}),$t(()=>{y()});const f=M=>({fontSize:a.pannel.fontSize||M.fontSize}),u=M=>{var L;return((L=ut(M))==null?void 0:L.default)??""},s=()=>{const M=ao(),L=X(()=>{var E,K,le;return((E=M.value)==null?void 0:E.tagName)!=="INPUT"&&((K=M.value)==null?void 0:K.tagName)!=="TEXTAREA"&&((le=M.value)==null?void 0:le.getAttribute("contenteditable"))!=="true"&&n.value}),{Ctrl_C:j,Ctrl_V:A}=ro();_t(At(j,L),()=>{h()}),_t(At(A,L),()=>{p()}),$e(["ArrowDown"],E=>{L.value&&(E.preventDefault(),de("down"))}),$e(["ArrowLeft"],E=>{L.value&&(E.preventDefault(),de("left"))}),$e(["ArrowRight"],E=>{L.value&&(E.preventDefault(),de("right"))}),$e(["ArrowUp"],E=>{L.value&&(E.preventDefault(),de("up"))})},h=()=>{if(a.active.length)try{let M=JSON.stringify(a.active);r(M)}catch{}};let p=()=>{try{a.pannel.components.forEach(L=>{L.active=!1});let M=JSON.parse(c.value);M.forEach(L=>{L.active=!0,L.self.id=ne()}),a.pannel.components.push(...M)}catch{}};const b=()=>{n.value=!0,window.addEventListener("keydown",H),window.addEventListener("keyup",z),window.addEventListener("keydown",_),window.addEventListener("keyup",w)},y=()=>{window.removeEventListener("keydown",H),window.removeEventListener("keyup",z),window.removeEventListener("keydown",_),window.removeEventListener("keyup",w)},k=()=>{y(),n.value=!1},H=M=>{M.keyCode===32&&(M.preventDefault(),d.isAllAsync=!0)},z=M=>{M.keyCode===32&&(M.preventDefault(),d.isAllAsync=!1)},_=M=>{M.keyCode===17&&(d.controlKey=!0)},w=M=>{M.keyCode===17&&(d.controlKey=!1)};let V=T();const m=M=>{var L;(L=V.value)==null||L.init(M)},S=M=>{d.controlKey?M.preventDeactivation=!0:a.pannel.components.forEach(L=>{L.active=!1,L.preventDeactivation=!1}),M.preventDeactivation=!0,M.active=!0},U=M=>{M.active=!1,M.preventDeactivation=!1},D=()=>{a.disabled||(b(),!(d.controlKey&&n)&&a.pannel.components.forEach(M=>{M.active=!1,M.preventDeactivation=!1}))},P=(M,L,j,A,E)=>{Object.assign(E,{x:M,y:L,w:j||E.width,h:A||E.width})},$=(M,L,j)=>{d.draggingId=M;const A=L-(M.x??0),E=j-(M.y??0),K=he(A),le=we(E);if(!d.isAllAsync){a.pannel.components.forEach(F=>{F.active&&F!==M&&(F.x=(F.x??0)+K,F.y=(F.y??0)+le)});return}a.pannel.components.forEach(F=>{F!==M&&(F.x=(F.x??0)+K,F.y=(F.y??0)+le)})},Y=(M,L,j)=>{a.pannel.components.forEach(A=>{A===M&&(A.x=L,A.y=j)}),d.draggingId=null,d.prevOffsetX=0,d.prevOffsetY=0},he=M=>{const L=M-d.prevOffsetX;return d.prevOffsetX=M,L},we=M=>{const L=M-d.prevOffsetY;return d.prevOffsetY=M,L},de=M=>{let L=0,j=0;switch(M){case"up":j=-1;break;case"down":j=1;break;case"left":L=-1;break;case"right":L=1;break}a.pannel.components.forEach(A=>{A.active&&(A.x=(A.x??0)+L,A.y=(A.y??0)+j)})},te=(M,L)=>{L.r=M},re=M=>st(M,a.modelValue);return e({ref:i}),(M,L)=>{const j=O("VueDragResizeRotate");return it((C(),R("div",{ref_key:"dragRef",ref:i,class:ue({"drag-editor-wrap":!0,disabled:M.disabled}),onClick:Me(D,["self","stop"]),onMousedown:L[0]||(L[0]=A=>b()),style:Z(g(l))},[(C(!0),R(J,null,oe(M.pannel.components,A=>(C(),N(j,ye({...g(jt),...A,self:"",dySelf:""},{h:A.h=="auto"?A.h:parseFloat(A.h)||0,w:A.w=="auto"?A.w:parseFloat(A.w)||0,onActivated:E=>S(A),onDeactivated:E=>U(A),onRefLineParams:m,onResizing:(E,K,le,F)=>P(E,K,le,F,A),onResizestop:(E,K,le,F)=>P(E,K,le,F,A),onDragging:(E,K)=>$(A,E,K),onDragstop:(E,K)=>Y(A,E,K),onRotating:E=>te(E,A),onRotatestop:E=>te(E,A),scaleRatio:g(Be)}),{default:x(()=>[(C(),N(Ie(u(A.self.name)),ye({key:A.self.id,data:A,h:A.h,w:A.w},re(A),{style:f(A),hasModelValue:!!A.self.modelValue,modelValue:M.modelValue[A.self.modelValue],"onUpdate:modelValue":E=>M.modelValue[A.self.modelValue]=E,defaultModelValue:A.self.defaultModelValue,"onUpdate:defaultModelValue":E=>A.self.defaultModelValue=E,groupModel:M.modelValue}),null,16,["data","h","w","style","hasModelValue","modelValue","onUpdate:modelValue","defaultModelValue","onUpdate:defaultModelValue","groupModel"]))]),_:2},1040,["h","w","onActivated","onDeactivated","onResizing","onResizestop","onDragging","onDragstop","onRotating","onRotatestop","scaleRatio"]))),256)),v(jo,{ref_key:"subLineRef",ref:V},null,512)],46,Rl)),[[g(Ml),k]])}}});const zl=G(Al,[["__scopeId","data-v-d4d46cc9"]]),zt=""+new URL("../gif/gif.5a563899.gif",import.meta.url).href,Tt=[{w:"auto",h:"auto",self:{id:ne(),name:"Text",desc:"文本",modelValue:"",defaultModelValue:"文本"},dySelf:{}},{w:200,h:200,self:{id:ne(),name:"Image",desc:"图片",url:zt},dySelf:{}},{w:100,h:100,self:{id:ne(),name:"icon-svg",desc:"svg",url:'<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" data-v-ea893728=""><path fill="currentColor" d="M600.704 64a32 32 0 0 1 30.464 22.208l35.2 109.376c14.784 7.232 28.928 15.36 42.432 24.512l112.384-24.192a32 32 0 0 1 34.432 15.36L944.32 364.8a32 32 0 0 1-4.032 37.504l-77.12 85.12a357.12 357.12 0 0 1 0 49.024l77.12 85.248a32 32 0 0 1 4.032 37.504l-88.704 153.6a32 32 0 0 1-34.432 15.296L708.8 803.904c-13.44 9.088-27.648 17.28-42.368 24.512l-35.264 109.376A32 32 0 0 1 600.704 960H423.296a32 32 0 0 1-30.464-22.208L357.696 828.48a351.616 351.616 0 0 1-42.56-24.64l-112.32 24.256a32 32 0 0 1-34.432-15.36L79.68 659.2a32 32 0 0 1 4.032-37.504l77.12-85.248a357.12 357.12 0 0 1 0-48.896l-77.12-85.248A32 32 0 0 1 79.68 364.8l88.704-153.6a32 32 0 0 1 34.432-15.296l112.32 24.256c13.568-9.152 27.776-17.408 42.56-24.64l35.2-109.312A32 32 0 0 1 423.232 64H600.64zm-23.424 64H446.72l-36.352 113.088-24.512 11.968a294.113 294.113 0 0 0-34.816 20.096l-22.656 15.36-116.224-25.088-65.28 113.152 79.68 88.192-1.92 27.136a293.12 293.12 0 0 0 0 40.192l1.92 27.136-79.808 88.192 65.344 113.152 116.224-25.024 22.656 15.296a294.113 294.113 0 0 0 34.816 20.096l24.512 11.968L446.72 896h130.688l36.48-113.152 24.448-11.904a288.282 288.282 0 0 0 34.752-20.096l22.592-15.296 116.288 25.024 65.28-113.152-79.744-88.192 1.92-27.136a293.12 293.12 0 0 0 0-40.256l-1.92-27.136 79.808-88.128-65.344-113.152-116.288 24.96-22.592-15.232a287.616 287.616 0 0 0-34.752-20.096l-24.448-11.904L577.344 128zM512 320a192 192 0 1 1 0 384 192 192 0 0 1 0-384zm0 64a128 128 0 1 0 0 256 128 128 0 0 0 0-256z"></path></svg>'},dySelf:{}},{w:100,h:100,self:{id:ne(),name:"Shape",desc:"图形",borderColor:"solid 1px #333",prop:"state",activeValue:"1",activeMap:'{"bgColor":"red"}'},dySelf:{}},{w:200,h:200,self:{id:ne(),name:"img-scale",desc:"缩放图片",url:zt},dySelf:{}}],Tl=["data-index"],Ll=B({__name:"components-list",setup(t){const e=o=>{let a=JSON.stringify(Tt[o.target.dataset.index]);o.dataTransfer.setData("component",a)};return(o,a)=>(C(),R("div",{class:"component-list",onDragstart:e},[(C(!0),R(J,null,oe(g(Tt),(n,l)=>(C(),R("div",{key:l,class:"list",draggable:!0,"data-index":l},[I("span",null,se(n.self.desc),1)],8,Tl))),128))],32))}});const Hl=G(Ll,[["__scopeId","data-v-eac31297"]]),El={class:"com-list-wrap"},Ul={class:"com-wrap"},Ol={class:"real-com-wrap"},Bl=["onClick"],Dl=["onClick"],Pl=B({__name:"index",setup(t){let e=Ke("pannel",T({}));const o=n=>{n.active=!0},a=n=>{e.components=e.components.filter(l=>l!==n)};return(n,l)=>{const c=O("el-icon"),r=O("el-scrollbar");return C(),R("div",El,[I("div",Ul,[v(Hl)]),v(r,{height:"50%",always:""},{default:x(()=>[I("div",Ol,[(C(!0),R(J,null,oe(g(e).components,i=>(C(),R("div",{class:ue({"com-item":!0,active:i.active}),onClick:d=>o(i)},[I("div",{class:"close-wrap",onClick:Me(d=>a(i),["stop"])},[v(c,null,{default:x(()=>[v(g(ua))]),_:1})],8,Dl),W(" "+se(i.self.desc||i.self.name)+" "+se(i.self.name=="Group"?i.group.length:""),1)],10,Bl))),256))])]),_:1})])}}});const Il=G(Pl,[["__scopeId","data-v-d9d007a9"]]),$l=B({__name:"platform",props:{pannel:{}},setup(t){return(e,o)=>{const a=O("el-input"),n=O("el-form-item"),l=O("el-input-number"),c=O("el-color-picker"),r=O("el-form");return C(),N(r,{size:"small"},{default:x(()=>[v(n,{label:"版本"},{default:x(()=>[v(a,{modelValue:e.pannel.version,"onUpdate:modelValue":o[0]||(o[0]=i=>e.pannel.version=i)},null,8,["modelValue"])]),_:1}),v(n,{label:"描述"},{default:x(()=>[v(a,{modelValue:e.pannel.desc,"onUpdate:modelValue":o[1]||(o[1]=i=>e.pannel.desc=i)},null,8,["modelValue"])]),_:1}),v(n,{label:"宽度"},{default:x(()=>[v(l,{modelValue:e.pannel.width,"onUpdate:modelValue":o[2]||(o[2]=i=>e.pannel.width=i)},null,8,["modelValue"])]),_:1}),v(n,{label:"高度"},{default:x(()=>[v(l,{modelValue:e.pannel.height,"onUpdate:modelValue":o[3]||(o[3]=i=>e.pannel.height=i)},null,8,["modelValue"])]),_:1}),v(n,{label:"文字颜色"},{default:x(()=>[v(c,{modelValue:e.pannel.color,"onUpdate:modelValue":o[4]||(o[4]=i=>e.pannel.color=i)},null,8,["modelValue"])]),_:1}),v(n,{label:"背景色"},{default:x(()=>[v(c,{modelValue:e.pannel.bgColor,"onUpdate:modelValue":o[5]||(o[5]=i=>e.pannel.bgColor=i)},null,8,["modelValue"])]),_:1}),v(n,{label:"文字大小"},{default:x(()=>[v(a,{placeholder:"0px",modelValue:e.pannel.fontSize,"onUpdate:modelValue":o[6]||(o[6]=i=>e.pannel.fontSize=i)},null,8,["modelValue"])]),_:1})]),_:1})}}});const Wl=G($l,[["__scopeId","data-v-6ad875fe"]]),Qt=t=>(la("data-v-7056c102"),t=t(),na(),t),Nl={key:2},jl={key:3},Fl={key:4},Xl=Qt(()=>I("br",null,null,-1)),Yl=Qt(()=>I("br",null,null,-1)),Jl=B({__name:"componentsAttr",props:{active:{}},setup(t){const e=t;let o=T(["1","3","2"]),a=X(()=>{if(e.active){let u={...jt,...e.active};return Object.assign(e.active,u)}return e.active}),n=[{label:"靠上",value:"top"},{label:"靠下",value:"bottom"},{label:"靠左",value:"left"},{label:"靠右",value:"right"}],l=[{label:"大于",value:"大于"},{label:"小于",value:"小于"},{label:"等于",value:"等于"},{label:"不等于",value:"不等于"},{label:"大于等于",value:"大于等于"},{label:"小于等于",value:"小于等于"},{label:"存在(!null && !undefind)",value:"存在"},{label:"不存在(null || undefind)",value:"不存在"}],c=["Text","Shape"],r=X(()=>c.indexOf(e.active.self.name)>-1),i=X(()=>e.active.self.name=="Image"),d=X(()=>e.active.self.name=="img-scale"),f=X(()=>e.active.self.name=="icon-svg");return(u,s)=>{const h=O("el-input"),p=O("el-form-item"),b=O("el-switch"),y=O("el-color-picker"),k=O("el-form"),H=O("el-collapse-item"),z=O("el-option"),_=O("el-select"),w=O("el-input-number"),V=O("el-collapse");return C(),N(V,{modelValue:g(o),"onUpdate:modelValue":s[36]||(s[36]=m=>be(o)?o.value=m:o=m)},{default:x(()=>[v(H,{title:"特有属性",name:"1"},{default:x(()=>[v(k,{size:"small"},{default:x(()=>[v(p,{label:"组件名称",title:"self.name"},{default:x(()=>[v(h,{disabled:"",modelValue:g(a).self.name,"onUpdate:modelValue":s[0]||(s[0]=m=>g(a).self.name=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"组件id",title:"self.id"},{default:x(()=>[v(h,{modelValue:g(a).self.id,"onUpdate:modelValue":s[1]||(s[1]=m=>g(a).self.id=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"点击事件",title:"self.click"},{default:x(()=>[v(b,{modelValue:g(a).self.click,"onUpdate:modelValue":s[2]||(s[2]=m=>g(a).self.click=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"width",title:"w"},{default:x(()=>[v(h,{modelValue:g(a).w,"onUpdate:modelValue":s[3]||(s[3]=m=>g(a).w=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"height",title:"h"},{default:x(()=>[v(h,{modelValue:g(a).h,"onUpdate:modelValue":s[4]||(s[4]=m=>g(a).h=m)},null,8,["modelValue"])]),_:1}),g(d)?(C(),N(p,{key:0,label:"图片内部宽度",title:"self.imgWidth"},{default:x(()=>[v(h,{modelValue:g(a).self.imgWidth,"onUpdate:modelValue":s[5]||(s[5]=m=>g(a).self.imgWidth=m),placeholder:"动态控制%"},null,8,["modelValue"])]),_:1})):ge("",!0),g(d)?(C(),N(p,{key:1,label:"图片内部高度",title:"self.imgHeight"},{default:x(()=>[v(h,{modelValue:g(a).self.imgHeight,"onUpdate:modelValue":s[6]||(s[6]=m=>g(a).self.imgHeight=m),placeholder:"动态控制%"},null,8,["modelValue"])]),_:1})):ge("",!0),g(f)?(C(),R("div",Nl,[v(p,{label:"icon自定义颜色",title:"self.iconUseSelfColor"},{default:x(()=>[v(b,{modelValue:g(a).self.iconUseSelfColor,"onUpdate:modelValue":s[7]||(s[7]=m=>g(a).self.iconUseSelfColor=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"icon背景色",title:"self.fillColor"},{default:x(()=>[v(y,{modelValue:g(a).self.fillColor,"onUpdate:modelValue":s[8]||(s[8]=m=>g(a).self.fillColor=m)},null,8,["modelValue"])]),_:1})])):ge("",!0),v(p,{label:"颜色",title:"self.color"},{default:x(()=>[v(y,{modelValue:g(a).self.color,"onUpdate:modelValue":s[9]||(s[9]=m=>g(a).self.color=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"背景色",title:"self.bgColor"},{default:x(()=>[v(y,{modelValue:g(a).self.bgColor,"onUpdate:modelValue":s[10]||(s[10]=m=>g(a).self.bgColor=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"边框",title:"self.borderColor"},{default:x(()=>[v(h,{placeholder:"solid 1px #000000",modelValue:g(a).self.borderColor,"onUpdate:modelValue":s[11]||(s[11]=m=>g(a).self.borderColor=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"padding",title:"self.padding"},{default:x(()=>[v(h,{modelValue:g(a).self.padding,"onUpdate:modelValue":s[12]||(s[12]=m=>g(a).self.padding=m),placeholder:"0px 0px 0px 0px"},null,8,["modelValue"])]),_:1}),v(p,{label:"radius",title:"self.radius"},{default:x(()=>[v(h,{modelValue:g(a).self.radius,"onUpdate:modelValue":s[13]||(s[13]=m=>g(a).self.radius=m),placeholder:"0px 0px 0px 0px"},null,8,["modelValue"])]),_:1}),v(p,{label:"文字大小",title:"self.fontSize"},{default:x(()=>[v(h,{modelValue:g(a).self.fontSize,"onUpdate:modelValue":s[14]||(s[14]=m=>g(a).self.fontSize=m),placeholder:"0px"},null,8,["modelValue"])]),_:1}),v(p,{label:"modelValue",title:"self.modelValue"},{default:x(()=>[v(h,{placeholder:"绑定属性",modelValue:g(a).self.modelValue,"onUpdate:modelValue":s[15]||(s[15]=m=>g(a).self.modelValue=m)},null,8,["modelValue"])]),_:1}),g(r)?(C(),R("div",jl,[v(p,{label:"默认值",title:"self.defaultModelValue"},{default:x(()=>[v(h,{modelValue:g(a).self.defaultModelValue,"onUpdate:modelValue":s[16]||(s[16]=m=>g(a).self.defaultModelValue=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"禁止换行",title:"self.noWordWrap"},{default:x(()=>[v(b,{modelValue:g(a).self.noWordWrap,"onUpdate:modelValue":s[17]||(s[17]=m=>g(a).self.noWordWrap=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"超出省略",title:"self.overEllipsis"},{default:x(()=>[v(b,{modelValue:g(a).self.overEllipsis,"onUpdate:modelValue":s[18]||(s[18]=m=>g(a).self.overEllipsis=m)},null,8,["modelValue"])]),_:1})])):ge("",!0),g(i)||g(d)?(C(),R("div",Fl,[v(p,{label:"url",title:"self.url"},{default:x(()=>[v(h,{modelValue:g(a).self.url,"onUpdate:modelValue":s[19]||(s[19]=m=>g(a).self.url=m)},null,8,["modelValue"])]),_:1})])):ge("",!0)]),_:1})]),_:1}),v(H,{title:"逻辑处理",name:"3"},{default:x(()=>[v(k,{size:"small","label-position":"top"},{default:x(()=>[v(p,{label:"prop",title:"self.prop"},{default:x(()=>[v(h,{placeholder:"绑定属性",modelValue:g(a).self.prop,"onUpdate:modelValue":s[20]||(s[20]=m=>g(a).self.prop=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"值匹配"},{default:x(()=>[v(_,{title:"self.activeMode",modelValue:g(a).self.activeMode,"onUpdate:modelValue":s[21]||(s[21]=m=>g(a).self.activeMode=m)},{default:x(()=>[(C(!0),R(J,null,oe(g(l),m=>(C(),N(z,{label:m.label,value:m.value},null,8,["label","value"]))),256))]),_:1},8,["modelValue"]),Xl,Yl,v(h,{title:"self.activeValue",placeholder:`1 (${g(a).self.prop||"prop"}${g(a).self.activeMode||""}1)`,modelValue:g(a).self.activeValue,"onUpdate:modelValue":s[22]||(s[22]=m=>g(a).self.activeValue=m)},null,8,["placeholder","modelValue"])]),_:1}),v(p,{label:"匹配后重置属性",title:"self.activeMap"},{default:x(()=>[v(h,{type:"textarea",placeholder:'{"bgColor":"red || ${red}"}',modelValue:g(a).self.activeMap,"onUpdate:modelValue":s[23]||(s[23]=m=>g(a).self.activeMap=m)},null,8,["modelValue"])]),_:1}),g(d)?(C(),N(p,{key:0,label:"图片比例固定",title:"self.lockAspectRatio"},{default:x(()=>[v(b,{modelValue:g(a).self.lockAspectRatio,"onUpdate:modelValue":s[24]||(s[24]=m=>g(a).self.lockAspectRatio=m)},null,8,["modelValue"])]),_:1})):ge("",!0),g(d)?(C(),N(p,{key:1,label:"图片比例起始位置",title:"self.position"},{default:x(()=>[v(_,{modelValue:g(a).self.position,"onUpdate:modelValue":s[25]||(s[25]=m=>g(a).self.position=m)},{default:x(()=>[(C(!0),R(J,null,oe(g(n),m=>(C(),N(z,{label:m.label,value:m.value},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})):ge("",!0)]),_:1})]),_:1}),v(H,{title:"通用属性",name:"2"},{default:x(()=>[v(k,{size:"small"},{default:x(()=>[v(p,{label:"left"},{default:x(()=>[v(w,{modelValue:g(a).x,"onUpdate:modelValue":s[26]||(s[26]=m=>g(a).x=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"top"},{default:x(()=>[v(w,{modelValue:g(a).y,"onUpdate:modelValue":s[27]||(s[27]=m=>g(a).y=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"zIndex"},{default:x(()=>[v(w,{modelValue:g(a).z,"onUpdate:modelValue":s[28]||(s[28]=m=>g(a).z=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"旋转"},{default:x(()=>[v(w,{min:0,modelValue:g(a).r,"onUpdate:modelValue":s[29]||(s[29]=m=>g(a).r=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"锁定比例"},{default:x(()=>[v(b,{modelValue:g(a).lockAspectRatio,"onUpdate:modelValue":s[30]||(s[30]=m=>g(a).lockAspectRatio=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"缩放"},{default:x(()=>[v(b,{modelValue:g(a).resizable,"onUpdate:modelValue":s[31]||(s[31]=m=>g(a).resizable=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"旋转"},{default:x(()=>[v(b,{modelValue:g(a).rotatable,"onUpdate:modelValue":s[32]||(s[32]=m=>g(a).rotatable=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"父级约束"},{default:x(()=>[v(b,{modelValue:g(a).parent,"onUpdate:modelValue":s[33]||(s[33]=m=>g(a).parent=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"吸附"},{default:x(()=>[v(b,{modelValue:g(a).snap,"onUpdate:modelValue":s[34]||(s[34]=m=>g(a).snap=m)},null,8,["modelValue"])]),_:1}),v(p,{label:"吸附距离"},{default:x(()=>[v(w,{modelValue:g(a).snapTolerance,"onUpdate:modelValue":s[35]||(s[35]=m=>g(a).snapTolerance=m)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}});const Gl=G(Jl,[["__scopeId","data-v-7056c102"]]),Kl={class:"wrap"},ql=B({__name:"index",props:{active:{default:()=>({})},activeLength:{}},setup(t){const e=t;let o=T(""),a=Ke("pannel",ce({}));return ee(()=>e.activeLength,n=>{n==1?o.value="com":o.value="plat"},{immediate:!0}),(n,l)=>{const c=O("el-tab-pane"),r=O("el-tabs");return C(),R("div",Kl,[v(r,{modelValue:g(o),"onUpdate:modelValue":l[0]||(l[0]=i=>be(o)?o.value=i:o=i),class:"demo-tabs"},{default:x(()=>[v(c,{label:"平台",name:"plat"},{default:x(()=>[v(Wl,{pannel:g(a)},null,8,["pannel"])]),_:1}),v(c,{label:"组件",name:"com"},{default:x(()=>[n.activeLength==1?(C(),N(Gl,{key:0,active:n.active},null,8,["active"])):ge("",!0)]),_:1})]),_:1},8,["modelValue"])])}}});const Ql=G(ql,[["__scopeId","data-v-fba398cd"]]),Zl={class:"container"},en={class:"left"},tn={class:"mid",ref:"midRef"},an={class:"right"},on=B({__name:"App",setup(t){let e=ce({version:"0.1",desc:"描述",width:1e3,height:700,bgColor:void 0,color:void 0,fontSize:void 0,components:[]});try{let f=Uo();rt(e,f)}catch{}let o=T(),a=T();ia("pannel",e);let n=X(()=>{var f,u;return(u=(f=e.components)==null?void 0:f.filter)==null?void 0:u.call(f,s=>s.active)});ee(()=>e.width,()=>{var f,u;(u=(f=a.value)==null?void 0:f.update)==null||u.call(f)},{flush:"post"});let l=ce({name1:"哈哈",state:1});setInterval(()=>{l.state=l.state==1?2:1,l.red=l.red=="red"?"green":"red",l.rate=l.rate=="40%"?"100%":"40%"},1e3);const c=f=>{f.preventDefault(),f.stopPropagation();const u=f.dataTransfer.getData("component");let s=JSON.parse(u);const h=o.value.ref.getBoundingClientRect();s&&(s.y=f.clientY-h.y,s.x=f.clientX-h.x,s.self.id=ne(),e.components.push(s))},r=f=>{f.preventDefault(),f.dataTransfer.dropEffect="copy"};let i=T(1);const d=()=>{i.value+=1};return(f,u)=>{const s=O("el-scrollbar");return C(),R(J,null,[v(Wo,{onRefresh:d}),I("div",Zl,[I("div",en,[v(Il)]),I("div",tn,[v(s,{ref_key:"editScrollRef",ref:a,always:""},{default:x(()=>[(C(),N(zl,{key:g(i),ref_key:"editorRef",ref:o,onDrop:c,onDragover:r,pannel:g(e),modelValue:g(l),"onUpdate:modelValue":u[0]||(u[0]=h=>be(l)?l.value=h:l=h),active:g(n)},null,8,["pannel","modelValue","active"]))]),_:1},512)],512),I("div",an,[v(s,null,{default:x(()=>[v(Ql,{activeLength:g(n).length,active:g(n)[0]},null,8,["activeLength","active"])]),_:1})])])],64)}}});const ln=G(on,[["__scopeId","data-v-57ef726c"]]);const Lt=new WeakMap;function nn(t){let e=Lt.get(t);return e||Lt.set(t,e=Object.create(null)),e}function Q(t,e,...o){t&&t.$emit&&t.$emit(e,...o);const a=nn(t)[e];return a&&a.map(n=>n.apply(t,o)),t}function Ht(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Function]"}function Ee(t,e,o,a=1){const n=Math.round(e/a/t[0])*t[0],l=Math.round(o/a/t[1])*t[1];return[n,l]}function Et(t,e,o){return t-e-o}function Ut(t,e,o){return t-e-o}function q(t,e,o){return e!==null&&t<e?e:o!==null&&o<t?o:t}function Ne(t,e,o,a,n){const l=Math.PI/180*n,c=Math.cos(l),r=Math.sin(l);let i=o-t,d=a-e;return{x:i*c-d*r+t,y:i*r+d*c+e}}function sn(t,e){let o=Math.atan2(e,t);return o=Math.round(180/Math.PI*o),o<0&&(o=360+o),o}function Ot(t,e,o){let a=t;const n=["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"].find(l=>Ht(a[l]));if(!Ht(a[n]))return!1;do{if(a[n](e))return!0;if(a===o)return!1;a=a.parentNode}while(a);return!1}function rn(t){const e=window.getComputedStyle(t);return[parseFloat(e.getPropertyValue("width"),10),parseFloat(e.getPropertyValue("height"),10)]}function Ve(t,e,o){t&&(t.attachEvent?t.attachEvent("on"+e,o):t.addEventListener?t.addEventListener(e,o,!0):t["on"+e]=o)}function pe(t,e,o){t&&(t.detachEvent?t.detachEvent("on"+e,o):t.removeEventListener?t.removeEventListener(e,o,!0):t["on"+e]=null)}const Xe={mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"},touch:{start:"touchstart",move:"touchmove",stop:"touchend"}},dn={userSelect:"none",MozUserSelect:"none",WebkitUserSelect:"none",MsUserSelect:"none"},un={userSelect:"auto",MozUserSelect:"auto",WebkitUserSelect:"auto",MsUserSelect:"auto"};let me=Xe.mouse;var Ae={name:"VueDragResizeRotate",props:{className:{type:String,default:"vue-drag-resize-rotate"},classNameDraggable:{type:String,default:"draggable"},classNameResizable:{type:String,default:"resizable"},classNameRotatable:{type:String,default:"rotatable"},classNameDragging:{type:String,default:"dragging"},classNameResizing:{type:String,default:"resizing"},classNameRotating:{type:String,default:"rotating"},classNameActive:{type:String,default:"active"},classNameHandle:{type:String,default:"handle"},disableUserSelect:{type:Boolean,default:!0},enableNativeDrag:{type:Boolean,default:!1},preventDeactivation:{type:Boolean,default:!1},active:{type:Boolean,default:!1},draggable:{type:Boolean,default:!0},resizable:{type:Boolean,default:!0},rotatable:{type:Boolean,default:!1},lockAspectRatio:{type:Boolean,default:!1},outsideAspectRatio:{type:[Number,String],default:0},w:{type:[Number,String],default:200,validator:t=>typeof t=="number"?t>0:t==="auto"},h:{type:[Number,String],default:200,validator:t=>typeof t=="number"?t>0:t==="auto"},minWidth:{type:Number,default:0,validator:t=>t>=0},minHeight:{type:Number,default:0,validator:t=>t>=0},maxWidth:{type:Number,default:1/0,validator:t=>t>=0},maxHeight:{type:Number,default:1/0,validator:t=>t>=0},x:{type:[String,Number],default:0},y:{type:[String,Number],default:0},z:{type:[String,Number],default:"auto",validator:t=>typeof t=="string"?t==="auto":t>=0},r:{type:[String,Number],default:0},handles:{type:Array,default:()=>["tl","tm","tr","mr","br","bm","bl","ml","rot"],validator:t=>{const e=new Set(["tl","tm","tr","mr","br","bm","bl","ml","rot"]);return new Set(t.filter(o=>e.has(o))).size===t.length}},dragHandle:{type:String,default:null},dragCancel:{type:String,default:null},axis:{type:String,default:"both",validator:t=>["x","y","both"].includes(t)},grid:{type:Array,default:()=>[1,1]},parent:{type:[Boolean,String],default:!1},onDragStart:{type:Function,default:()=>!0},onDrag:{type:Function,default:()=>!0},onResizeStart:{type:Function,default:()=>!0},onResize:{type:Function,default:()=>!0},onRotateStart:{type:Function,default:()=>!0},onRotate:{type:Function,default:()=>!0},isConflictCheck:{type:Boolean,default:!1},snap:{type:Boolean,default:!1},snapBorder:{type:Boolean,default:!1},snapTolerance:{type:Number,default:5,validator:function(t){return typeof t=="number"}},scaleRatio:{type:Number,default:1,validator:t=>typeof t=="number"},handleInfo:{type:Object,default:()=>({size:8,offset:-4,switch:!0})}},data:function(){return{left:this.x,top:this.y,right:null,bottom:null,rotate:this.r,width:null,height:null,widthTouched:!1,heightTouched:!1,aspectFactor:null,parentWidth:null,parentHeight:null,minW:this.minWidth,minH:this.minHeight,maxW:this.maxWidth,maxH:this.maxHeight,handle:null,enabled:this.active,resizing:!1,dragging:!1,rotating:!1,zIndex:this.z,lastCenterX:0,lastCenterY:0,parentX:0,parentY:0}},computed:{handleStyle(){return t=>{if(!this.handleInfo.switch)return{display:this.enabled?"block":"none"};if(t==="rot"&&!this.rotatable)return{display:"none"};if(t!=="rot"&&!this.resizable)return{display:"none"};const e=(this.handleInfo.size/this.scaleRatio).toFixed(2),o=(this.handleInfo.offset/this.scaleRatio).toFixed(2),a=(e/2).toFixed(2),n={tl:{top:`${o}px`,left:`${o}px`},tm:{top:`${o}px`,left:`calc(50% - ${a}px)`},tr:{top:`${o}px`,right:`${o}px`},mr:{top:`calc(50% - ${a}px)`,right:`${o}px`},br:{bottom:`${o}px`,right:`${o}px`},bm:{bottom:`${o}px`,right:`calc(50% - ${a}px)`},bl:{bottom:`${o}px`,left:`${o}px`},ml:{top:`calc(50% - ${a}px)`,left:`${o}px`},rot:{top:`-${e*3}px`,left:"50%"}},l={width:n[t].width||`${e}px`,height:n[t].height||`${e}px`,top:n[t].top,left:n[t].left,right:n[t].right,bottom:n[t].bottom},c={tl:0,tm:1,tr:2,mr:3,br:4,bm:5,bl:6,ml:7,rot:8};if(t!=="rot"){const r=["nw-resize","n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize","w-resize"],d=this.rotate+22.5,f=Math.floor(d/45);let u=(c[t]+f)%8;l.cursor=r[u]}return l.display=this.enabled?"block":"none",l}},style(){return{transform:`translate(${this.left}px, ${this.top}px) rotate(${this.rotate}deg)`,width:this.computedWidth,height:this.computedHeight,zIndex:this.zIndex,fontSize:this.handleInfo.size*2+"px",...this.dragging&&this.disableUserSelect?dn:un}},actualHandles(){return!this.resizable&&!this.rotatable?[]:this.handles},computedWidth(){return this.w==="auto"&&!this.widthTouched?"auto":this.width+"px"},computedHeight(){return this.h==="auto"&&!this.heightTouched?"auto":this.height+"px"}},watch:{active(t){this.enabled=t,t?(this.updateParentSize(),Q(this,"activated")):Q(this,"deactivated")},x(t){this.resizing||this.dragging||(this.parent&&(this.bounds=this.calcDragLimits()),this.moveHorizontally(t))},y(t){this.resizing||this.dragging||(this.parent&&(this.bounds=this.calcDragLimits()),this.moveVertically(t))},z(t){(t>=0||t==="auto")&&(this.zIndex=t)},r(t){t>=0&&(this.rotate=t%360)},lockAspectRatio(t){t?this.outsideAspectRatio?this.aspectFactor=this.outsideAspectRatio:this.aspectFactor=this.width/this.height:this.aspectFactor=void 0},outsideAspectRatio(t){t&&(this.aspectFactor=t)},minWidth(t){t>0&&t<=this.width&&(this.minW=t)},minHeight(t){t>0&&t<=this.height&&(this.minH=t)},maxWidth(t){this.maxW=t},maxHeight(t){this.maxH=t},w(t){this.resizing||this.dragging||(this.parent&&(this.bounds=this.calcResizeLimits()),this.changeWidth(t))},h(t){this.resizing||this.dragging||(this.parent&&(this.bounds=this.calcResizeLimits()),this.changeHeight(t))}},created:function(){this.maxWidth&&this.minWidth>this.maxWidth&&console.warn("[Vdr warn]: Invalid prop: minWidth cannot be greater than maxWidth"),this.maxWidth&&this.minHeight>this.maxHeight&&console.warn("[Vdr warn]: Invalid prop: minHeight cannot be greater than maxHeight"),this.elmX=0,this.elmY=0,this.elmW=0,this.elmH=0,this.lastCenterX=0,this.lastCenterY=0,this.fixedXName="",this.fixedYName="",this.fixedX=0,this.fixedY=0,this.TL={},this.TR={},this.BL={},this.BR={},this.resetBoundsAndMouseState()},mounted:function(){this.enableNativeDrag||(this.$el.ondragstart=()=>!1);const[t,e]=this.getParentSize();this.parentWidth=t,this.parentHeight=e;const[o,a]=rn(this.$el);this.aspectFactor=(this.w!=="auto"?this.w:o)/(this.h!=="auto"?this.h:a),this.outsideAspectRatio&&(this.aspectFactor=this.outsideAspectRatio),this.width=this.w!=="auto"?this.w:o,this.height=this.h!=="auto"?this.h:a,this.right=this.parentWidth-this.width-this.left,this.bottom=this.parentHeight-this.height-this.top,this.settingAttribute(),Ve(document.documentElement,"mousedown",this.deselect),Ve(document.documentElement,"touchend touchcancel",this.deselect),Ve(window,"resize",this.checkParentSize)},beforeUnmount:function(){pe(document.documentElement,"mousedown",this.deselect),pe(document.documentElement,"touchstart",this.handleUp),pe(document.documentElement,"mousemove",this.move),pe(document.documentElement,"touchmove",this.move),pe(document.documentElement,"mouseup",this.handleUp),pe(document.documentElement,"touchend touchcancel",this.deselect),pe(window,"resize",this.checkParentSize)},methods:{resetBoundsAndMouseState(){this.mouseClickPosition={mouseX:0,mouseY:0,x:0,y:0,w:0,h:0},this.bounds={minLeft:null,maxLeft:null,minRight:null,maxRight:null,minTop:null,maxTop:null,minBottom:null,maxBottom:null}},checkParentSize(){if(this.parent){const[t,e]=this.getParentSize();this.right=t-this.width-this.left,this.bottom=e-this.height-this.top,this.parentWidth=t,this.parentHeight=e}},updateParentSize(){const[t,e]=this.getParentSize();this.parentWidth=t,this.parentHeight=e},getParentSize(){if(this.parent===!0){const t=window.getComputedStyle(this.$el.parentNode,null),e=this.$el.parentNode.getBoundingClientRect();return this.parentX=e.x,this.parentY=e.y,[Math.round(parseFloat(t.getPropertyValue("width"),10)),Math.round(parseFloat(t.getPropertyValue("height"),10))]}if(typeof this.parent=="string"){const t=document.querySelector(this.parent);if(!(t instanceof HTMLElement))throw new Error(`The selector ${this.parent} does not match any element`);return[t.offsetWidth,t.offsetHeight]}return[null,null]},elementTouchDown(t){me=Xe.touch,this.elementDown(t)},elementMouseDown(t){me=Xe.mouse,this.elementDown(t)},elementDown(t){if(t instanceof MouseEvent&&t.which!==1)return;const e=t.target||t.srcElement;if(this.$el.contains(e)){if(this.onDragStart(t)===!1)return;if(this.dragHandle&&!Ot(e,this.dragHandle,this.$el)||this.dragCancel&&Ot(e,this.dragCancel,this.$el)){this.dragging=!1;return}this.enabled||(this.enabled=!0,Q(this,"activated"),Q(this,"update:active",!0)),this.draggable&&(this.dragging=!0),this.mouseClickPosition.mouseX=t.touches?t.touches[0].pageX:t.pageX,this.mouseClickPosition.mouseY=t.touches?t.touches[0].pageY:t.pageY,this.mouseClickPosition.left=this.left,this.mouseClickPosition.right=this.right,this.mouseClickPosition.top=this.top,this.mouseClickPosition.bottom=this.bottom,this.mouseClickPosition.width=this.width,this.mouseClickPosition.height=this.height,this.parent&&(this.bounds=this.calcDragLimits()),Ve(document.documentElement,me.move,this.move),Ve(document.documentElement,me.stop,this.handleUp)}},calcDragLimits(){return this.rotatable?{minLeft:-this.width/2,maxLeft:this.parentWidth-this.width/2,minRight:this.width/2,maxRight:this.parentWidth+this.width/2,minTop:-this.height/2,maxTop:this.parentHeight-this.height/2,minBottom:this.height/2,maxBottom:this.parentHeight+this.height/2}:{minLeft:this.left%this.grid[0],maxLeft:Math.floor((this.parentWidth-this.width-this.left)/this.grid[0])*this.grid[0]+this.left,minRight:this.right%this.grid[0],maxRight:Math.floor((this.parentWidth-this.width-this.right)/this.grid[0])*this.grid[0]+this.right,minTop:this.top%this.grid[1],maxTop:Math.floor((this.parentHeight-this.height-this.top)/this.grid[1])*this.grid[1]+this.top,minBottom:this.bottom%this.grid[1],maxBottom:Math.floor((this.parentHeight-this.height-this.bottom)/this.grid[1])*this.grid[1]+this.bottom}},deselect(t){const e=t.target||t.srcElement,o=new RegExp(this.className+"-([trmbl]{2})","");!this.$el.contains(e)&&!o.test(e.className)&&(this.enabled&&!this.preventDeactivation&&(this.enabled=!1,Q(this,"deactivated"),Q(this,"update:active",!1)),pe(document.documentElement,me.move,this.move)),this.resetBoundsAndMouseState()},handleTouchDown(t,e){me=Xe.touch,this.handleDown(t,e)},handleDown(t,e){if(e instanceof MouseEvent&&e.which!==1||this.onResizeStart(t,e)===!1)return!1;e.stopPropagation&&e.stopPropagation(),this.handle=t,this.handle==="rot"?this.rotating=!0:this.resizing=!0;let{top:o,left:a,width:n,height:l}=this.$el.getBoundingClientRect();this.lastCenterX=window.pageXOffset+a+n/2,this.lastCenterY=window.pageYOffset+o+l/2;let c=this.left,r=this.top,i=this.width,d=this.height,f=c+i/2,u=r+d/2,s=this.rotate;this.TL=Ne(f,u,c,r,s),this.TR=Ne(f,u,c+i,r,s),this.BL=Ne(f,u,c,r+d,s),this.BR=Ne(f,u,c+i,r+d,s),this.mouseClickPosition.mouseX=e.touches?e.touches[0].pageX:e.pageX,this.mouseClickPosition.mouseY=e.touches?e.touches[0].pageY:e.pageY,this.mouseClickPosition.left=this.left,this.mouseClickPosition.right=this.right,this.mouseClickPosition.top=this.top,this.mouseClickPosition.bottom=this.bottom,this.mouseClickPosition.width=this.width,this.mouseClickPosition.height=this.height,this.bounds=this.calcResizeLimits(),Ve(document.documentElement,me.move,this.move),Ve(document.documentElement,me.stop,this.handleUp)},calcResizeLimits(){let t=this.minW,e=this.minH,o=this.maxW,a=this.maxH;const[n,l]=this.grid,c=this.width,r=this.height,i=this.left,d=this.top,f=this.right,u=this.bottom;o=o-o%n,a=a-a%l;const s={minLeft:null,maxLeft:null,minTop:null,maxTop:null,minRight:null,maxRight:null,minBottom:null,maxBottom:null};return this.parent?(s.minLeft=i,s.maxLeft=i+Math.floor((c-t)/n),s.minTop=d,s.maxTop=d+Math.floor((r-e)/l),s.minRight=f,s.maxRight=f+Math.floor((c-t)/n),s.minBottom=u,s.maxBottom=u+Math.floor((r-e)/l),o&&(s.minLeft=Math.max(s.minLeft,this.parentWidth-f-o),s.minRight=Math.max(s.minRight,this.parentWidth-i-o)),a&&(s.minTop=Math.max(s.minTop,this.parentHeight-u-a),s.minBottom=Math.max(s.minBottom,this.parentHeight-d-a))):(s.minLeft=null,s.maxLeft=i+Math.floor(c-t),s.minTop=null,s.maxTop=d+Math.floor(r-e),s.minRight=null,s.maxRight=f+Math.floor(c-t),s.minBottom=null,s.maxBottom=u+Math.floor(r-e),o&&(s.minLeft=-(f+o),s.minRight=-(i+o)),a&&(s.minTop=-(u+a),s.minBottom=-(d+a)),this.lockAspectRatio&&o&&a&&(s.minLeft=Math.min(s.minLeft,-(f+o)),s.minTop=Math.min(s.minTop,-(a+u)),s.minRight=Math.min(s.minRight,-i-o),s.minBottom=Math.min(s.minBottom,-d-a))),s},move(t){this.resizing?this.handleResize(t):this.dragging?this.handleDrag(t):this.rotating&&this.handleRotate(t)},getMouseCoordinate(t){return t.type.indexOf("touch")!==-1?{x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY}:{x:t.pageX||t.clientX+document.documentElement.scrollLeft,y:t.pageY||t.clientY+document.documentElement.scrollTop}},handleRotate(t){const{x:e,y:o}=this.getMouseCoordinate(t),a=e-this.lastCenterX,n=o-this.lastCenterY;this.rotate=(sn(a,n)+90)%360,Q(this,"rotating",this.rotate)},async handleDrag(t){const e=this.axis,o=this.grid,a=this.bounds,n=this.mouseClickPosition,l=e&&e!=="y"?n.mouseX-(t.touches?t.touches[0].pageX:t.pageX):0,c=e&&e!=="x"?n.mouseY-(t.touches?t.touches[0].pageY:t.pageY):0,[r,i]=Ee(o,l,c,this.scaleRatio),d=q(n.left-r,a.minLeft,a.maxLeft),f=q(n.top-i,a.minTop,a.maxTop);if(this.onDrag(d,f)===!1)return;const u=q(n.right+r,a.minRight,a.maxRight),s=q(n.bottom+i,a.minBottom,a.maxBottom);this.left=d,this.top=f,this.right=u,this.bottom=s,await this.snapCheck(),Q(this,"dragging",this.left,this.top)},moveHorizontally(t){const[e]=Ee(this.grid,t,this.top,this.scale),o=q(e,this.bounds.minLeft,this.bounds.maxLeft);this.left=o,this.right=this.parentWidth-this.width-o},moveVertically(t){const[,e]=Ee(this.grid,this.left,t,this.scale),o=q(e,this.bounds.minTop,this.bounds.maxTop);this.top=o,this.bottom=this.parentHeight-this.height-o},handleResize(t){const e=this.handle,o=this.scaleRatio,{TL:a,TR:n,BL:l,BR:c}=this;let{x:r,y:i}=this.getMouseCoordinate(t);!this.rotatable&&this.parent&&(r=q(r,this.parentX,this.parentX+this.parentWidth*o),i=q(i,this.parentY,this.parentY+this.parentHeight*o));let d=r-this.mouseClickPosition.mouseX,f=i-this.mouseClickPosition.mouseY;d=d/o,f=f/o;let u,s,h,p,b,y,k,H,z,_={},w={},V={},m={},S={},U={},D={},P={};if(e.includes("m")){switch(e){case"tm":u=d+(a.x+n.x)/2,s=f+(a.y+n.y)/2,_=l,w=a,V=c,m={x:u-_.x,y:s-_.y},S={x:w.x-_.x,y:w.y-_.y},h=(m.x*S.x+m.y*S.y)/(Math.pow(S.x,2)+Math.pow(S.y,2)),D={x:V.x-_.x,y:V.y-_.y},P={x:S.x*h,y:S.y*h};break;case"bm":u=d+(l.x+c.x)/2,s=f+(l.y+c.y)/2,_=a,w=l,V=n,m={x:u-_.x,y:s-_.y},S={x:w.x-_.x,y:w.y-_.y},h=(m.x*S.x+m.y*S.y)/(Math.pow(S.x,2)+Math.pow(S.y,2)),D={x:V.x-_.x,y:V.y-_.y},P={x:S.x*h,y:S.y*h};break;case"ml":u=d+(a.x+l.x)/2,s=f+(a.y+l.y)/2,_=c,w=l,V=n,m={x:u-_.x,y:s-_.y},S={x:w.x-_.x,y:w.y-_.y},h=(m.x*S.x+m.y*S.y)/(Math.pow(S.x,2)+Math.pow(S.y,2)),P={x:V.x-_.x,y:V.y-_.y},D={x:S.x*h,y:S.y*h};break;case"mr":u=d+(n.x+n.x)/2,s=f+(n.y+n.y)/2,_=l,w=c,V=a,m={x:u-_.x,y:s-_.y},S={x:w.x-_.x,y:w.y-_.y},h=(m.x*S.x+m.y*S.y)/(Math.pow(S.x,2)+Math.pow(S.y,2)),P={x:V.x-_.x,y:V.y-_.y},D={x:S.x*h,y:S.y*h};break}y=_.x+(D.x+P.x)/2,k=_.y+(D.y+P.y)/2,H=Math.sqrt(Math.pow(D.x,2)+Math.pow(D.y,2)),z=Math.sqrt(Math.pow(P.x,2)+Math.pow(P.y,2))}else{switch(e){case"tl":u=d+a.x,s=f+a.y,_=c,w=l,V=n;break;case"tr":u=d+n.x,s=f+n.y,_=l,w=c,V=a;break;case"bl":u=d+l.x,s=f+l.y,_=n,w=a,V=c;break;case"br":u=d+c.x,s=f+c.y,_=a,w=n,V=l;break}m={x:u-_.x,y:s-_.y},S={x:w.x-_.x,y:w.y-_.y},U={x:V.x-_.x,y:V.y-_.y},p=(m.x*S.x+m.y*S.y)/(Math.pow(S.x,2)+Math.pow(S.y,2)),b=(m.x*U.x+m.y*U.y)/(Math.pow(U.x,2)+Math.pow(U.y,2)),D={x:S.x*p,y:S.y*p},P={x:U.x*b,y:U.y*b},y=_.x+(D.x+P.x)/2,k=_.y+(D.y+P.y)/2,H=Math.sqrt(Math.pow(D.x,2)+Math.pow(D.y,2)),z=Math.sqrt(Math.pow(P.x,2)+Math.pow(P.y,2))}this.left=y-H/2,this.top=k-z/2,H=q(H,this.minW||0,this.maxW),z=q(z,this.minH||0,this.maxH),this.parent&&(H=q(H,0,this.parentWidth),z=q(z,0,this.parentHeight)),this.lockAspectRatio&&(console.log(this.lockAspectRatio,this.aspectFactor),H/z>this.aspectFactor?H=z*this.aspectFactor:z=H/this.aspectFactor),this.width=H,this.height=z,Q(this,"resizing",this.left,this.top,this.width,this.height)},changeWidth(t){const[e]=Ee(this.grid,t,0,this.scale),o=this.parentWidth-e-this.left;let a=this.bottom;this.lockAspectRatio&&(a=this.bottom-(this.right-o)/this.aspectFactor);const n=Et(this.parentWidth,this.left,o),l=Ut(this.parentHeight,this.top,a);this.right=o,this.bottom=a,this.width=n,this.height=l},changeHeight(t){const[,e]=Ee(this.grid,0,t,this.scale),o=this.parentHeight-e-this.top;let a=this.right;this.lockAspectRatio&&(a=this.right-(this.bottom-o)*this.aspectFactor);const n=Et(this.parentWidth,this.left,a),l=Ut(this.parentHeight,this.top,o);this.right=a,this.bottom=o,this.width=n,this.height=l},async handleUp(t){this.handle=null;const e=new Array(3).fill({display:!1,position:"",origin:"",lineLength:""}),o={vLine:[],hLine:[]};for(const l in o)o[l]=JSON.parse(JSON.stringify(e));const{x:a,y:n}=this.getMouseCoordinate(t);this.lastMouseX=a,this.lastMouseY=n,this.resizing&&(this.resizing=!1,await this.conflictCheck(),Q(this,"refLineParams",o),Q(this,"resizestop",this.left,this.top,this.width,this.height)),this.dragging&&(this.dragging=!1,await this.conflictCheck(),Q(this,"refLineParams",o),Q(this,"dragstop",this.left,this.top)),this.rotating&&(this.rotating=!1,Q(this,"rotatestop",this.rotate)),this.resetBoundsAndMouseState(),pe(document.documentElement,me.move,this.move)},settingAttribute(){this.$el.setAttribute("data-is-check",`${this.isConflictCheck}`),this.$el.setAttribute("data-is-snap",`${this.snap}`)},conflictCheck(){const t=this.top,e=this.left,o=this.width,a=this.height;if(this.isConflictCheck){const n=this.$el.parentNode.childNodes;for(const l of n)if(l.className!==void 0&&!l.className.split(" ").includes(this.classNameActive)&&l.getAttribute("data-is-check")!==null&&l.getAttribute("data-is-check")!=="false"){const c=l.offsetWidth,r=l.offsetHeight,[i,d]=this.formatTransformVal(l.style.transform),f=t>=d&&e>=i&&d+r>t&&i+c>e||t<=d&&e<i&&t+a>d&&e+o>i,u=e<=i&&t>=d&&e+o>i&&t<d+r||t<d&&e>i&&t+a>d&&e<i+c,s=t<=d&&e>=i&&t+a>d&&e<i+c||t>=d&&e<=i&&t<d+r&&e>i+c,h=t<=d&&e>=i&&t+a>d&&e<i+c||t>=d&&e<=i&&t<d+r&&e>i+c,p=e>=i&&t>=d&&e<i+c&&t<d+r||t>d&&e<=i&&e+o>i&&t<d+r,b=t<=d&&e>=i&&t+a>d&&e<i+c||t>=d&&e<=i&&t<d+r&&e+o>i;(f||u||s||h||p||b)&&(this.top=this.mouseClickPosition.top,this.left=this.mouseClickPosition.left,this.width=this.mouseClickPosition.width,this.height=this.mouseClickPosition.height)}}},async snapCheck(){if(this.snap){let t=this.width,e=this.height,o=this.left,a=this.left+t,n=this.top,l=this.top+e;const c=new Array(3).fill({display:!1,position:"",origin:"",lineLength:""}),r={vLine:[],hLine:[]};for(const b in r)r[b]=JSON.parse(JSON.stringify(c));const i={value:{x:[[],[],[]],y:[[],[],[]]},display:[],position:[]},d=this.$el.parentNode.childNodes,{groupWidth:f,groupHeight:u,groupLeft:s,groupTop:h,bln:p}=await this.getActiveAll(d);p||(t=f,e=u,o=s,a=s+f,n=h,l=h+u);for(const b of d)if(b.className!==void 0&&!b.className.split(" ").includes(this.classNameActive)&&b.getAttribute("data-is-snap")!==null&&b.getAttribute("data-is-snap")!=="false"){const[y,k,H]=this.formatTransformVal(b.style.transform);if((H-this.rotate)%90===0){const z=b.offsetWidth,_=b.offsetHeight,w=y+z,V=k+_,m=Math.abs(n+e/2-(k+_/2))<=this.snapTolerance,S=Math.abs(o+t/2-(y+z/2))<=this.snapTolerance,U=Math.abs(k-l)<=this.snapTolerance,D=Math.abs(V-l)<=this.snapTolerance,P=Math.abs(k-n)<=this.snapTolerance,$=Math.abs(V-n)<=this.snapTolerance,Y=Math.abs(y-a)<=this.snapTolerance,he=Math.abs(w-a)<=this.snapTolerance,we=Math.abs(y-o)<=this.snapTolerance,de=Math.abs(w-o)<=this.snapTolerance;i.display=[U,D,P,$,m,m,Y,he,we,de,S,S],i.position=[k,V,k,V,k+_/2,k+_/2,y,w,y,w,y+z/2,y+z/2],p&&(U&&(this.top=k-e,this.bottom=this.parentHeight-this.top-e,i.value.y[0].push(y,w,o,a)),P&&(this.top=k,this.bottom=this.parentHeight-this.top-e,i.value.y[0].push(y,w,o,a)),D&&(this.top=V-e,this.bottom=this.parentHeight-this.top-e,i.value.y[1].push(y,w,o,a)),$&&(this.top=V,this.bottom=this.parentHeight-this.top-e,i.value.y[1].push(y,w,o,a)),Y&&(this.left=y-t,this.right=this.parentWidth-this.left-t,i.value.x[0].push(k,V,n,l)),we&&(this.left=y,this.right=this.parentWidth-this.left-t,i.value.x[0].push(k,V,n,l)),he&&(this.left=w-t,this.right=this.parentWidth-this.left-t,i.value.x[1].push(k,V,n,l)),de&&(this.left=w,this.right=this.parentWidth-this.left-t,i.value.x[1].push(k,V,n,l)),m&&(this.top=k+_/2-e/2,this.bottom=this.parentHeight-this.top-e,i.value.y[2].push(y,w,o,a)),S&&(this.left=y+z/2-t/2,this.right=this.parentWidth-this.left-t,i.value.x[2].push(k,V,n,l)),this.snapBorder&&(Math.abs(this.left-0)<=this.snapTolerance&&(this.left=0,this.right=this.parentWidth-this.left-t),Math.abs(this.right-0)<=this.snapTolerance&&(this.right=0,this.left=this.parentWidth-this.width-this.right),Math.abs(this.top-0)<=this.snapTolerance&&(this.top=0,this.bottom=this.parentHeight-this.top-e),Math.abs(this.bottom-0)<=this.snapTolerance&&(this.bottom=0,this.top=this.parentHeight-this.bottom-e)));let te=this.bounds;this.left=q(this.left,te.minLeft,te.maxLeft),this.top=q(this.top,te.minTop,te.maxTop),this.right=q(this.right,te.minRight,te.maxRight),this.bottom=q(this.bottom,te.minBottom,te.maxBottom);const re=[0,1,0,1,2,2,0,1,0,1,2,2];for(let M=0;M<=re.length;M++){const L=M<6?"y":"x",j=M<6?"hLine":"vLine";if(i.display[M]){const{origin:A,length:E}=this.calcLineValues(i.value[L][re[M]]);r[j][re[M]].display=i.display[M],r[j][re[M]].position=i.position[M]+"px",r[j][re[M]].origin=A,r[j][re[M]].lineLength=E}}}}Q(this,"refLineParams",r)}},calcLineValues(t){const e=Math.max(...t)-Math.min(...t)+"px",o=Math.min(...t)+"px";return{length:e,origin:o}},async getActiveAll(t){const e=[],o=[],a=[];let n=0,l=0,c=0,r=0;for(const f of t)f.className!==void 0&&f.className.split(" ").includes(this.classNameActive)&&e.push(f);const i=e.length;if(i>1){for(const f of e){const u=f.offsetLeft,s=u+f.offsetWidth,h=f.offsetTop,p=h+f.offsetHeight;o.push(u,s),a.push(h,p)}n=Math.max(...o)-Math.min(...o),l=Math.max(...a)-Math.min(...a),c=Math.min(...o),r=Math.min(...a)}return{groupWidth:n,groupHeight:l,groupLeft:c,groupTop:r,bln:i===1}},formatTransformVal(t){let[e,o,a=0]=t.match(/[\d|.]+/g);return o===void 0&&(o=0),[Number(e),Number(o),a]}},emits:["update:active","rotating","dragging","resizing","refLineParams","resizestop","dragstop","rotatestop","activated","deactivated"]};const cn=["onMousedown","onTouchstart"];function fn(t,e,o,a,n,l){return C(),R("div",{style:Z(l.style),class:ue([{[o.classNameActive]:t.enabled,[o.classNameDragging]:t.dragging,[o.classNameResizing]:t.resizing,[o.classNameDraggable]:o.draggable,[o.classNameResizable]:o.resizable,[o.classNameRotating]:t.rotating,[o.classNameRotatable]:o.rotatable},o.className]),onMousedown:e[0]||(e[0]=(...c)=>l.elementMouseDown&&l.elementMouseDown(...c)),onTouchstart:e[1]||(e[1]=(...c)=>l.elementTouchDown&&l.elementTouchDown(...c))},[(C(!0),R(J,null,oe(l.actualHandles,(c,r)=>(C(),R("div",{key:r,class:ue([o.classNameHandle,o.classNameHandle+"-"+c]),style:Z(l.handleStyle(c,r)),onMousedown:Me(i=>l.handleDown(c,i),["stop","prevent"]),onTouchstart:Me(i=>l.handleTouchDown(c,i),["stop","prevent"])},[Ye(t.$slots,c)],46,cn))),128)),Ye(t.$slots,"default")],38)}Ae.render=fn;Ae.__scopeId="data-v-3c286975";Ae.__file="src/components/vue-drag-resize-rotate/index.vue";function nt(t){nt.installed||(nt.installed=!0,t.component("VueDragResizeRotate",Ae))}Ae.install=nt;const ct=sa(ln);ct.use(ca);ct.use(Ae);ct.mount("#app");
