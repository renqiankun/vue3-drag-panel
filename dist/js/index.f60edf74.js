import{G as I,a as E,ag as D,l as A,M as F,O as w,H as Pe,S as N,T as de,a5 as jt,P as Qe,p as O,K as we,V as zt,m as z,F as q,a7 as oe,J as ae,Q as et,aw as ze,b as ne,d as Ee,u as m,I as be,n as Ne,e as Y,a2 as Te,ax as Et,r as Ht,g as Xt,o as Yt,X as Gt,s as Ut,Z as ce,c as Jt,U as g,A as ue,z as tt,R as se,Y as Kt,ay as qt,az as Zt,E as Qt,as as en}from"./base-module.a8b61ce6.js";import{E as We,c as tn,i as nn}from"./element-plus.40310b22.js";const on=Object.freeze(Object.defineProperty({__proto__:null,get default(){return Dt}},Symbol.toStringTag,{value:"Module"}));(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))n(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const d of a.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function o(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerPolicy&&(a.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?a.credentials="include":l.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(l){if(l.ep)return;l.ep=!0;const a=o(l);fetch(l.href,a)}})();const an=["accept"],De=I({__name:"index",props:{accept:{default:""},maxSize:{default:1/0},text:{default:"上传文件"},preCheck:{}},emits:["change"],setup(t,{emit:e}){const o=t;let n=E("");const l=async d=>{var f,b;var r=((b=(f=d.target)==null?void 0:f.files)==null?void 0:b[0])??{};try{d.target.value=""}catch{}let i=r.name,u=r.size,v=o.maxSize,c=i.lastIndexOf("."),s=i.slice(c),y=o.accept.split(",");if(y.length>0&&y.indexOf(s)<=-1)return We.error("文件格式错误，请重新上传!"),!1;if(u>v)return We.error("文件不可大于10M");e("change",r)},a=async()=>{var r,i,u;if(o.preCheck){var d=await((r=o.preCheck)==null?void 0:r.call(o));if(!d)return}(u=(i=n.value).click)==null||u.call(i)};return(d,r)=>{const i=D("el-button");return A(),F(i,we({type:"primary",plain:"",onClick:a},d.$attrs),{default:w(()=>[Pe(d.$slots,"default",{},()=>[N(de(d.text),1)]),(A(),F(jt,{to:"body"},[Qe(O("input",{type:"file",ref_key:"uploadRef",ref:n,onChange:l,accept:d.accept},null,40,an),[[zt,!1]])]))]),_:3},16)}}});function ee(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>(t==="x"?Math.random()*16|0:"r&0x3"|"0x8").toString(16))}const nt=(t,e)=>{let o=t.self,n=o.activeValue,l=o.prop,a=o.activeMode,d=o.activeMap;if(!l||!a||!d)return o;let r=!1;switch(a){case"大于":e[l]>n&&(r=!0);break;case"小于":e[l]<n&&(r=!0);break;case"等于":e[l]==n&&(r=!0);break;case"不等于":e[l]!=n&&(r=!0);break;case"大于等于":e[l]>=n&&(r=!0);break;case"小于等于":e[l]<n&&(r=!0);break;case"存在":e[l]!==void 0&&e[l]!==null&&(r=!0);break;case"不存在":e[l]===void 0&&e[l]===null&&(r=!0);break}let i={};return r&&(i=ln(d,e)),{...o,...i}},ln=(t,e)=>{let o={},n=/\$\{(.*?)\}/g;try{o=JSON.parse(t);for(var l in o){let a=o[l];if(n.test(a)){let d=a.replace(/[\$|{|}]/g,"");o[l]=(e==null?void 0:e[d])??void 0}}}catch(a){console.error("解析 activeMap 失败",a)}return o},sn=t=>{let e,o,n,l;return t.forEach(a=>{(e===void 0||a.x<e)&&(e=a.x),(o===void 0||a.x+a.w>o)&&(o=a.x+a.w),(n===void 0||a.y<n)&&(n=a.y),(l===void 0||a.y+a.h>l)&&(l=a.y+a.h)}),{left:e,right:o,top:n,bottom:l}},rn={class:"group-wrap"},un=["a"],dn=I({__name:"index",props:{data:{},modelValue:{default:()=>({})},groupModel:{default:()=>({})},disabled:{type:Boolean}},setup(t){const e=t,o=a=>ot(a).default,n=a=>({width:a.w=="auto"?a.w:a.w+"px",height:a.h=="auto"?a.h:a.h+"px",transform:`translate(${a.x}px, ${a.y}px) rotate(${a.r||0}deg)`}),l=a=>nt(a,e.groupModel);return(a,d)=>(A(),z("div",rn,[(A(!0),z(q,null,oe(a.data.group,r=>(A(),z("div",{a:r.active,class:"group-item",style:ae(n(r))},[(A(),F(et(o(r.self.name)),we({data:r,h:r.h,w:r.w},l(r),{modelValue:a.groupModel[r.self.modelValue],"onUpdate:modelValue":i=>a.groupModel[r.self.modelValue]=i,defaultModelValue:r.self.defaultModelValue,"onUpdate:defaultModelValue":i=>r.self.defaultModelValue=i,disabled:!0}),null,16,["data","h","w","modelValue","onUpdate:modelValue","defaultModelValue","onUpdate:defaultModelValue"]))],12,un))),256))]))}});const j=(t,e)=>{const o=t.__vccOpts||t;for(const[n,l]of e)o[n]=l;return o},cn=j(dn,[["__scopeId","data-v-a7d365c4"]]),hn=Object.freeze(Object.defineProperty({__proto__:null,default:cn},Symbol.toStringTag,{value:"Module"})),fn=["width","height","src"],pn=I({__name:"index",props:{url:{},w:{},h:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""}},setup(t){const e=t;ze(n=>({"35be3580":n.color,"7a3808fb":n.bgColor,"565e2eee":n.padding,ca4fabd6:n.radius})),ne(()=>[e.w,e.h],()=>o()),Ee(()=>{o()});const o=()=>{};return(n,l)=>(A(),z("img",{class:"custom-image",width:n.w,height:n.h,src:n.url,alt:""},null,8,fn))}});const mn=j(pn,[["__scopeId","data-v-51bcdfe3"]]),gn=Object.freeze(Object.defineProperty({__proto__:null,default:mn},Symbol.toStringTag,{value:"Module"})),vn=I({__name:"index",props:{url:{},w:{},h:{},flip:{}},setup(t){const e=t;let o=E(),n="",l=!0,a="";ne(()=>[e.w,e.h],()=>d()),ne(()=>{var i,u;return[(i=e.flip)==null?void 0:i.horizontal,(u=e.flip)==null?void 0:u.vertical]},()=>r()),Ee(()=>{n=o.value.getContext("2d"),d()});const d=()=>{let i=e.w,u=e.h;o.value.width=i,o.value.height=u,l?(l=!1,a=document.createElement("img"),a.src=e.url,a.onload=()=>{n.drawImage(a,0,0,i,u),r()}):r()},r=()=>{const{vertical:i,horizontal:u}=e.flip??{};let v=e.w,c=e.h;const s=u?-1:1,y=i?-1:1;n.clearRect(0,0,v,c),n.translate(v/2-v*s/2,c/2-c*y/2),n.scale(s,y),n.drawImage(a,0,0,v,c),n.setTransform(1,0,0,1,0,0)};return(i,u)=>(A(),z("canvas",{ref_key:"canvas",ref:o},null,512))}}),yn=Object.freeze(Object.defineProperty({__proto__:null,default:vn},Symbol.toStringTag,{value:"Module"})),bn={class:"text-wrap"},_n=I({__name:"index",props:{modelValue:{default:""},defaultModelValue:{default:""},data:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""},fontSize:{default:""},borderColor:{default:""},w:{},h:{}},setup(t){return ze(e=>({"46dd5ff7":e.color,"7f931c9c":e.bgColor,c746d0b6:e.padding,a4c36304:e.radius,"522c9048":e.fontSize,"27fc0faa":e.borderColor})),(e,o)=>(A(),z("div",bn,de(e.modelValue||e.defaultModelValue),1))}});const wn=j(_n,[["__scopeId","data-v-8233b39d"]]),xn=Object.freeze(Object.defineProperty({__proto__:null,default:wn},Symbol.toStringTag,{value:"Module"})),Vn=["contenteditable"],Mn=I({__name:"index",props:{modelValue:{default:""},defaultModelValue:{},data:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""},fontSize:{default:""},borderColor:{default:""},w:{},h:{},noWordWrap:{type:Boolean,default:!1},overEllipsis:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","update:defaultModelValue","click"],setup(t,{emit:e}){const o=t;ze(u=>({"111e90c4":u.color,"0222b982":u.bgColor,"49d66d9c":u.padding,"2b833751":u.radius,"6f37b7ef":u.fontSize,"6e06c990":u.borderColor,"5aba8b7a":u.noWordWrap?"nowrap":"","5d769dfa":u.overEllipsis?"hidden":"auto",d17a3716:u.overEllipsis?"ellipsis":"unset"}));let n=E(!1),l=E();const a=async()=>{o.disabled||(n.value=!0,d(l.value),await Ne(),l.value.focus())},d=u=>{const v=window.getSelection(),c=document.createRange();c.selectNodeContents(u),v.removeAllRanges(),v.addRange(c)},r=()=>{n.value=!1},i=u=>{e("update:modelValue",u.target.innerText),e("update:defaultModelValue",u.target.innerText)};return(u,v)=>(A(),z("div",{contenteditable:m(n),onBlur:r,onInput:i,ref_key:"text",ref:l,class:be({"text-wrap":!0,"can-edit":m(n)}),onDblclick:a},de(u.modelValue||u.defaultModelValue),43,Vn))}});const Cn=j(Mn,[["__scopeId","data-v-1a579b7e"]]),Sn=Object.freeze(Object.defineProperty({__proto__:null,default:Cn},Symbol.toStringTag,{value:"Module"})),Rn=["innerHTML"],kn=I({__name:"index",props:{url:{},color:{default:""},bgColor:{default:""},fillColor:{default:""},padding:{default:""},radius:{default:""},fontSize:{default:""},iconUseSelfColor:{type:Boolean}},setup(t){return ze(e=>({"46bf371c":e.color,"5a1a592f":e.fillColor,"1d6b7926":e.bgColor,"651f2d40":e.padding,"5f884d3a":e.radius,"6f5fc4fe":e.fontSize})),(e,o)=>(A(),z("div",{class:be({"icon-wrap":!0,"color-self":e.iconUseSelfColor}),innerHTML:e.url},null,10,Rn))}});const An=j(kn,[["__scopeId","data-v-6b52c610"]]),Ln=Object.freeze(Object.defineProperty({__proto__:null,default:An},Symbol.toStringTag,{value:"Module"})),Tn={class:"img-scale-wrap"},zn=["src"],En=I({__name:"index",props:{url:{},w:{},h:{},color:{default:""},bgColor:{default:""},padding:{default:""},radius:{default:""},lockAspectRatio:{type:Boolean,default:!1},position:{default:"left"},imgWidth:{},imgHeight:{}},setup(t){const e=t;ze(l=>({ef6c025e:l.color,"58f6c20c":l.bgColor,"351ce7ff":l.padding,cc74ea38:l.radius}));let o=Y(()=>({[e.position]:0,width:e.imgWidth,height:e.imgHeight})),n=Y(()=>({[e.position]:0,width:e.lockAspectRatio?e.w+"px":void 0,height:e.lockAspectRatio?e.h+"px":void 0}));return(l,a)=>(A(),z("div",Tn,[O("div",{class:"img-scale-reduce",style:ae(m(o))},[O("img",{class:"img-scale",src:l.url,alt:"",style:ae(m(n))},null,12,zn)],4)]))}});const Hn=j(En,[["__scopeId","data-v-321d426b"]]),Un=Object.freeze(Object.defineProperty({__proto__:null,default:Hn},Symbol.toStringTag,{value:"Module"})),pt=""+new URL("../gif/gif.5a563899.gif",import.meta.url).href;let Dn=Object.assign({"./Group/index.vue":hn,"./Image/index.vue":gn,"./Picture/index.vue":yn,"./Shape/index.vue":xn,"./Text/index.vue":Sn,"./icon-svg/index.vue":Ln,"./img-scale/index.vue":Un,"./preview/index.vue":on});const ot=t=>Dn[`./${t}/index.vue`],mt=[{w:"auto",h:"auto",self:{id:ee(),name:"Text",desc:"文本",modelValue:"",defaultModelValue:"文本"},dySelf:{}},{w:200,h:200,self:{id:ee(),name:"Image",desc:"图片",url:pt},dySelf:{}},{w:100,h:100,self:{id:ee(),name:"icon-svg",desc:"svg",url:'<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" data-v-ea893728=""><path fill="currentColor" d="M600.704 64a32 32 0 0 1 30.464 22.208l35.2 109.376c14.784 7.232 28.928 15.36 42.432 24.512l112.384-24.192a32 32 0 0 1 34.432 15.36L944.32 364.8a32 32 0 0 1-4.032 37.504l-77.12 85.12a357.12 357.12 0 0 1 0 49.024l77.12 85.248a32 32 0 0 1 4.032 37.504l-88.704 153.6a32 32 0 0 1-34.432 15.296L708.8 803.904c-13.44 9.088-27.648 17.28-42.368 24.512l-35.264 109.376A32 32 0 0 1 600.704 960H423.296a32 32 0 0 1-30.464-22.208L357.696 828.48a351.616 351.616 0 0 1-42.56-24.64l-112.32 24.256a32 32 0 0 1-34.432-15.36L79.68 659.2a32 32 0 0 1 4.032-37.504l77.12-85.248a357.12 357.12 0 0 1 0-48.896l-77.12-85.248A32 32 0 0 1 79.68 364.8l88.704-153.6a32 32 0 0 1 34.432-15.296l112.32 24.256c13.568-9.152 27.776-17.408 42.56-24.64l35.2-109.312A32 32 0 0 1 423.232 64H600.64zm-23.424 64H446.72l-36.352 113.088-24.512 11.968a294.113 294.113 0 0 0-34.816 20.096l-22.656 15.36-116.224-25.088-65.28 113.152 79.68 88.192-1.92 27.136a293.12 293.12 0 0 0 0 40.192l1.92 27.136-79.808 88.192 65.344 113.152 116.224-25.024 22.656 15.296a294.113 294.113 0 0 0 34.816 20.096l24.512 11.968L446.72 896h130.688l36.48-113.152 24.448-11.904a288.282 288.282 0 0 0 34.752-20.096l22.592-15.296 116.288 25.024 65.28-113.152-79.744-88.192 1.92-27.136a293.12 293.12 0 0 0 0-40.256l-1.92-27.136 79.808-88.128-65.344-113.152-116.288 24.96-22.592-15.232a287.616 287.616 0 0 0-34.752-20.096l-24.448-11.904L577.344 128zM512 320a192 192 0 1 1 0 384 192 192 0 0 1 0-384zm0 64a128 128 0 1 0 0 256 128 128 0 0 0 0-256z"></path></svg>'},dySelf:{}},{w:100,h:100,self:{id:ee(),name:"Shape",desc:"图形",borderColor:"solid 1px #333",prop:"state",activeValue:"1",activeMap:'{"bgColor":"red"}'},dySelf:{}},{w:200,h:200,self:{id:ee(),name:"img-scale",desc:"缩放图片",url:pt},dySelf:{}}],Bn=I({__name:"index",props:{pannel:{},modelValue:{default:()=>({})},disabled:{type:Boolean,default:!1},parentWidth:{default:0}},emits:["click"],setup(t,{emit:e}){const o=t;let n=E(),l=E({});Ee(()=>{d()});const a=c=>({width:c.w==="auto"?c.w:c.w+"px",height:c.h==="auto"?c.h:c.h+"px",fontSize:o.pannel.fontSize||c.fontSize,zIndex:c.z||"auto",transform:`translate(${c.x||0}px, ${c.y||0}px) rotate(${c.r||0}deg)`}),d=async()=>{await Ne();let c={transformOrigin:"0% 0%",width:o.pannel.width+"px",height:o.pannel.height+"px",color:o.pannel.color,fontSize:o.pannel.fontSize,backgroundColor:o.pannel.bgColor},s=n.value.getBoundingClientRect(),{endRate:y,translateX:f,translateY:b}=r(s.width,s.height);l.value={...c,transform:`translate(${f}px, ${b}px) scale(${y})`}},r=(c,s)=>{let y=c/o.pannel.width,f=s/o.pannel.height,b=y>f?f:y,p=y<=f?0:c*b,_=f<=y?0:s*b;return{endRate:b,translateX:p>0?c/2-o.pannel.width/2*b:p,translateY:_>0?s/2-o.pannel.height/2*b:_}},i=c=>ot(c).default,u=c=>{c.self.click&&(console.log("click"),e("click",c))},v=c=>nt(c,o.modelValue);return(c,s)=>(A(),z("div",{ref_key:"wrapRef",ref:n,class:"drag-editor-preivew-wrap"},[O("div",{class:be({"drag-editor-preivew":!0}),style:ae(m(l))},[(A(!0),z(q,null,oe(c.pannel.components,y=>(A(),z("div",{class:"preview-item-wrap",style:ae(a(y))},[(A(),F(et(i(y.self.name)),we({data:y,h:y.h,w:y.w},v(y),{onClickCapture:Te(f=>u(y),["self"]),modelValue:c.modelValue[y.self.modelValue],"onUpdate:modelValue":f=>c.modelValue[y.self.modelValue]=f,defaultModelValue:y.self.defaultModelValue,"onUpdate:defaultModelValue":f=>y.self.defaultModelValue=f,groupModel:c.modelValue,disabled:!0}),null,16,["data","h","w","onClickCapture","modelValue","onUpdate:modelValue","defaultModelValue","onUpdate:defaultModelValue","groupModel"]))],4))),256))],4)],512))}});const Dt=j(Bn,[["__scopeId","data-v-e6c2d172"]]);let Bt={snap:!0,snapTolerance:5,parent:!0,debug:!1,rotatable:!0,r:0,active:!1,preventDeactivation:!1,resizable:!0,lockAspectRatio:!0},Le=E(1);E(500);E(1200);function On(t,e){let o,n,l;const a=E(!0),d=()=>{a.value=!0,l()};ne(t,d,{flush:"sync"});const r=typeof e=="function"?e:e.get,i=typeof e=="function"?void 0:e.set,u=Et((v,c)=>(n=v,l=c,{get(){return a.value&&(o=r(),a.value=!1),n(),o},set(s){i==null||i(s)}}));return Object.isExtensible(u)&&(u.trigger=d),u}function Fe(t){return Xt()?(Yt(t),!0):!1}function Q(t){return typeof t=="function"?t():m(t)}const Ve=typeof window<"u"&&typeof document<"u",Pn=Object.prototype.toString,Ot=t=>Pn.call(t)==="[object Object]",xe=()=>{},Ke=Wn();function Wn(){var t;return Ve&&((t=window==null?void 0:window.navigator)==null?void 0:t.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent)}const gt={mounted:"mounted",updated:"updated",unmounted:"unmounted"};function $n(...t){if(t.length!==1)return Gt(...t);const e=t[0];return typeof e=="function"?Ht(Et(()=>({get:e,set:xe}))):E(e)}function In(t,e,o={}){const{immediate:n=!0}=o,l=E(!1);let a=null;function d(){a&&(clearTimeout(a),a=null)}function r(){l.value=!1,d()}function i(...u){d(),l.value=!0,a=setTimeout(()=>{l.value=!1,a=null,t(...u)},Q(e))}return n&&(l.value=!0,Ve&&i()),Fe(r),{isPending:Ht(l),start:i,stop:r}}function vt(t,e,o){return ne(t,(n,l,a)=>{n&&e(n,l,a)},o)}function Nn(t){var e;const o=Q(t);return(e=o==null?void 0:o.$el)!=null?e:o}const at=Ve?window:void 0,Fn=Ve?window.navigator:void 0;function te(...t){let e,o,n,l;if(typeof t[0]=="string"||Array.isArray(t[0])?([o,n,l]=t,e=at):[e,o,n,l]=t,!e)return xe;Array.isArray(o)||(o=[o]),Array.isArray(n)||(n=[n]);const a=[],d=()=>{a.forEach(v=>v()),a.length=0},r=(v,c,s,y)=>(v.addEventListener(c,s,y),()=>v.removeEventListener(c,s,y)),i=ne(()=>[Nn(e),Q(l)],([v,c])=>{if(d(),!v)return;const s=Ot(c)?{...c}:c;a.push(...o.flatMap(y=>n.map(f=>r(v,y,f,s))))},{immediate:!0,flush:"post"}),u=()=>{i(),d()};return Fe(u),u}function jn(t={}){var e;const{window:o=at,deep:n=!0}=t,l=(e=t.document)!=null?e:o==null?void 0:o.document,a=()=>{var r;let i=l==null?void 0:l.activeElement;if(n)for(;i!=null&&i.shadowRoot;)i=(r=i==null?void 0:i.shadowRoot)==null?void 0:r.activeElement;return i},d=On(()=>null,()=>a());return o&&(te(o,"blur",r=>{r.relatedTarget===null&&d.trigger()},!0),te(o,"focus",d.trigger,!0)),d}function Xn(){const t=E(!1);return Jt()&&Ee(()=>{t.value=!0}),t}function Yn(t){const e=Xn();return Y(()=>(e.value,!!t()))}function Gn(t={}){const{navigator:e=Fn,read:o=!1,source:n,copiedDuring:l=1500,legacy:a=!1}=t,d=Yn(()=>e&&"clipboard"in e),r=Y(()=>d.value||a),i=E(""),u=E(!1),v=In(()=>u.value=!1,l);function c(){d.value?e.clipboard.readText().then(b=>{i.value=b}):i.value=f()}r.value&&o&&te(["copy","cut"],c);async function s(b=Q(n)){r.value&&b!=null&&(d.value?await e.clipboard.writeText(b):y(b),i.value=b,u.value=!0,v.start())}function y(b){const p=document.createElement("textarea");p.value=b??"",p.style.position="absolute",p.style.opacity="0",document.body.appendChild(p),p.select(),document.execCommand("copy"),p.remove()}function f(){var b,p,_;return(_=(p=(b=document==null?void 0:document.getSelection)==null?void 0:b.call(document))==null?void 0:p.toString())!=null?_:""}return{isSupported:r,text:i,copied:u,copy:s}}function Jn(t,e={}){const o=E(!1),n=Ut(null);let l=0;if(Ve){const a=typeof e=="function"?{onDrop:e}:e,d=r=>{var i,u;const v=Array.from((u=(i=r.dataTransfer)==null?void 0:i.files)!=null?u:[]);return n.value=v.length===0?null:v};te(t,"dragenter",r=>{var i;r.preventDefault(),l+=1,o.value=!0,(i=a.onEnter)==null||i.call(a,d(r),r)}),te(t,"dragover",r=>{var i;r.preventDefault(),(i=a.onOver)==null||i.call(a,d(r),r)}),te(t,"dragleave",r=>{var i;r.preventDefault(),l-=1,l===0&&(o.value=!1),(i=a.onLeave)==null||i.call(a,d(r),r)}),te(t,"drop",r=>{var i;r.preventDefault(),l=0,o.value=!1,(i=a.onDrop)==null||i.call(a,d(r),r)})}return{files:n,isOverDropZone:o}}const Kn={ctrl:"control",command:"meta",cmd:"meta",option:"alt",up:"arrowup",down:"arrowdown",left:"arrowleft",right:"arrowright"};function qn(t={}){const{reactive:e=!1,target:o=at,aliasMap:n=Kn,passive:l=!0,onEventFired:a=xe}=t,d=ce(new Set),r={toJSON(){return{}},current:d},i=e?ce(r):r,u=new Set,v=new Set;function c(b,p){b in i&&(e?i[b]=p:i[b].value=p)}function s(){d.clear();for(const b of v)c(b,!1)}function y(b,p){var _,R;const C=(_=b.key)==null?void 0:_.toLowerCase(),S=[(R=b.code)==null?void 0:R.toLowerCase(),C].filter(Boolean);C&&(p?d.add(C):d.delete(C));for(const k of S)v.add(k),c(k,p);C==="meta"&&!p?(u.forEach(k=>{d.delete(k),c(k,!1)}),u.clear()):typeof b.getModifierState=="function"&&b.getModifierState("Meta")&&p&&[...d,...S].forEach(k=>u.add(k))}te(o,"keydown",b=>(y(b,!0),a(b)),{passive:l}),te(o,"keyup",b=>(y(b,!1),a(b)),{passive:l}),te("blur",s,{passive:!0}),te("focus",s,{passive:!0});const f=new Proxy(i,{get(b,p,_){if(typeof p!="string")return Reflect.get(b,p,_);if(p=p.toLowerCase(),p in n&&(p=n[p]),!(p in i))if(/[+_-]/.test(p)){const C=p.split(/[+_-]/g).map(x=>x.trim());i[p]=Y(()=>C.every(x=>Q(f[x])))}else i[p]=E(!1);const R=Reflect.get(b,p,_);return e?Q(R):R}});return f}/*!
 * Compressor.js v1.2.1
 * https://fengyuanchen.github.io/compressorjs
 *
 * Copyright 2018-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2023-02-28T14:09:41.732Z
 */function yt(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),o.push.apply(o,n)}return o}function He(t){for(var e=1;e<arguments.length;e++){var o=arguments[e]!=null?arguments[e]:{};e%2?yt(Object(o),!0).forEach(function(n){eo(t,n,o[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):yt(Object(o)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(o,n))})}return t}function Zn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bt(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Pt(n.key),n)}}function Qn(t,e,o){return e&&bt(t.prototype,e),o&&bt(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function eo(t,e,o){return e=Pt(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function $e(){return $e=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t},$e.apply(this,arguments)}function to(t,e){if(typeof t!="object"||t===null)return t;var o=t[Symbol.toPrimitive];if(o!==void 0){var n=o.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pt(t){var e=to(t,"string");return typeof e=="symbol"?e:String(e)}var Wt={exports:{}};(function(t){typeof window>"u"||function(e){var o=e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype,n=e.Blob&&function(){try{return!!new Blob}catch{return!1}}(),l=n&&e.Uint8Array&&function(){try{return new Blob([new Uint8Array(100)]).size===100}catch{return!1}}(),a=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,d=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,r=(n||a)&&e.atob&&e.ArrayBuffer&&e.Uint8Array&&function(i){var u,v,c,s,y,f,b,p,_;if(u=i.match(d),!u)throw new Error("invalid data URI");for(v=u[2]?u[1]:"text/plain"+(u[3]||";charset=US-ASCII"),c=!!u[4],s=i.slice(u[0].length),c?y=atob(s):y=decodeURIComponent(s),f=new ArrayBuffer(y.length),b=new Uint8Array(f),p=0;p<y.length;p+=1)b[p]=y.charCodeAt(p);return n?new Blob([l?b:f],{type:v}):(_=new a,_.append(f),_.getBlob(v))};e.HTMLCanvasElement&&!o.toBlob&&(o.mozGetAsFile?o.toBlob=function(i,u,v){var c=this;setTimeout(function(){v&&o.toDataURL&&r?i(r(c.toDataURL(u,v))):i(c.mozGetAsFile("blob",u))})}:o.toDataURL&&r&&(o.msToBlob?o.toBlob=function(i,u,v){var c=this;setTimeout(function(){(u&&u!=="image/png"||v)&&o.toDataURL&&r?i(r(c.toDataURL(u,v))):i(c.msToBlob(u))})}:o.toBlob=function(i,u,v){var c=this;setTimeout(function(){i(r(c.toDataURL(u,v)))})})),t.exports?t.exports=r:e.dataURLtoBlob=r}(window)})(Wt);var _t=Wt.exports,no=function(e){return typeof Blob>"u"?!1:e instanceof Blob||Object.prototype.toString.call(e)==="[object Blob]"},wt={strict:!0,checkOrientation:!0,retainExif:!1,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},oo=typeof window<"u"&&typeof window.document<"u",he=oo?window:{},Ie=function(e){return e>0&&e<1/0},ao=Array.prototype.slice;function lt(t){return Array.from?Array.from(t):ao.call(t)}var lo=/^image\/.+$/;function qe(t){return lo.test(t)}function io(t){var e=qe(t)?t.substr(6):"";return e==="jpeg"&&(e="jpg"),".".concat(e)}var $t=String.fromCharCode;function so(t,e,o){var n="",l;for(o+=e,l=e;l<o;l+=1)n+=$t(t.getUint8(l));return n}var ro=he.btoa;function xt(t,e){for(var o=[],n=8192,l=new Uint8Array(t);l.length>0;)o.push($t.apply(null,lt(l.subarray(0,n)))),l=l.subarray(n);return"data:".concat(e,";base64,").concat(ro(o.join("")))}function uo(t){var e=new DataView(t),o;try{var n,l,a;if(e.getUint8(0)===255&&e.getUint8(1)===216)for(var d=e.byteLength,r=2;r+1<d;){if(e.getUint8(r)===255&&e.getUint8(r+1)===225){l=r;break}r+=1}if(l){var i=l+4,u=l+10;if(so(e,i,4)==="Exif"){var v=e.getUint16(u);if(n=v===18761,(n||v===19789)&&e.getUint16(u+2,n)===42){var c=e.getUint32(u+4,n);c>=8&&(a=u+c)}}}if(a){var s=e.getUint16(a,n),y,f;for(f=0;f<s;f+=1)if(y=a+f*12+2,e.getUint16(y,n)===274){y+=8,o=e.getUint16(y,n),e.setUint16(y,1,n);break}}}catch{o=1}return o}function co(t){var e=0,o=1,n=1;switch(t){case 2:o=-1;break;case 3:e=-180;break;case 4:n=-1;break;case 5:e=90,n=-1;break;case 6:e=90;break;case 7:e=90,o=-1;break;case 8:e=-90;break}return{rotate:e,scaleX:o,scaleY:n}}var ho=/\.\d*(?:0|9){12}\d*$/;function Vt(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return ho.test(t)?Math.round(t*e)/e:t}function Re(t){var e=t.aspectRatio,o=t.height,n=t.width,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"none",a=Ie(n),d=Ie(o);if(a&&d){var r=o*e;(l==="contain"||l==="none")&&r>n||l==="cover"&&r<n?o=n/e:n=o*e}else a?o=n/e:d&&(n=o*e);return{width:n,height:o}}function fo(t){for(var e=lt(new Uint8Array(t)),o=e.length,n=[],l=0;l+3<o;){var a=e[l],d=e[l+1];if(a===255&&d===218)break;if(a===255&&d===216)l+=2;else{var r=e[l+2]*256+e[l+3],i=l+r+2,u=e.slice(l,i);n.push(u),l=i}}return n.reduce(function(v,c){return c[0]===255&&c[1]===225?v.concat(c):v},[])}function po(t,e){var o=lt(new Uint8Array(t));if(o[2]!==255||o[3]!==224)return t;var n=o[4]*256+o[5],l=[255,216].concat(e,o.slice(4+n));return new Uint8Array(l)}var mo=he.ArrayBuffer,Ge=he.FileReader,ve=he.URL||he.webkitURL,go=/\.\w+$/,vo=he.Compressor,yo=function(){function t(e,o){Zn(this,t),this.file=e,this.exif=[],this.image=new Image,this.options=He(He({},wt),o),this.aborted=!1,this.result=null,this.init()}return Qn(t,[{key:"init",value:function(){var o=this,n=this.file,l=this.options;if(!no(n)){this.fail(new Error("The first argument must be a File or Blob object."));return}var a=n.type;if(!qe(a)){this.fail(new Error("The first argument must be an image File or Blob object."));return}if(!ve||!Ge){this.fail(new Error("The current browser does not support image compression."));return}mo||(l.checkOrientation=!1,l.retainExif=!1);var d=a==="image/jpeg",r=d&&l.checkOrientation,i=d&&l.retainExif;if(ve&&!r&&!i)this.load({url:ve.createObjectURL(n)});else{var u=new Ge;this.reader=u,u.onload=function(v){var c=v.target,s=c.result,y={},f=1;r&&(f=uo(s),f>1&&$e(y,co(f))),i&&(o.exif=fo(s)),r||i?!ve||f>1?y.url=xt(s,a):y.url=ve.createObjectURL(n):y.url=s,o.load(y)},u.onabort=function(){o.fail(new Error("Aborted to read the image with FileReader."))},u.onerror=function(){o.fail(new Error("Failed to read the image with FileReader."))},u.onloadend=function(){o.reader=null},r||i?u.readAsArrayBuffer(n):u.readAsDataURL(n)}}},{key:"load",value:function(o){var n=this,l=this.file,a=this.image;a.onload=function(){n.draw(He(He({},o),{},{naturalWidth:a.naturalWidth,naturalHeight:a.naturalHeight}))},a.onabort=function(){n.fail(new Error("Aborted to load the image."))},a.onerror=function(){n.fail(new Error("Failed to load the image."))},he.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(he.navigator.userAgent)&&(a.crossOrigin="anonymous"),a.alt=l.name,a.src=o.url}},{key:"draw",value:function(o){var n=this,l=o.naturalWidth,a=o.naturalHeight,d=o.rotate,r=d===void 0?0:d,i=o.scaleX,u=i===void 0?1:i,v=o.scaleY,c=v===void 0?1:v,s=this.file,y=this.image,f=this.options,b=document.createElement("canvas"),p=b.getContext("2d"),_=Math.abs(r)%180===90,R=(f.resize==="contain"||f.resize==="cover")&&Ie(f.width)&&Ie(f.height),C=Math.max(f.maxWidth,0)||1/0,x=Math.max(f.maxHeight,0)||1/0,S=Math.max(f.minWidth,0)||0,k=Math.max(f.minHeight,0)||0,h=l/a,M=f.width,H=f.height;if(_){var P=[x,C];C=P[0],x=P[1];var B=[k,S];S=B[0],k=B[1];var fe=[H,M];M=fe[0],H=fe[1]}R&&(h=M/H);var pe=Re({aspectRatio:h,width:C,height:x},"contain");C=pe.width,x=pe.height;var me=Re({aspectRatio:h,width:S,height:k},"cover");if(S=me.width,k=me.height,R){var ge=Re({aspectRatio:h,width:M,height:H},f.resize);M=ge.width,H=ge.height}else{var re=Re({aspectRatio:h,width:M,height:H}),J=re.width;M=J===void 0?l:J;var V=re.height;H=V===void 0?a:V}M=Math.floor(Vt(Math.min(Math.max(M,S),C))),H=Math.floor(Vt(Math.min(Math.max(H,k),x)));var L=-M/2,K=-H/2,T=M,U=H,W=[];if(R){var Z=0,$=0,je=l,Xe=a,st=Re({aspectRatio:h,width:l,height:a},{contain:"cover",cover:"contain"}[f.resize]);je=st.width,Xe=st.height,Z=(l-je)/2,$=(a-Xe)/2,W.push(Z,$,je,Xe)}if(W.push(L,K,T,U),_){var rt=[H,M];M=rt[0],H=rt[1]}b.width=M,b.height=H,qe(f.mimeType)||(f.mimeType=s.type);var ut="transparent";s.size>f.convertSize&&f.convertTypes.indexOf(f.mimeType)>=0&&(f.mimeType="image/jpeg");var dt=f.mimeType==="image/jpeg";if(dt&&(ut="#fff"),p.fillStyle=ut,p.fillRect(0,0,M,H),f.beforeDraw&&f.beforeDraw.call(this,p,b),!this.aborted&&(p.save(),p.translate(M/2,H/2),p.rotate(r*Math.PI/180),p.scale(u,c),p.drawImage.apply(p,[y].concat(W)),p.restore(),f.drew&&f.drew.call(this,p,b),!this.aborted)){var ct=function(Ce){if(!n.aborted){var ht=function(Se){return n.done({naturalWidth:l,naturalHeight:a,result:Se})};if(Ce&&dt&&f.retainExif&&n.exif&&n.exif.length>0){var ft=function(Se){return ht(_t(xt(po(Se,n.exif),f.mimeType)))};if(Ce.arrayBuffer)Ce.arrayBuffer().then(ft).catch(function(){n.fail(new Error("Failed to read the compressed image with Blob.arrayBuffer()."))});else{var _e=new Ge;n.reader=_e,_e.onload=function(Ye){var Se=Ye.target;ft(Se.result)},_e.onabort=function(){n.fail(new Error("Aborted to read the compressed image with FileReader."))},_e.onerror=function(){n.fail(new Error("Failed to read the compressed image with FileReader."))},_e.onloadend=function(){n.reader=null},_e.readAsArrayBuffer(Ce)}}else ht(Ce)}};b.toBlob?b.toBlob(ct,f.mimeType,f.quality):ct(_t(b.toDataURL(f.mimeType,f.quality)))}}},{key:"done",value:function(o){var n=o.naturalWidth,l=o.naturalHeight,a=o.result,d=this.file,r=this.image,i=this.options;if(ve&&r.src.indexOf("blob:")===0&&ve.revokeObjectURL(r.src),a)if(i.strict&&!i.retainExif&&a.size>d.size&&i.mimeType===d.type&&!(i.width>n||i.height>l||i.minWidth>n||i.minHeight>l||i.maxWidth<n||i.maxHeight<l))a=d;else{var u=new Date;a.lastModified=u.getTime(),a.lastModifiedDate=u,a.name=d.name,a.name&&a.type!==d.type&&(a.name=a.name.replace(go,io(a.type)))}else a=d;this.result=a,i.success&&i.success.call(this,a)}},{key:"fail",value:function(o){var n=this.options;if(n.error)n.error.call(this,o);else throw o}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=vo,t}},{key:"setDefaults",value:function(o){$e(wt,o)}}]),t}();const bo={class:"img-wrap"},_o=["src"],wo=I({__name:"upload-img",props:{accept:{default:"*"}},emits:["change"],setup(t,{emit:e}){const o=t;let n=E(!1),l=E(),a="",d=Ut(""),r=ce({quality:.8,width:void 0,height:void 0,url:""});const i=async()=>{n.value=!0,await Ne()},u=E();Jn(u,p=>{let _=(p==null?void 0:p[0])??"";_&&s(_)});const c=()=>{a&&s(a)},s=p=>{let _=o.accept,R=p.name,C=R.substring(R.lastIndexOf(".")).toLowerCase();if(_!="*"&&!(o.accept.split(",").indexOf(C)>-1)){We.error("文件格式有误");return}a=p,new yo(p,{quality:r.quality,width:r.width||void 0,height:r.height||void 0,success(x){d.value=x;let S=new FileReader;S.onload=()=>{r.url=S.result,S=null},S.readAsDataURL(x)},error(){We.error("压缩图片失败")}})},y=()=>{n.value=!1},f=()=>{e("change",{url:r.url,file:d.value}),y()},b=()=>{l.value.resetFields(),r.url="",a=null,d.value=null};return(p,_)=>{const R=D("el-input-number"),C=D("el-form-item"),x=D("el-button"),S=D("el-form"),k=D("el-dialog");return A(),F(x,we({onClick:i},p.$attrs),{default:w(()=>[Pe(p.$slots,"default",{},()=>[N("上传图片")],!0),g(k,{"append-to-body":"","destroy-on-close":"",width:"1200px",modelValue:m(n),"onUpdate:modelValue":_[3]||(_[3]=h=>ue(n)?n.value=h:n=h),onClose:b},{footer:w(()=>[g(x,{onClick:y},{default:w(()=>[N("关闭")]),_:1}),g(x,{onClick:f},{default:w(()=>[N("确认")]),_:1})]),default:w(()=>[O("div",{class:"drap-wrap",ref_key:"dropZoneRef",ref:u},[g(De,{accept:p.accept,onChange:s},{default:w(()=>[N("拖拽或点击选择图片")]),_:1},8,["accept"])],512),g(S,{ref_key:"formRef",ref:l,style:{"margin-top":"20px"},model:m(r),inline:""},{default:w(()=>[g(C,{label:"质量"},{default:w(()=>[g(R,{modelValue:m(r).quality,"onUpdate:modelValue":_[0]||(_[0]=h=>m(r).quality=h),step:.1,max:1,min:.1},null,8,["modelValue"])]),_:1}),g(C,{label:"宽度",prop:"width"},{default:w(()=>[g(R,{modelValue:m(r).width,"onUpdate:modelValue":_[1]||(_[1]=h=>m(r).width=h)},null,8,["modelValue"])]),_:1}),g(C,{label:"高度",prop:"height"},{default:w(()=>[g(R,{modelValue:m(r).height,"onUpdate:modelValue":_[2]||(_[2]=h=>m(r).height=h)},null,8,["modelValue"])]),_:1}),g(C,null,{default:w(()=>{var h;return[g(x,{type:"primary",onClick:c},{default:w(()=>[N("重新处理")]),_:1}),N(" "+de(((h=m(d))==null?void 0:h.size)/1e3||0)+"KB ",1)]}),_:1})]),_:1},8,["model"]),O("div",bo,[O("img",{class:"img",src:m(r).url,alt:""},null,8,_o)])]),_:1},8,["modelValue"])]),_:3},16)}}});const xo=j(wo,[["__scopeId","data-v-d152d338"]]),Vo={class:"toolbar-wrap"},Mo={class:"label"},Co={class:"preview-wrap"},So={class:"preview-wrap-json"},Ro=I({__name:"index",setup(t){let e=tt("pannel",E({components:[]})),o=ce({name1:"哈哈",state:1}),n=Y(()=>e.components.filter(b=>b.active));setInterval(()=>{o.state=o.state==1?2:1,o.rate=o.rate=="40%"?"100%":"40%"},1e3);const l=({url:b})=>{let p=new Image;p.src=b,p.onload=()=>{e.components.push({w:p.width,h:p.height,self:{id:ee(),name:"Image",desc:"图片",url:b}})}},a=b=>{const p=new FileReader;p.onload=()=>{const _=p.result;let R=new Image;R.src=_,R.onload=()=>{e.components.push({w:R.width,h:R.height,self:{id:ee(),name:"Image",desc:"图片",url:_}})}},p.readAsDataURL(b)},d=b=>{let p=new FileReader,_=new FileReader;p.onload=()=>{const R=p.result;let C=new Image;C.src=R,C.onload=()=>{let x=C.width,S=C.height;_.onload=()=>{e.components.push({w:x,h:S,self:{id:ee(),name:"icon-svg",desc:"缩放图片",url:_.result}}),_.abort(),p.abort(),p=null,_=null},_.readAsText(b)}},p.readAsDataURL(b)};let r=E(!1);const i=()=>{r.value=!0};let u=E(!1);const v=()=>{u.value=!0},c=b=>{const p=new FileReader;p.onload=()=>{const _=p.result;let R=new Image;R.src=_,R.onload=()=>{e.components.push({w:R.width,h:R.height,self:{id:ee(),name:"img-scale",url:_}})}},p.readAsDataURL(b)},s=async()=>{let b=n.value||[],p=[];b.forEach(M=>{M.self.name=="Group"?p.push(...f(M)):p.push(M)});let{left:_,right:R,top:C,bottom:x}=sn(p),S=p.map(M=>({...M,active:!1,preventDeactivation:!1,x:M.x-_,y:M.y-C})),k=e.components.filter(M=>n.value.every(H=>M!==H)),h={x:_,y:C,w:R-_,h:x-C,self:{id:ee(),desc:"组合",name:"Group"},group:S};k.push(h),await Ne(),e.components=k},y=()=>{var R;let b=((R=n.value)==null?void 0:R[0])??{},p=f(b),_=e.components.filter(C=>b!==C);_.push(...p),e.components=_},f=b=>{let p=(b==null?void 0:b.group)??[],_=b.x,R=b.y;return p.map(C=>({...C,x:_+C.x,y:R+C.y}))};return(b,p)=>{var x,S,k;const _=D("el-button"),R=D("el-input-number"),C=D("el-dialog");return A(),z(q,null,[O("div",Vo,[g(xo,{accept:".png,.gif,.jpg,.jpeg",type:"primary",plain:"",onChange:l},{default:w(()=>[N("上传图片并压缩")]),_:1}),g(De,{accept:".png,.gif,.jpg,.jpeg",onChange:a},{default:w(()=>[N("上传图片")]),_:1}),g(De,{accept:".svg",onChange:d},{default:w(()=>[N("上传svg")]),_:1}),g(De,{accept:".png,.gif,.jpg,.jpeg",onChange:c},{default:w(()=>[N("上传缩放图片")]),_:1}),g(_,{type:"primary",plain:"",onClick:i},{default:w(()=>[N("预览")]),_:1}),g(_,{type:"primary",plain:"",onClick:v},{default:w(()=>[N("json")]),_:1}),g(_,{type:"primary",disabled:m(n).length<=1,plain:"",onClick:s},{default:w(()=>[N(" 组合")]),_:1},8,["disabled"]),g(_,{type:"primary",disabled:m(n).length!=1||((k=(S=(x=m(n))==null?void 0:x[0])==null?void 0:S.self)==null?void 0:k.name)!="Group",plain:"",onClick:p[0]||(p[0]=h=>y())},{default:w(()=>[N(" 拆分")]),_:1},8,["disabled"]),O("div",Mo,[N(" 缩放 "),g(R,{size:"small",step:.1,modelValue:m(Le),"onUpdate:modelValue":p[1]||(p[1]=h=>ue(Le)?Le.value=h:null)},null,8,["modelValue"])])]),g(C,{"align-center":"","append-to-body":"",width:"1040px",title:"预览","destroy-on-close":"",modelValue:m(r),"onUpdate:modelValue":p[3]||(p[3]=h=>ue(r)?r.value=h:r=h)},{default:w(()=>[O("div",Co,[m(r)?(A(),F(Dt,{key:0,pannel:m(e),modelValue:m(o),"onUpdate:modelValue":p[2]||(p[2]=h=>ue(o)?o.value=h:o=h)},null,8,["pannel","modelValue"])):se("",!0)])]),_:1},8,["modelValue"]),g(C,{"align-center":"","append-to-body":"",width:"1200px",title:"预览JSON",modelValue:m(u),"onUpdate:modelValue":p[4]||(p[4]=h=>ue(u)?u.value=h:u=h)},{default:w(()=>[O("div",So,[O("pre",null,de(m(e)),1)])]),_:1},8,["modelValue"])],64)}}});const ko=j(Ro,[["__scopeId","data-v-d19a4780"]]),Ao=I({__name:"index",setup(t,{expose:e}){let o=E([]),n=E([]);return e({init:a=>{o.value=a.vLine,n.value=a.hLine}}),(a,d)=>(A(),z(q,null,[(A(!0),z(q,null,oe(m(o),(r,i)=>Qe((A(),z("span",{class:"ref-line v-line",key:"v_"+i,style:ae({left:r.position,top:r.origin,height:r.lineLength})},null,4)),[[zt,r.display]])),128)),(A(!0),z(q,null,oe(m(n),(r,i)=>(A(),z("span",{class:"ref-line h-line",key:"h_"+i,style:ae({top:r.position,left:r.origin,width:r.lineLength})},null,4))),128))],64))}});const Lo=j(Ao,[["__scopeId","data-v-3b7aeeb1"]]);function Ae(t){var e;const o=Q(t);return(e=o==null?void 0:o.$el)!=null?e:o}const It=Ve?window:void 0;function Be(...t){let e,o,n,l;if(typeof t[0]=="string"||Array.isArray(t[0])?([o,n,l]=t,e=It):[e,o,n,l]=t,!e)return xe;Array.isArray(o)||(o=[o]),Array.isArray(n)||(n=[n]);const a=[],d=()=>{a.forEach(v=>v()),a.length=0},r=(v,c,s,y)=>(v.addEventListener(c,s,y),()=>v.removeEventListener(c,s,y)),i=ne(()=>[Ae(e),Q(l)],([v,c])=>{if(d(),!v)return;const s=Ot(c)?{...c}:c;a.push(...o.flatMap(y=>n.map(f=>r(v,y,f,s))))},{immediate:!0,flush:"post"}),u=()=>{i(),d()};return Fe(u),u}let Mt=!1;function Ct(t,e,o={}){const{window:n=It,ignore:l=[],capture:a=!0,detectIframe:d=!1}=o;if(!n)return;Ke&&!Mt&&(Mt=!0,Array.from(n.document.body.children).forEach(s=>s.addEventListener("click",xe)),n.document.documentElement.addEventListener("click",xe));let r=!0;const i=s=>l.some(y=>{if(typeof y=="string")return Array.from(n.document.querySelectorAll(y)).some(f=>f===s.target||s.composedPath().includes(f));{const f=Ae(y);return f&&(s.target===f||s.composedPath().includes(f))}}),v=[Be(n,"click",s=>{const y=Ae(t);if(!(!y||y===s.target||s.composedPath().includes(y))){if(s.detail===0&&(r=!i(s)),!r){r=!0;return}e(s)}},{passive:!0,capture:a}),Be(n,"pointerdown",s=>{const y=Ae(t);y&&(r=!s.composedPath().includes(y)&&!i(s))},{passive:!0}),d&&Be(n,"blur",s=>{setTimeout(()=>{var y;const f=Ae(t);((y=n.document.activeElement)==null?void 0:y.tagName)==="IFRAME"&&!(f!=null&&f.contains(n.document.activeElement))&&e(s)},0)})].filter(Boolean);return()=>v.forEach(s=>s())}const To={[gt.mounted](t,e){const o=!e.modifiers.bubble;if(typeof e.value=="function")t.__onClickOutside_stop=Ct(t,e.value,{capture:o});else{const[n,l]=e.value;t.__onClickOutside_stop=Ct(t,n,Object.assign({capture:o},l))}},[gt.unmounted](t){t.__onClickOutside_stop()}};function Je(t){return typeof Window<"u"&&t instanceof Window?t.document.documentElement:typeof Document<"u"&&t instanceof Document?t.documentElement:t}function Nt(t){const e=window.getComputedStyle(t);if(e.overflowX==="scroll"||e.overflowY==="scroll"||e.overflowX==="auto"&&t.clientWidth<t.scrollWidth||e.overflowY==="auto"&&t.clientHeight<t.scrollHeight)return!0;{const o=t.parentNode;return!o||o.tagName==="BODY"?!1:Nt(o)}}function zo(t){const e=t||window.event,o=e.target;return Nt(o)?!1:e.touches.length>1?!0:(e.preventDefault&&e.preventDefault(),!1)}function Eo(t,e=!1){const o=E(e);let n=null,l;ne($n(t),r=>{const i=Je(Q(r));if(i){const u=i;l=u.style.overflow,o.value&&(u.style.overflow="hidden")}},{immediate:!0});const a=()=>{const r=Je(Q(t));!r||o.value||(Ke&&(n=Be(r,"touchmove",i=>{zo(i)},{passive:!1})),r.style.overflow="hidden",o.value=!0)},d=()=>{const r=Je(Q(t));!r||!o.value||(Ke&&(n==null||n()),r.style.overflow=l,o.value=!1)};return Fe(d),Y({get(){return o.value},set(r){r?a():d()}})}function Ho(){let t=!1;const e=E(!1);return(o,n)=>{if(e.value=n.value,t)return;t=!0;const l=Eo(o,n.value);ne(e,a=>l.value=a)}}Ho();function St(...t){return Y(()=>t.every(e=>Q(e)))}const Uo=["onClick"],Do=I({__name:"index",props:{pannel:{},modelValue:{default:()=>({})},disabled:{type:Boolean,default:!1},active:{default:()=>[]}},emits:["refLineParams"],setup(t,{expose:e,emit:o}){const n=t;let l=E(!1),a=Y(()=>({transform:`scale(${Le.value})`,transformOrigin:"50% 0%",width:n.pannel.width+"px",height:n.pannel.height+"px",color:n.pannel.color,fontSize:n.pannel.fontSize,backgroundColor:n.pannel.bgColor}));const{text:d,copy:r}=Gn({legacy:!0});let i=E(),u=ce({isAllAsync:!1,controlKey:!1,draggingId:null,prevOffsetX:0,prevOffsetY:0});Ee(()=>{s()}),Kt(()=>{p()});const v=V=>({fontSize:n.pannel.fontSize||V.fontSize}),c=V=>{var L;return((L=ot(V))==null?void 0:L.default)??""},s=()=>{const V=jn(),L=Y(()=>{var U,W,Z;return((U=V.value)==null?void 0:U.tagName)!=="INPUT"&&((W=V.value)==null?void 0:W.tagName)!=="TEXTAREA"&&((Z=V.value)==null?void 0:Z.getAttribute("contenteditable"))!=="true"&&l.value}),{Ctrl_C:K,Ctrl_V:T}=qn();vt(St(K,L),()=>{y()}),vt(St(T,L),()=>{f()})},y=()=>{if(n.active.length)try{let V=JSON.stringify(n.active);r(V)}catch{}};let f=()=>{try{n.pannel.components.forEach(L=>{L.active=!1});let V=JSON.parse(d.value);V.forEach(L=>{L.active=!0}),n.pannel.components.push(...V),console.log(n.pannel)}catch{}};const b=()=>{l.value=!0,window.addEventListener("keydown",R),window.addEventListener("keyup",C),window.addEventListener("keydown",x),window.addEventListener("keyup",S)},p=()=>{window.removeEventListener("keydown",R),window.removeEventListener("keyup",C),window.removeEventListener("keydown",x),window.removeEventListener("keyup",S)},_=()=>{p(),l.value=!1},R=V=>{V.keyCode===32&&(V.preventDefault(),u.isAllAsync=!0)},C=V=>{V.keyCode===32&&(V.preventDefault(),u.isAllAsync=!1)},x=V=>{V.keyCode===17&&(u.controlKey=!0)},S=V=>{V.keyCode===17&&(u.controlKey=!1)};let k=E();const h=V=>{var L;(L=k.value)==null||L.init(V)},M=V=>{u.controlKey?V.preventDeactivation=!0:n.pannel.components.forEach(L=>{L.active=!1,L.preventDeactivation=!1}),V.preventDeactivation=!0,V.active=!0},H=V=>{V.active=!1,V.preventDeactivation=!1},P=()=>{n.disabled||(b(),n.pannel.components.forEach(V=>{V.active=!1,V.preventDeactivation=!1}))},B=(V,L,K,T,U)=>{Object.assign(U,{x:V,y:L,w:K||U.width,h:T||U.width})},fe=(V,L,K)=>{u.draggingId=V;const T=L-(V.x??0),U=K-(V.y??0),W=me(T),Z=ge(U);if(!u.isAllAsync){n.pannel.components.forEach($=>{$.active&&$!==V&&($.x=($.x??0)+W,$.y=($.y??0)+Z)});return}n.pannel.components.forEach($=>{$!==V&&($.x=($.x??0)+W,$.y=($.y??0)+Z)})},pe=(V,L,K)=>{n.pannel.components.forEach(T=>{T===V&&(T.x=L,T.y=K)}),u.draggingId=null,u.prevOffsetX=0,u.prevOffsetY=0},me=V=>{const L=V-u.prevOffsetX;return u.prevOffsetX=V,L},ge=V=>{const L=V-u.prevOffsetY;return u.prevOffsetY=V,L},re=(V,L)=>{L.r=V},J=V=>nt(V,n.modelValue);return e({ref:i}),(V,L)=>{const K=D("VueDragResizeRotate");return Qe((A(),z("div",{ref_key:"dragRef",ref:i,class:be({"drag-editor-wrap":!0,disabled:V.disabled}),onClick:Te(P,["self","stop"]),onMousedown:L[0]||(L[0]=T=>b()),style:ae(m(a))},[(A(!0),z(q,null,oe(V.pannel.components,T=>(A(),F(K,we({...m(Bt),...T,self:"",dySelf:""},{onActivated:U=>M(T),onDeactivated:U=>H(T),onRefLineParams:h,onResizing:(U,W,Z,$)=>B(U,W,Z,$,T),onResizestop:(U,W,Z,$)=>B(U,W,Z,$,T),onDragging:(U,W)=>fe(T,U,W),onDragstop:(U,W)=>pe(T,U,W),onRotating:U=>re(U,T),onRotatestop:U=>re(U,T),scaleRatio:m(Le)}),{default:w(()=>[(A(),F(et(c(T.self.name)),we({data:T,h:T.h,w:T.w},J(T),{style:v(T),modelValue:V.modelValue[T.self.modelValue],"onUpdate:modelValue":U=>V.modelValue[T.self.modelValue]=U,defaultModelValue:T.self.defaultModelValue,"onUpdate:defaultModelValue":U=>T.self.defaultModelValue=U,groupModel:V.modelValue}),null,16,["data","h","w","style","modelValue","onUpdate:modelValue","defaultModelValue","onUpdate:defaultModelValue","groupModel"]))]),_:2},1040,["onActivated","onDeactivated","onResizing","onResizestop","onDragging","onDragstop","onRotating","onRotatestop","scaleRatio"]))),256)),g(Lo,{ref_key:"subLineRef",ref:k},null,512)],46,Uo)),[[m(To),_]])}}});const Bo=j(Do,[["__scopeId","data-v-11c6675d"]]),Oo=["data-index"],Po=I({__name:"components-list",setup(t){const e=o=>{let n=JSON.stringify(mt[o.target.dataset.index]);o.dataTransfer.setData("component",n)};return(o,n)=>(A(),z("div",{class:"component-list",onDragstart:e},[(A(!0),z(q,null,oe(m(mt),(l,a)=>(A(),z("div",{key:a,class:"list",draggable:!0,"data-index":a},[O("span",null,de(l.self.desc),1)],8,Oo))),128))],32))}});const Wo=j(Po,[["__scopeId","data-v-98fa6a58"]]),$o={class:"com-list-wrap"},Io={class:"com-wrap"},No={class:"real-com-wrap"},Fo=["onClick"],jo=["onClick"],Xo=I({__name:"index",setup(t){let e=tt("pannel",E({}));const o=l=>{l.active=!0},n=l=>{e.components=e.components.filter(a=>a!==l)};return(l,a)=>{const d=D("el-icon"),r=D("el-scrollbar");return A(),z("div",$o,[O("div",Io,[g(Wo)]),g(r,{height:"50%",always:""},{default:w(()=>[O("div",No,[(A(!0),z(q,null,oe(m(e).components,i=>(A(),z("div",{class:be({"com-item":!0,active:i.active}),onClick:u=>o(i)},[O("div",{class:"close-wrap",onClick:Te(u=>n(i),["stop"])},[g(d,null,{default:w(()=>[g(m(tn))]),_:1})],8,jo),N(" "+de(i.self.desc||i.self.name)+" "+de(i.self.name=="Group"?i.group.length:""),1)],10,Fo))),256))])]),_:1})])}}});const Yo=j(Xo,[["__scopeId","data-v-d9d007a9"]]),Go=I({__name:"platform",props:{pannel:{}},setup(t){return(e,o)=>{const n=D("el-input"),l=D("el-form-item"),a=D("el-input-number"),d=D("el-color-picker"),r=D("el-form");return A(),F(r,{size:"small"},{default:w(()=>[g(l,{label:"版本"},{default:w(()=>[g(n,{modelValue:e.pannel.version,"onUpdate:modelValue":o[0]||(o[0]=i=>e.pannel.version=i)},null,8,["modelValue"])]),_:1}),g(l,{label:"描述"},{default:w(()=>[g(n,{modelValue:e.pannel.desc,"onUpdate:modelValue":o[1]||(o[1]=i=>e.pannel.desc=i)},null,8,["modelValue"])]),_:1}),g(l,{label:"宽度"},{default:w(()=>[g(a,{modelValue:e.pannel.width,"onUpdate:modelValue":o[2]||(o[2]=i=>e.pannel.width=i)},null,8,["modelValue"])]),_:1}),g(l,{label:"高度"},{default:w(()=>[g(a,{modelValue:e.pannel.height,"onUpdate:modelValue":o[3]||(o[3]=i=>e.pannel.height=i)},null,8,["modelValue"])]),_:1}),g(l,{label:"文字颜色"},{default:w(()=>[g(d,{modelValue:e.pannel.color,"onUpdate:modelValue":o[4]||(o[4]=i=>e.pannel.color=i)},null,8,["modelValue"])]),_:1}),g(l,{label:"背景色"},{default:w(()=>[g(d,{modelValue:e.pannel.bgColor,"onUpdate:modelValue":o[5]||(o[5]=i=>e.pannel.bgColor=i)},null,8,["modelValue"])]),_:1}),g(l,{label:"文字大小"},{default:w(()=>[g(n,{placeholder:"0px",modelValue:e.pannel.fontSize,"onUpdate:modelValue":o[6]||(o[6]=i=>e.pannel.fontSize=i)},null,8,["modelValue"])]),_:1})]),_:1})}}});const Jo=j(Go,[["__scopeId","data-v-6ad875fe"]]),Ft=t=>(qt("data-v-7056c102"),t=t(),Zt(),t),Ko={key:2},qo={key:3},Zo={key:4},Qo=Ft(()=>O("br",null,null,-1)),ea=Ft(()=>O("br",null,null,-1)),ta=I({__name:"componentsAttr",props:{active:{}},setup(t){const e=t;let o=E(["1","3","2"]),n=Y(()=>{if(e.active){let c={...Bt,...e.active};return Object.assign(e.active,c)}return e.active}),l=[{label:"靠上",value:"top"},{label:"靠下",value:"bottom"},{label:"靠左",value:"left"},{label:"靠右",value:"right"}],a=[{label:"大于",value:"大于"},{label:"小于",value:"小于"},{label:"等于",value:"等于"},{label:"不等于",value:"不等于"},{label:"大于等于",value:"大于等于"},{label:"小于等于",value:"小于等于"},{label:"存在(!null && !undefind)",value:"存在"},{label:"不存在(null || undefind)",value:"不存在"}],d=["Text","Shape"],r=Y(()=>d.indexOf(e.active.self.name)>-1),i=Y(()=>e.active.self.name=="Image"),u=Y(()=>e.active.self.name=="img-scale"),v=Y(()=>e.active.self.name=="icon-svg");return(c,s)=>{const y=D("el-input"),f=D("el-form-item"),b=D("el-switch"),p=D("el-color-picker"),_=D("el-form"),R=D("el-collapse-item"),C=D("el-option"),x=D("el-select"),S=D("el-input-number"),k=D("el-collapse");return A(),F(k,{modelValue:m(o),"onUpdate:modelValue":s[36]||(s[36]=h=>ue(o)?o.value=h:o=h)},{default:w(()=>[g(R,{title:"特有属性",name:"1"},{default:w(()=>[g(_,{size:"small"},{default:w(()=>[g(f,{label:"组件名称",title:"self.name"},{default:w(()=>[g(y,{disabled:"",modelValue:m(n).self.name,"onUpdate:modelValue":s[0]||(s[0]=h=>m(n).self.name=h)},null,8,["modelValue"])]),_:1}),g(f,{label:"组件id",title:"self.id"},{default:w(()=>[g(y,{modelValue:m(n).self.id,"onUpdate:modelValue":s[1]||(s[1]=h=>m(n).self.id=h)},null,8,["modelValue"])]),_:1}),g(f,{label:"点击事件",title:"self.click"},{default:w(()=>[g(b,{modelValue:m(n).self.click,"onUpdate:modelValue":s[2]||(s[2]=h=>m(n).self.click=h)},null,8,["modelValue"])]),_:1}),g(f,{label:"width",title:"w"},{default:w(()=>[g(y,{modelValue:m(n).w,"onUpdate:modelValue":s[3]||(s[3]=h=>m(n).w=h)},null,8,["modelValue"])]),_:1}),g(f,{label:"height",title:"h"},{default:w(()=>[g(y,{modelValue:m(n).h,"onUpdate:modelValue":s[4]||(s[4]=h=>m(n).h=h)},null,8,["modelValue"])]),_:1}),m(u)?(A(),F(f,{key:0,label:"图片内部宽度",title:"self.imgWidth"},{default:w(()=>[g(y,{modelValue:m(n).self.imgWidth,"onUpdate:modelValue":s[5]||(s[5]=h=>m(n).self.imgWidth=h),placeholder:"动态控制%"},null,8,["modelValue"])]),_:1})):se("",!0),m(u)?(A(),F(f,{key:1,label:"图片内部高度",title:"self.imgHeight"},{default:w(()=>[g(y,{modelValue:m(n).self.imgHeight,"onUpdate:modelValue":s[6]||(s[6]=h=>m(n).self.imgHeight=h),placeholder:"动态控制%"},null,8,["modelValue"])]),_:1})):se("",!0),m(v)?(A(),z("div",Ko,[g(f,{label:"icon自定义颜色",title:"self.iconUseSelfColor"},{default:w(()=>[g(b,{modelValue:m(n).self.iconUseSelfColor,"onUpdate:modelValue":s[7]||(s[7]=h=>m(n).self.iconUseSelfColor=h)},null,8,["modelValue"])]),_:1}),g(f,{label:"icon背景色",title:"self.fillColor"},{default:w(()=>[g(p,{modelValue:m(n).self.fillColor,"onUpdate:modelValue":s[8]||(s[8]=h=>m(n).self.fillColor=h)},null,8,["modelValue"])]),_:1})])):se("",!0),g(f,{label:"颜色",title:"self.color"},{default:w(()=>[g(p,{modelValue:m(n).self.color,"onUpdate:modelValue":s[9]||(s[9]=h=>m(n).self.color=h)},null,8,["modelValue"])]),_:1}),g(f,{label:"背景色",title:"self.bgColor"},{default:w(()=>[g(p,{modelValue:m(n).self.bgColor,"onUpdate:modelValue":s[10]||(s[10]=h=>m(n).self.bgColor=h)},null,8,["modelValue"])]),_:1}),g(f,{label:"边框",title:"self.borderColor"},{default:w(()=>[g(y,{placeholder:"solid 1px #000000",modelValue:m(n).self.borderColor,"onUpdate:modelValue":s[11]||(s[11]=h=>m(n).self.borderColor=h)},null,8,["modelValue"])]),_:1}),g(f,{label:"padding",title:"self.padding"},{default:w(()=>[g(y,{modelValue:m(n).self.padding,"onUpdate:modelValue":s[12]||(s[12]=h=>m(n).self.padding=h),placeholder:"0px 0px 0px 0px"},null,8,["modelValue"])]),_:1}),g(f,{label:"radius",title:"self.radius"},{default:w(()=>[g(y,{modelValue:m(n).self.radius,"onUpdate:modelValue":s[13]||(s[13]=h=>m(n).self.radius=h),placeholder:"0px 0px 0px 0px"},null,8,["modelValue"])]),_:1}),g(f,{label:"文字大小",title:"self.fontSize"},{default:w(()=>[g(y,{modelValue:m(n).self.fontSize,"onUpdate:modelValue":s[14]||(s[14]=h=>m(n).self.fontSize=h),placeholder:"0px"},null,8,["modelValue"])]),_:1}),g(f,{label:"modelValue",title:"self.modelValue"},{default:w(()=>[g(y,{placeholder:"绑定属性",modelValue:m(n).self.modelValue,"onUpdate:modelValue":s[15]||(s[15]=h=>m(n).self.modelValue=h)},null,8,["modelValue"])]),_:1}),m(r)?(A(),z("div",qo,[g(f,{label:"默认值",title:"self.defaultModelValue"},{default:w(()=>[g(y,{modelValue:m(n).self.defaultModelValue,"onUpdate:modelValue":s[16]||(s[16]=h=>m(n).self.defaultModelValue=h)},null,8,["modelValue"])]),_:1}),g(f,{label:"禁止换行",title:"self.noWordWrap"},{default:w(()=>[g(b,{modelValue:m(n).self.noWordWrap,"onUpdate:modelValue":s[17]||(s[17]=h=>m(n).self.noWordWrap=h)},null,8,["modelValue"])]),_:1}),g(f,{label:"超出省略",title:"self.overEllipsis"},{default:w(()=>[g(b,{modelValue:m(n).self.overEllipsis,"onUpdate:modelValue":s[18]||(s[18]=h=>m(n).self.overEllipsis=h)},null,8,["modelValue"])]),_:1})])):se("",!0),m(i)||m(u)?(A(),z("div",Zo,[g(f,{label:"url",title:"self.url"},{default:w(()=>[g(y,{modelValue:m(n).self.url,"onUpdate:modelValue":s[19]||(s[19]=h=>m(n).self.url=h)},null,8,["modelValue"])]),_:1})])):se("",!0)]),_:1})]),_:1}),g(R,{title:"逻辑处理",name:"3"},{default:w(()=>[g(_,{size:"small","label-position":"top"},{default:w(()=>[g(f,{label:"prop",title:"self.prop"},{default:w(()=>[g(y,{placeholder:"绑定属性",modelValue:m(n).self.prop,"onUpdate:modelValue":s[20]||(s[20]=h=>m(n).self.prop=h)},null,8,["modelValue"])]),_:1}),g(f,{label:"值匹配"},{default:w(()=>[g(x,{title:"self.activeMode",modelValue:m(n).self.activeMode,"onUpdate:modelValue":s[21]||(s[21]=h=>m(n).self.activeMode=h)},{default:w(()=>[(A(!0),z(q,null,oe(m(a),h=>(A(),F(C,{label:h.label,value:h.value},null,8,["label","value"]))),256))]),_:1},8,["modelValue"]),Qo,ea,g(y,{title:"self.activeValue",placeholder:`1 (${m(n).self.prop||"prop"}${m(n).self.activeMode||""}1)`,modelValue:m(n).self.activeValue,"onUpdate:modelValue":s[22]||(s[22]=h=>m(n).self.activeValue=h)},null,8,["placeholder","modelValue"])]),_:1}),g(f,{label:"匹配后重置属性",title:"self.activeMap"},{default:w(()=>[g(y,{type:"textarea",placeholder:'{"bgColor":"red || ${red}"}',modelValue:m(n).self.activeMap,"onUpdate:modelValue":s[23]||(s[23]=h=>m(n).self.activeMap=h)},null,8,["modelValue"])]),_:1}),m(u)?(A(),F(f,{key:0,label:"图片比例固定",title:"self.lockAspectRatio"},{default:w(()=>[g(b,{modelValue:m(n).self.lockAspectRatio,"onUpdate:modelValue":s[24]||(s[24]=h=>m(n).self.lockAspectRatio=h)},null,8,["modelValue"])]),_:1})):se("",!0),m(u)?(A(),F(f,{key:1,label:"图片比例起始位置",title:"self.position"},{default:w(()=>[g(x,{modelValue:m(n).self.position,"onUpdate:modelValue":s[25]||(s[25]=h=>m(n).self.position=h)},{default:w(()=>[(A(!0),z(q,null,oe(m(l),h=>(A(),F(C,{label:h.label,value:h.value},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})):se("",!0)]),_:1})]),_:1}),g(R,{title:"通用属性",name:"2"},{default:w(()=>[g(_,{size:"small"},{default:w(()=>[g(f,{label:"left"},{default:w(()=>[g(S,{modelValue:m(n).x,"onUpdate:modelValue":s[26]||(s[26]=h=>m(n).x=h)},null,8,["modelValue"])]),_:1}),g(f,{label:"top"},{default:w(()=>[g(S,{modelValue:m(n).y,"onUpdate:modelValue":s[27]||(s[27]=h=>m(n).y=h)},null,8,["modelValue"])]),_:1}),g(f,{label:"zIndex"},{default:w(()=>[g(S,{modelValue:m(n).z,"onUpdate:modelValue":s[28]||(s[28]=h=>m(n).z=h)},null,8,["modelValue"])]),_:1}),g(f,{label:"旋转"},{default:w(()=>[g(S,{min:0,modelValue:m(n).r,"onUpdate:modelValue":s[29]||(s[29]=h=>m(n).r=h)},null,8,["modelValue"])]),_:1}),g(f,{label:"锁定比例"},{default:w(()=>[g(b,{modelValue:m(n).lockAspectRatio,"onUpdate:modelValue":s[30]||(s[30]=h=>m(n).lockAspectRatio=h)},null,8,["modelValue"])]),_:1}),g(f,{label:"缩放"},{default:w(()=>[g(b,{modelValue:m(n).resizable,"onUpdate:modelValue":s[31]||(s[31]=h=>m(n).resizable=h)},null,8,["modelValue"])]),_:1}),g(f,{label:"旋转"},{default:w(()=>[g(b,{modelValue:m(n).rotatable,"onUpdate:modelValue":s[32]||(s[32]=h=>m(n).rotatable=h)},null,8,["modelValue"])]),_:1}),g(f,{label:"父级约束"},{default:w(()=>[g(b,{modelValue:m(n).parent,"onUpdate:modelValue":s[33]||(s[33]=h=>m(n).parent=h)},null,8,["modelValue"])]),_:1}),g(f,{label:"吸附"},{default:w(()=>[g(b,{modelValue:m(n).snap,"onUpdate:modelValue":s[34]||(s[34]=h=>m(n).snap=h)},null,8,["modelValue"])]),_:1}),g(f,{label:"吸附距离"},{default:w(()=>[g(S,{modelValue:m(n).snapTolerance,"onUpdate:modelValue":s[35]||(s[35]=h=>m(n).snapTolerance=h)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}});const na=j(ta,[["__scopeId","data-v-7056c102"]]),oa={class:"wrap"},aa=I({__name:"index",props:{active:{default:()=>({})},activeLength:{}},setup(t){const e=t;let o=E(""),n=tt("pannel",ce({}));return ne(()=>e.activeLength,l=>{l==1?o.value="com":o.value="plat"},{immediate:!0}),(l,a)=>{const d=D("el-tab-pane"),r=D("el-tabs");return A(),z("div",oa,[g(r,{modelValue:m(o),"onUpdate:modelValue":a[0]||(a[0]=i=>ue(o)?o.value=i:o=i),class:"demo-tabs"},{default:w(()=>[g(d,{label:"平台",name:"plat"},{default:w(()=>[g(Jo,{pannel:m(n)},null,8,["pannel"])]),_:1}),g(d,{label:"组件",name:"com"},{default:w(()=>[l.activeLength==1?(A(),F(na,{key:0,active:l.active},null,8,["active"])):se("",!0)]),_:1})]),_:1},8,["modelValue"])])}}});const la=j(aa,[["__scopeId","data-v-fba398cd"]]),ia={class:"container"},sa={class:"left"},ra={class:"mid",ref:"midRef"},ua={class:"right"},da=I({__name:"App",setup(t){let e=ce({version:"0.1",desc:"描述",width:1e3,height:700,components:[]}),o=E(),n=E();Qt("pannel",e);let l=Y(()=>{var i,u;return(u=(i=e.components)==null?void 0:i.filter)==null?void 0:u.call(i,v=>v.active)});ne(()=>e.width,()=>{var i,u;(u=(i=n.value)==null?void 0:i.update)==null||u.call(i)},{flush:"post"});let a=ce({name1:"哈哈",state:1});setInterval(()=>{a.state=a.state==1?2:1,a.red=a.red=="red"?"green":"red",a.rate=a.rate=="40%"?"100%":"40%"},1e3);const d=i=>{i.preventDefault(),i.stopPropagation();const u=i.dataTransfer.getData("component");let v=JSON.parse(u);const c=o.value.ref.getBoundingClientRect();v&&(v.y=i.clientY-c.y,v.x=i.clientX-c.x,v.self.id=ee(),e.components.push(v))},r=i=>{i.preventDefault(),i.dataTransfer.dropEffect="copy"};return(i,u)=>{const v=D("el-scrollbar");return A(),z(q,null,[g(ko),O("div",ia,[O("div",sa,[g(Yo)]),O("div",ra,[g(v,{ref_key:"editScrollRef",ref:n,always:""},{default:w(()=>[g(Bo,{ref_key:"editorRef",ref:o,onDrop:d,onDragover:r,pannel:m(e),modelValue:m(a),"onUpdate:modelValue":u[0]||(u[0]=c=>ue(a)?a.value=c:a=c),active:m(l)},null,8,["pannel","modelValue","active"])]),_:1},512)],512),O("div",ua,[g(v,null,{default:w(()=>[g(la,{activeLength:m(l).length,active:m(l)[0]},null,8,["activeLength","active"])]),_:1})])])],64)}}});const ca=j(da,[["__scopeId","data-v-5566b201"]]);const Rt=new WeakMap;function ha(t){let e=Rt.get(t);return e||Rt.set(t,e=Object.create(null)),e}function G(t,e,...o){t&&t.$emit&&t.$emit(e,...o);const n=ha(t)[e];return n&&n.map(l=>l.apply(t,o)),t}function kt(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Function]"}function ke(t,e,o,n=1){const l=Math.round(e/n/t[0])*t[0],a=Math.round(o/n/t[1])*t[1];return[l,a]}function At(t,e,o){return t-e-o}function Lt(t,e,o){return t-e-o}function X(t,e,o){return e!==null&&t<e?e:o!==null&&o<t?o:t}function Ue(t,e,o,n,l){const a=Math.PI/180*l,d=Math.cos(a),r=Math.sin(a);let i=o-t,u=n-e;return{x:i*d-u*r+t,y:i*r+u*d+e}}function fa(t,e){let o=Math.atan2(e,t);return o=Math.round(180/Math.PI*o),o<0&&(o=360+o),o}function Tt(t,e,o){let n=t;const l=["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"].find(a=>kt(n[a]));if(!kt(n[l]))return!1;do{if(n[l](e))return!0;if(n===o)return!1;n=n.parentNode}while(n);return!1}function pa(t){const e=window.getComputedStyle(t);return[parseFloat(e.getPropertyValue("width"),10),parseFloat(e.getPropertyValue("height"),10)]}function ye(t,e,o){t&&(t.attachEvent?t.attachEvent("on"+e,o):t.addEventListener?t.addEventListener(e,o,!0):t["on"+e]=o)}function le(t,e,o){t&&(t.detachEvent?t.detachEvent("on"+e,o):t.removeEventListener?t.removeEventListener(e,o,!0):t["on"+e]=null)}const Oe={mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"},touch:{start:"touchstart",move:"touchmove",stop:"touchend"}},ma={userSelect:"none",MozUserSelect:"none",WebkitUserSelect:"none",MsUserSelect:"none"},ga={userSelect:"auto",MozUserSelect:"auto",WebkitUserSelect:"auto",MsUserSelect:"auto"};let ie=Oe.mouse;var Me={name:"VueDragResizeRotate",props:{className:{type:String,default:"vue-drag-resize-rotate"},classNameDraggable:{type:String,default:"draggable"},classNameResizable:{type:String,default:"resizable"},classNameRotatable:{type:String,default:"rotatable"},classNameDragging:{type:String,default:"dragging"},classNameResizing:{type:String,default:"resizing"},classNameRotating:{type:String,default:"rotating"},classNameActive:{type:String,default:"active"},classNameHandle:{type:String,default:"handle"},disableUserSelect:{type:Boolean,default:!0},enableNativeDrag:{type:Boolean,default:!1},preventDeactivation:{type:Boolean,default:!1},active:{type:Boolean,default:!1},draggable:{type:Boolean,default:!0},resizable:{type:Boolean,default:!0},rotatable:{type:Boolean,default:!1},lockAspectRatio:{type:Boolean,default:!1},outsideAspectRatio:{type:[Number,String],default:0},w:{type:[Number,String],default:200,validator:t=>typeof t=="number"?t>0:t==="auto"},h:{type:[Number,String],default:200,validator:t=>typeof t=="number"?t>0:t==="auto"},minWidth:{type:Number,default:0,validator:t=>t>=0},minHeight:{type:Number,default:0,validator:t=>t>=0},maxWidth:{type:Number,default:1/0,validator:t=>t>=0},maxHeight:{type:Number,default:1/0,validator:t=>t>=0},x:{type:[String,Number],default:0},y:{type:[String,Number],default:0},z:{type:[String,Number],default:"auto",validator:t=>typeof t=="string"?t==="auto":t>=0},r:{type:[String,Number],default:0},handles:{type:Array,default:()=>["tl","tm","tr","mr","br","bm","bl","ml","rot"],validator:t=>{const e=new Set(["tl","tm","tr","mr","br","bm","bl","ml","rot"]);return new Set(t.filter(o=>e.has(o))).size===t.length}},dragHandle:{type:String,default:null},dragCancel:{type:String,default:null},axis:{type:String,default:"both",validator:t=>["x","y","both"].includes(t)},grid:{type:Array,default:()=>[1,1]},parent:{type:[Boolean,String],default:!1},onDragStart:{type:Function,default:()=>!0},onDrag:{type:Function,default:()=>!0},onResizeStart:{type:Function,default:()=>!0},onResize:{type:Function,default:()=>!0},onRotateStart:{type:Function,default:()=>!0},onRotate:{type:Function,default:()=>!0},isConflictCheck:{type:Boolean,default:!1},snap:{type:Boolean,default:!1},snapBorder:{type:Boolean,default:!1},snapTolerance:{type:Number,default:5,validator:function(t){return typeof t=="number"}},scaleRatio:{type:Number,default:1,validator:t=>typeof t=="number"},handleInfo:{type:Object,default:()=>({size:8,offset:-4,switch:!0})}},data:function(){return{left:this.x,top:this.y,right:null,bottom:null,rotate:this.r,width:null,height:null,widthTouched:!1,heightTouched:!1,aspectFactor:null,parentWidth:null,parentHeight:null,minW:this.minWidth,minH:this.minHeight,maxW:this.maxWidth,maxH:this.maxHeight,handle:null,enabled:this.active,resizing:!1,dragging:!1,rotating:!1,zIndex:this.z,lastCenterX:0,lastCenterY:0,parentX:0,parentY:0}},computed:{handleStyle(){return t=>{if(!this.handleInfo.switch)return{display:this.enabled?"block":"none"};if(t==="rot"&&!this.rotatable)return{display:"none"};if(t!=="rot"&&!this.resizable)return{display:"none"};const e=(this.handleInfo.size/this.scaleRatio).toFixed(2),o=(this.handleInfo.offset/this.scaleRatio).toFixed(2),n=(e/2).toFixed(2),l={tl:{top:`${o}px`,left:`${o}px`},tm:{top:`${o}px`,left:`calc(50% - ${n}px)`},tr:{top:`${o}px`,right:`${o}px`},mr:{top:`calc(50% - ${n}px)`,right:`${o}px`},br:{bottom:`${o}px`,right:`${o}px`},bm:{bottom:`${o}px`,right:`calc(50% - ${n}px)`},bl:{bottom:`${o}px`,left:`${o}px`},ml:{top:`calc(50% - ${n}px)`,left:`${o}px`},rot:{top:`-${e*3}px`,left:"50%"}},a={width:l[t].width||`${e}px`,height:l[t].height||`${e}px`,top:l[t].top,left:l[t].left,right:l[t].right,bottom:l[t].bottom},d={tl:0,tm:1,tr:2,mr:3,br:4,bm:5,bl:6,ml:7,rot:8};if(t!=="rot"){const r=["nw-resize","n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize","w-resize"],u=this.rotate+22.5,v=Math.floor(u/45);let c=(d[t]+v)%8;a.cursor=r[c]}return a.display=this.enabled?"block":"none",a}},style(){return{transform:`translate(${this.left}px, ${this.top}px) rotate(${this.rotate}deg)`,width:this.computedWidth,height:this.computedHeight,zIndex:this.zIndex,fontSize:this.handleInfo.size*2+"px",...this.dragging&&this.disableUserSelect?ma:ga}},actualHandles(){return!this.resizable&&!this.rotatable?[]:this.handles},computedWidth(){return this.w==="auto"&&!this.widthTouched?"auto":this.width+"px"},computedHeight(){return this.h==="auto"&&!this.heightTouched?"auto":this.height+"px"}},watch:{active(t){this.enabled=t,t?(this.updateParentSize(),G(this,"activated")):G(this,"deactivated")},x(t){this.resizing||this.dragging||(this.parent&&(this.bounds=this.calcDragLimits()),this.moveHorizontally(t))},y(t){this.resizing||this.dragging||(this.parent&&(this.bounds=this.calcDragLimits()),this.moveVertically(t))},z(t){(t>=0||t==="auto")&&(this.zIndex=t)},r(t){t>=0&&(this.rotate=t%360)},lockAspectRatio(t){t?this.outsideAspectRatio?this.aspectFactor=this.outsideAspectRatio:this.aspectFactor=this.width/this.height:this.aspectFactor=void 0},outsideAspectRatio(t){t&&(this.aspectFactor=t)},minWidth(t){t>0&&t<=this.width&&(this.minW=t)},minHeight(t){t>0&&t<=this.height&&(this.minH=t)},maxWidth(t){this.maxW=t},maxHeight(t){this.maxH=t},w(t){this.resizing||this.dragging||(this.parent&&(this.bounds=this.calcResizeLimits()),this.changeWidth(t))},h(t){this.resizing||this.dragging||(this.parent&&(this.bounds=this.calcResizeLimits()),this.changeHeight(t))}},created:function(){this.maxWidth&&this.minWidth>this.maxWidth&&console.warn("[Vdr warn]: Invalid prop: minWidth cannot be greater than maxWidth"),this.maxWidth&&this.minHeight>this.maxHeight&&console.warn("[Vdr warn]: Invalid prop: minHeight cannot be greater than maxHeight"),this.elmX=0,this.elmY=0,this.elmW=0,this.elmH=0,this.lastCenterX=0,this.lastCenterY=0,this.fixedXName="",this.fixedYName="",this.fixedX=0,this.fixedY=0,this.TL={},this.TR={},this.BL={},this.BR={},this.resetBoundsAndMouseState()},mounted:function(){this.enableNativeDrag||(this.$el.ondragstart=()=>!1);const[t,e]=this.getParentSize();this.parentWidth=t,this.parentHeight=e;const[o,n]=pa(this.$el);this.aspectFactor=(this.w!=="auto"?this.w:o)/(this.h!=="auto"?this.h:n),this.outsideAspectRatio&&(this.aspectFactor=this.outsideAspectRatio),this.width=this.w!=="auto"?this.w:o,this.height=this.h!=="auto"?this.h:n,this.right=this.parentWidth-this.width-this.left,this.bottom=this.parentHeight-this.height-this.top,this.settingAttribute(),ye(document.documentElement,"mousedown",this.deselect),ye(document.documentElement,"touchend touchcancel",this.deselect),ye(window,"resize",this.checkParentSize)},beforeUnmount:function(){le(document.documentElement,"mousedown",this.deselect),le(document.documentElement,"touchstart",this.handleUp),le(document.documentElement,"mousemove",this.move),le(document.documentElement,"touchmove",this.move),le(document.documentElement,"mouseup",this.handleUp),le(document.documentElement,"touchend touchcancel",this.deselect),le(window,"resize",this.checkParentSize)},methods:{resetBoundsAndMouseState(){this.mouseClickPosition={mouseX:0,mouseY:0,x:0,y:0,w:0,h:0},this.bounds={minLeft:null,maxLeft:null,minRight:null,maxRight:null,minTop:null,maxTop:null,minBottom:null,maxBottom:null}},checkParentSize(){if(this.parent){const[t,e]=this.getParentSize();this.right=t-this.width-this.left,this.bottom=e-this.height-this.top,this.parentWidth=t,this.parentHeight=e}},updateParentSize(){const[t,e]=this.getParentSize();this.parentWidth=t,this.parentHeight=e},getParentSize(){if(this.parent===!0){const t=window.getComputedStyle(this.$el.parentNode,null),e=this.$el.parentNode.getBoundingClientRect();return this.parentX=e.x,this.parentY=e.y,[Math.round(parseFloat(t.getPropertyValue("width"),10)),Math.round(parseFloat(t.getPropertyValue("height"),10))]}if(typeof this.parent=="string"){const t=document.querySelector(this.parent);if(!(t instanceof HTMLElement))throw new Error(`The selector ${this.parent} does not match any element`);return[t.offsetWidth,t.offsetHeight]}return[null,null]},elementTouchDown(t){ie=Oe.touch,this.elementDown(t)},elementMouseDown(t){ie=Oe.mouse,this.elementDown(t)},elementDown(t){if(t instanceof MouseEvent&&t.which!==1)return;const e=t.target||t.srcElement;if(this.$el.contains(e)){if(this.onDragStart(t)===!1)return;if(this.dragHandle&&!Tt(e,this.dragHandle,this.$el)||this.dragCancel&&Tt(e,this.dragCancel,this.$el)){this.dragging=!1;return}this.enabled||(this.enabled=!0,G(this,"activated"),G(this,"update:active",!0)),this.draggable&&(this.dragging=!0),this.mouseClickPosition.mouseX=t.touches?t.touches[0].pageX:t.pageX,this.mouseClickPosition.mouseY=t.touches?t.touches[0].pageY:t.pageY,this.mouseClickPosition.left=this.left,this.mouseClickPosition.right=this.right,this.mouseClickPosition.top=this.top,this.mouseClickPosition.bottom=this.bottom,this.mouseClickPosition.width=this.width,this.mouseClickPosition.height=this.height,this.parent&&(this.bounds=this.calcDragLimits()),ye(document.documentElement,ie.move,this.move),ye(document.documentElement,ie.stop,this.handleUp)}},calcDragLimits(){return this.rotatable?{minLeft:-this.width/2,maxLeft:this.parentWidth-this.width/2,minRight:this.width/2,maxRight:this.parentWidth+this.width/2,minTop:-this.height/2,maxTop:this.parentHeight-this.height/2,minBottom:this.height/2,maxBottom:this.parentHeight+this.height/2}:{minLeft:this.left%this.grid[0],maxLeft:Math.floor((this.parentWidth-this.width-this.left)/this.grid[0])*this.grid[0]+this.left,minRight:this.right%this.grid[0],maxRight:Math.floor((this.parentWidth-this.width-this.right)/this.grid[0])*this.grid[0]+this.right,minTop:this.top%this.grid[1],maxTop:Math.floor((this.parentHeight-this.height-this.top)/this.grid[1])*this.grid[1]+this.top,minBottom:this.bottom%this.grid[1],maxBottom:Math.floor((this.parentHeight-this.height-this.bottom)/this.grid[1])*this.grid[1]+this.bottom}},deselect(t){const e=t.target||t.srcElement,o=new RegExp(this.className+"-([trmbl]{2})","");!this.$el.contains(e)&&!o.test(e.className)&&(this.enabled&&!this.preventDeactivation&&(this.enabled=!1,G(this,"deactivated"),G(this,"update:active",!1)),le(document.documentElement,ie.move,this.move)),this.resetBoundsAndMouseState()},handleTouchDown(t,e){ie=Oe.touch,this.handleDown(t,e)},handleDown(t,e){if(e instanceof MouseEvent&&e.which!==1||this.onResizeStart(t,e)===!1)return!1;e.stopPropagation&&e.stopPropagation(),this.handle=t,this.handle==="rot"?this.rotating=!0:this.resizing=!0;let{top:o,left:n,width:l,height:a}=this.$el.getBoundingClientRect();this.lastCenterX=window.pageXOffset+n+l/2,this.lastCenterY=window.pageYOffset+o+a/2;let d=this.left,r=this.top,i=this.width,u=this.height,v=d+i/2,c=r+u/2,s=this.rotate;this.TL=Ue(v,c,d,r,s),this.TR=Ue(v,c,d+i,r,s),this.BL=Ue(v,c,d,r+u,s),this.BR=Ue(v,c,d+i,r+u,s),this.mouseClickPosition.mouseX=e.touches?e.touches[0].pageX:e.pageX,this.mouseClickPosition.mouseY=e.touches?e.touches[0].pageY:e.pageY,this.mouseClickPosition.left=this.left,this.mouseClickPosition.right=this.right,this.mouseClickPosition.top=this.top,this.mouseClickPosition.bottom=this.bottom,this.mouseClickPosition.width=this.width,this.mouseClickPosition.height=this.height,this.bounds=this.calcResizeLimits(),ye(document.documentElement,ie.move,this.move),ye(document.documentElement,ie.stop,this.handleUp)},calcResizeLimits(){let t=this.minW,e=this.minH,o=this.maxW,n=this.maxH;const[l,a]=this.grid,d=this.width,r=this.height,i=this.left,u=this.top,v=this.right,c=this.bottom;o=o-o%l,n=n-n%a;const s={minLeft:null,maxLeft:null,minTop:null,maxTop:null,minRight:null,maxRight:null,minBottom:null,maxBottom:null};return this.parent?(s.minLeft=i,s.maxLeft=i+Math.floor((d-t)/l),s.minTop=u,s.maxTop=u+Math.floor((r-e)/a),s.minRight=v,s.maxRight=v+Math.floor((d-t)/l),s.minBottom=c,s.maxBottom=c+Math.floor((r-e)/a),o&&(s.minLeft=Math.max(s.minLeft,this.parentWidth-v-o),s.minRight=Math.max(s.minRight,this.parentWidth-i-o)),n&&(s.minTop=Math.max(s.minTop,this.parentHeight-c-n),s.minBottom=Math.max(s.minBottom,this.parentHeight-u-n))):(s.minLeft=null,s.maxLeft=i+Math.floor(d-t),s.minTop=null,s.maxTop=u+Math.floor(r-e),s.minRight=null,s.maxRight=v+Math.floor(d-t),s.minBottom=null,s.maxBottom=c+Math.floor(r-e),o&&(s.minLeft=-(v+o),s.minRight=-(i+o)),n&&(s.minTop=-(c+n),s.minBottom=-(u+n)),this.lockAspectRatio&&o&&n&&(s.minLeft=Math.min(s.minLeft,-(v+o)),s.minTop=Math.min(s.minTop,-(n+c)),s.minRight=Math.min(s.minRight,-i-o),s.minBottom=Math.min(s.minBottom,-u-n))),s},move(t){this.resizing?this.handleResize(t):this.dragging?this.handleDrag(t):this.rotating&&this.handleRotate(t)},getMouseCoordinate(t){return t.type.indexOf("touch")!==-1?{x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY}:{x:t.pageX||t.clientX+document.documentElement.scrollLeft,y:t.pageY||t.clientY+document.documentElement.scrollTop}},handleRotate(t){const{x:e,y:o}=this.getMouseCoordinate(t),n=e-this.lastCenterX,l=o-this.lastCenterY;this.rotate=(fa(n,l)+90)%360,G(this,"rotating",this.rotate)},async handleDrag(t){const e=this.axis,o=this.grid,n=this.bounds,l=this.mouseClickPosition,a=e&&e!=="y"?l.mouseX-(t.touches?t.touches[0].pageX:t.pageX):0,d=e&&e!=="x"?l.mouseY-(t.touches?t.touches[0].pageY:t.pageY):0,[r,i]=ke(o,a,d,this.scaleRatio),u=X(l.left-r,n.minLeft,n.maxLeft),v=X(l.top-i,n.minTop,n.maxTop);if(this.onDrag(u,v)===!1)return;const c=X(l.right+r,n.minRight,n.maxRight),s=X(l.bottom+i,n.minBottom,n.maxBottom);this.left=u,this.top=v,this.right=c,this.bottom=s,await this.snapCheck(),G(this,"dragging",this.left,this.top)},moveHorizontally(t){const[e]=ke(this.grid,t,this.top,this.scale),o=X(e,this.bounds.minLeft,this.bounds.maxLeft);this.left=o,this.right=this.parentWidth-this.width-o},moveVertically(t){const[,e]=ke(this.grid,this.left,t,this.scale),o=X(e,this.bounds.minTop,this.bounds.maxTop);this.top=o,this.bottom=this.parentHeight-this.height-o},handleResize(t){const e=this.handle,o=this.scaleRatio,{TL:n,TR:l,BL:a,BR:d}=this;let{x:r,y:i}=this.getMouseCoordinate(t);!this.rotatable&&this.parent&&(r=X(r,this.parentX,this.parentX+this.parentWidth*o),i=X(i,this.parentY,this.parentY+this.parentHeight*o));let u=r-this.mouseClickPosition.mouseX,v=i-this.mouseClickPosition.mouseY;u=u/o,v=v/o;let c,s,y,f,b,p,_,R,C,x={},S={},k={},h={},M={},H={},P={},B={};if(e.includes("m")){switch(e){case"tm":c=u+(n.x+l.x)/2,s=v+(n.y+l.y)/2,x=a,S=n,k=d,h={x:c-x.x,y:s-x.y},M={x:S.x-x.x,y:S.y-x.y},y=(h.x*M.x+h.y*M.y)/(Math.pow(M.x,2)+Math.pow(M.y,2)),P={x:k.x-x.x,y:k.y-x.y},B={x:M.x*y,y:M.y*y};break;case"bm":c=u+(a.x+d.x)/2,s=v+(a.y+d.y)/2,x=n,S=a,k=l,h={x:c-x.x,y:s-x.y},M={x:S.x-x.x,y:S.y-x.y},y=(h.x*M.x+h.y*M.y)/(Math.pow(M.x,2)+Math.pow(M.y,2)),P={x:k.x-x.x,y:k.y-x.y},B={x:M.x*y,y:M.y*y};break;case"ml":c=u+(n.x+a.x)/2,s=v+(n.y+a.y)/2,x=d,S=a,k=l,h={x:c-x.x,y:s-x.y},M={x:S.x-x.x,y:S.y-x.y},y=(h.x*M.x+h.y*M.y)/(Math.pow(M.x,2)+Math.pow(M.y,2)),B={x:k.x-x.x,y:k.y-x.y},P={x:M.x*y,y:M.y*y};break;case"mr":c=u+(l.x+l.x)/2,s=v+(l.y+l.y)/2,x=a,S=d,k=n,h={x:c-x.x,y:s-x.y},M={x:S.x-x.x,y:S.y-x.y},y=(h.x*M.x+h.y*M.y)/(Math.pow(M.x,2)+Math.pow(M.y,2)),B={x:k.x-x.x,y:k.y-x.y},P={x:M.x*y,y:M.y*y};break}p=x.x+(P.x+B.x)/2,_=x.y+(P.y+B.y)/2,R=Math.sqrt(Math.pow(P.x,2)+Math.pow(P.y,2)),C=Math.sqrt(Math.pow(B.x,2)+Math.pow(B.y,2))}else{switch(e){case"tl":c=u+n.x,s=v+n.y,x=d,S=a,k=l;break;case"tr":c=u+l.x,s=v+l.y,x=a,S=d,k=n;break;case"bl":c=u+a.x,s=v+a.y,x=l,S=n,k=d;break;case"br":c=u+d.x,s=v+d.y,x=n,S=l,k=a;break}h={x:c-x.x,y:s-x.y},M={x:S.x-x.x,y:S.y-x.y},H={x:k.x-x.x,y:k.y-x.y},f=(h.x*M.x+h.y*M.y)/(Math.pow(M.x,2)+Math.pow(M.y,2)),b=(h.x*H.x+h.y*H.y)/(Math.pow(H.x,2)+Math.pow(H.y,2)),P={x:M.x*f,y:M.y*f},B={x:H.x*b,y:H.y*b},p=x.x+(P.x+B.x)/2,_=x.y+(P.y+B.y)/2,R=Math.sqrt(Math.pow(P.x,2)+Math.pow(P.y,2)),C=Math.sqrt(Math.pow(B.x,2)+Math.pow(B.y,2))}this.left=p-R/2,this.top=_-C/2,R=X(R,this.minW||0,this.maxW),C=X(C,this.minH||0,this.maxH),this.parent&&(R=X(R,0,this.parentWidth),C=X(C,0,this.parentHeight)),this.lockAspectRatio&&(console.log(this.lockAspectRatio,this.aspectFactor),R/C>this.aspectFactor?R=C*this.aspectFactor:C=R/this.aspectFactor),this.width=R,this.height=C,G(this,"resizing",this.left,this.top,this.width,this.height)},changeWidth(t){const[e]=ke(this.grid,t,0,this.scale),o=this.parentWidth-e-this.left;let n=this.bottom;this.lockAspectRatio&&(n=this.bottom-(this.right-o)/this.aspectFactor);const l=At(this.parentWidth,this.left,o),a=Lt(this.parentHeight,this.top,n);this.right=o,this.bottom=n,this.width=l,this.height=a},changeHeight(t){const[,e]=ke(this.grid,0,t,this.scale),o=this.parentHeight-e-this.top;let n=this.right;this.lockAspectRatio&&(n=this.right-(this.bottom-o)*this.aspectFactor);const l=At(this.parentWidth,this.left,n),a=Lt(this.parentHeight,this.top,o);this.right=n,this.bottom=o,this.width=l,this.height=a},async handleUp(t){this.handle=null;const e=new Array(3).fill({display:!1,position:"",origin:"",lineLength:""}),o={vLine:[],hLine:[]};for(const a in o)o[a]=JSON.parse(JSON.stringify(e));const{x:n,y:l}=this.getMouseCoordinate(t);this.lastMouseX=n,this.lastMouseY=l,this.resizing&&(this.resizing=!1,await this.conflictCheck(),G(this,"refLineParams",o),G(this,"resizestop",this.left,this.top,this.width,this.height)),this.dragging&&(this.dragging=!1,await this.conflictCheck(),G(this,"refLineParams",o),G(this,"dragstop",this.left,this.top)),this.rotating&&(this.rotating=!1,G(this,"rotatestop",this.rotate)),this.resetBoundsAndMouseState(),le(document.documentElement,ie.move,this.move)},settingAttribute(){this.$el.setAttribute("data-is-check",`${this.isConflictCheck}`),this.$el.setAttribute("data-is-snap",`${this.snap}`)},conflictCheck(){const t=this.top,e=this.left,o=this.width,n=this.height;if(this.isConflictCheck){const l=this.$el.parentNode.childNodes;for(const a of l)if(a.className!==void 0&&!a.className.split(" ").includes(this.classNameActive)&&a.getAttribute("data-is-check")!==null&&a.getAttribute("data-is-check")!=="false"){const d=a.offsetWidth,r=a.offsetHeight,[i,u]=this.formatTransformVal(a.style.transform),v=t>=u&&e>=i&&u+r>t&&i+d>e||t<=u&&e<i&&t+n>u&&e+o>i,c=e<=i&&t>=u&&e+o>i&&t<u+r||t<u&&e>i&&t+n>u&&e<i+d,s=t<=u&&e>=i&&t+n>u&&e<i+d||t>=u&&e<=i&&t<u+r&&e>i+d,y=t<=u&&e>=i&&t+n>u&&e<i+d||t>=u&&e<=i&&t<u+r&&e>i+d,f=e>=i&&t>=u&&e<i+d&&t<u+r||t>u&&e<=i&&e+o>i&&t<u+r,b=t<=u&&e>=i&&t+n>u&&e<i+d||t>=u&&e<=i&&t<u+r&&e+o>i;(v||c||s||y||f||b)&&(this.top=this.mouseClickPosition.top,this.left=this.mouseClickPosition.left,this.width=this.mouseClickPosition.width,this.height=this.mouseClickPosition.height)}}},async snapCheck(){if(this.snap){let t=this.width,e=this.height,o=this.left,n=this.left+t,l=this.top,a=this.top+e;const d=new Array(3).fill({display:!1,position:"",origin:"",lineLength:""}),r={vLine:[],hLine:[]};for(const b in r)r[b]=JSON.parse(JSON.stringify(d));const i={value:{x:[[],[],[]],y:[[],[],[]]},display:[],position:[]},u=this.$el.parentNode.childNodes,{groupWidth:v,groupHeight:c,groupLeft:s,groupTop:y,bln:f}=await this.getActiveAll(u);f||(t=v,e=c,o=s,n=s+v,l=y,a=y+c);for(const b of u)if(b.className!==void 0&&!b.className.split(" ").includes(this.classNameActive)&&b.getAttribute("data-is-snap")!==null&&b.getAttribute("data-is-snap")!=="false"){const[p,_,R]=this.formatTransformVal(b.style.transform);if((R-this.rotate)%90===0){const C=b.offsetWidth,x=b.offsetHeight,S=p+C,k=_+x,h=Math.abs(l+e/2-(_+x/2))<=this.snapTolerance,M=Math.abs(o+t/2-(p+C/2))<=this.snapTolerance,H=Math.abs(_-a)<=this.snapTolerance,P=Math.abs(k-a)<=this.snapTolerance,B=Math.abs(_-l)<=this.snapTolerance,fe=Math.abs(k-l)<=this.snapTolerance,pe=Math.abs(p-n)<=this.snapTolerance,me=Math.abs(S-n)<=this.snapTolerance,ge=Math.abs(p-o)<=this.snapTolerance,re=Math.abs(S-o)<=this.snapTolerance;i.display=[H,P,B,fe,h,h,pe,me,ge,re,M,M],i.position=[_,k,_,k,_+x/2,_+x/2,p,S,p,S,p+C/2,p+C/2],f&&(H&&(this.top=_-e,this.bottom=this.parentHeight-this.top-e,i.value.y[0].push(p,S,o,n)),B&&(this.top=_,this.bottom=this.parentHeight-this.top-e,i.value.y[0].push(p,S,o,n)),P&&(this.top=k-e,this.bottom=this.parentHeight-this.top-e,i.value.y[1].push(p,S,o,n)),fe&&(this.top=k,this.bottom=this.parentHeight-this.top-e,i.value.y[1].push(p,S,o,n)),pe&&(this.left=p-t,this.right=this.parentWidth-this.left-t,i.value.x[0].push(_,k,l,a)),ge&&(this.left=p,this.right=this.parentWidth-this.left-t,i.value.x[0].push(_,k,l,a)),me&&(this.left=S-t,this.right=this.parentWidth-this.left-t,i.value.x[1].push(_,k,l,a)),re&&(this.left=S,this.right=this.parentWidth-this.left-t,i.value.x[1].push(_,k,l,a)),h&&(this.top=_+x/2-e/2,this.bottom=this.parentHeight-this.top-e,i.value.y[2].push(p,S,o,n)),M&&(this.left=p+C/2-t/2,this.right=this.parentWidth-this.left-t,i.value.x[2].push(_,k,l,a)),this.snapBorder&&(Math.abs(this.left-0)<=this.snapTolerance&&(this.left=0,this.right=this.parentWidth-this.left-t),Math.abs(this.right-0)<=this.snapTolerance&&(this.right=0,this.left=this.parentWidth-this.width-this.right),Math.abs(this.top-0)<=this.snapTolerance&&(this.top=0,this.bottom=this.parentHeight-this.top-e),Math.abs(this.bottom-0)<=this.snapTolerance&&(this.bottom=0,this.top=this.parentHeight-this.bottom-e)));let J=this.bounds;this.left=X(this.left,J.minLeft,J.maxLeft),this.top=X(this.top,J.minTop,J.maxTop),this.right=X(this.right,J.minRight,J.maxRight),this.bottom=X(this.bottom,J.minBottom,J.maxBottom);const V=[0,1,0,1,2,2,0,1,0,1,2,2];for(let L=0;L<=V.length;L++){const K=L<6?"y":"x",T=L<6?"hLine":"vLine";if(i.display[L]){const{origin:U,length:W}=this.calcLineValues(i.value[K][V[L]]);r[T][V[L]].display=i.display[L],r[T][V[L]].position=i.position[L]+"px",r[T][V[L]].origin=U,r[T][V[L]].lineLength=W}}}}G(this,"refLineParams",r)}},calcLineValues(t){const e=Math.max(...t)-Math.min(...t)+"px",o=Math.min(...t)+"px";return{length:e,origin:o}},async getActiveAll(t){const e=[],o=[],n=[];let l=0,a=0,d=0,r=0;for(const v of t)v.className!==void 0&&v.className.split(" ").includes(this.classNameActive)&&e.push(v);const i=e.length;if(i>1){for(const v of e){const c=v.offsetLeft,s=c+v.offsetWidth,y=v.offsetTop,f=y+v.offsetHeight;o.push(c,s),n.push(y,f)}l=Math.max(...o)-Math.min(...o),a=Math.max(...n)-Math.min(...n),d=Math.min(...o),r=Math.min(...n)}return{groupWidth:l,groupHeight:a,groupLeft:d,groupTop:r,bln:i===1}},formatTransformVal(t){let[e,o,n=0]=t.match(/[\d|.]+/g);return o===void 0&&(o=0),[Number(e),Number(o),n]}},emits:["update:active","rotating","dragging","resizing","refLineParams","resizestop","dragstop","rotatestop","activated","deactivated"]};const va=["onMousedown","onTouchstart"];function ya(t,e,o,n,l,a){return A(),z("div",{style:ae(a.style),class:be([{[o.classNameActive]:t.enabled,[o.classNameDragging]:t.dragging,[o.classNameResizing]:t.resizing,[o.classNameDraggable]:o.draggable,[o.classNameResizable]:o.resizable,[o.classNameRotating]:t.rotating,[o.classNameRotatable]:o.rotatable},o.className]),onMousedown:e[0]||(e[0]=(...d)=>a.elementMouseDown&&a.elementMouseDown(...d)),onTouchstart:e[1]||(e[1]=(...d)=>a.elementTouchDown&&a.elementTouchDown(...d))},[(A(!0),z(q,null,oe(a.actualHandles,(d,r)=>(A(),z("div",{key:r,class:be([o.classNameHandle,o.classNameHandle+"-"+d]),style:ae(a.handleStyle(d,r)),onMousedown:Te(i=>a.handleDown(d,i),["stop","prevent"]),onTouchstart:Te(i=>a.handleTouchDown(d,i),["stop","prevent"])},[Pe(t.$slots,d)],46,va))),128)),Pe(t.$slots,"default")],38)}Me.render=ya;Me.__scopeId="data-v-3c286975";Me.__file="src/components/vue-drag-resize-rotate/index.vue";function Ze(t){Ze.installed||(Ze.installed=!0,t.component("VueDragResizeRotate",Me))}Me.install=Ze;const it=en(ca);it.use(nn);it.use(Me);it.mount("#app");
